<?xml version = "1.0" encoding="Windows-1252" standalone="yes"?>
<VFPData>
	<xsd:schema id="VFPData" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
		<xsd:element name="VFPData" msdata:IsDataSet="true">
			<xsd:complexType>
				<xsd:choice maxOccurs="unbounded">
					<xsd:element name="form" minOccurs="0" maxOccurs="unbounded">
						<xsd:complexType>
							<xsd:sequence>
								<xsd:element name="platform">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="8"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="uniqueid">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="10"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="timestamp">
									<xsd:simpleType>
										<xsd:restriction base="xsd:decimal">
											<xsd:totalDigits value="10"/>
											<xsd:fractionDigits value="0"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="class">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="classloc">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="baseclass">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="objname">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="parent">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="properties">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="protected">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="methods">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="objcode">
									<xsd:simpleType>
										<xsd:restriction base="xsd:base64Binary">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="ole">
									<xsd:simpleType>
										<xsd:restriction base="xsd:base64Binary">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="ole2">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved1">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved2">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved3">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved4">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved5">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved6">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved7">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="reserved8">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="user">
									<xsd:simpleType>
										<xsd:restriction base="xsd:string">
											<xsd:maxLength value="2147483647"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
								<xsd:element name="nrecno">
									<xsd:simpleType>
										<xsd:restriction base="xsd:decimal">
											<xsd:totalDigits value="10"/>
											<xsd:fractionDigits value="0"/>
										</xsd:restriction>
									</xsd:simpleType>
								</xsd:element>
							</xsd:sequence>
						</xsd:complexType>
					</xsd:element>
				</xsd:choice>
				<xsd:anyAttribute namespace="http://www.w3.org/XML/1998/namespace" processContents="lax"/>
			</xsd:complexType>
		</xsd:element>
	</xsd:schema>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C0WL2NB</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[dataenvironment]]></class>
		<classloc/>
		<baseclass><![CDATA[dataenvironment]]></baseclass>
		<objname><![CDATA[Dataenvironment]]></objname>
		<parent/>
		<properties><![CDATA[Top = 0
Left = 0
Width = 0
Height = 0
DataSource = .NULL.
Name = "Dataenvironment"
]]></properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2><![CDATA[1]]></reserved2>
		<reserved3/>
		<reserved4><![CDATA[1]]></reserved4>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>2</nrecno>
	</form>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C0WL2NC</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[form]]></class>
		<classloc/>
		<baseclass><![CDATA[form]]></baseclass>
		<objname><![CDATA[Form1]]></objname>
		<parent/>
		<properties><![CDATA[Height = 181
Width = 510
DoCreate = .T.
AutoCenter = .T.
Caption = "Migracion"
ncontrato = .F.
nfiadores = .F.
Name = "Form1"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE buscar_detalle
 LPARAMETERS pncodinmueble, pncoddetalle, pctipo

 SET EXACT ON
 lckey1 = PADL(ALLTRIM(STR(pncodinmueble)), 10, '0')+PADL(ALLTRIM(STR(pncoddetalle)), 10, '0')
 IF SEEK(lckey1, 'DETAINM', 'KEY1')
    IF pctipo=1
       IF (pncoddetalle>=11 .AND. pncoddetalle<=13) .OR. (pncoddetalle>=29 .AND. pncoddetalle<=35) .OR. pncoddetalle=69 .OR. pncoddetalle=66 .OR. pncoddetalle=87 .OR. pncoddetalle=92
          IF detainm.tiene
             RETURN 1
          ELSE
             RETURN 0
          ENDIF
       ENDIF
       IF pncoddetalle=20
          RETURN detainm.cantidad*2
       ELSE
          RETURN detainm.cantidad
       ENDIF
    ELSE
       RETURN IIF(detainm.tiene, "S", "N")
    ENDIF
 ELSE
    IF pctipo=1
       RETURN 0
    ELSE
       RETURN "N"
    ENDIF
 ENDIF
ENDPROC
PROCEDURE cocina
 LPARAMETERS lnidinmueble
 DO CASE
    CASE thisform.buscar_detalle(lnidinmueble, 11, 1)<>0
          RETURN "1"
      
    CASE thisform.buscar_detalle(lnidinmueble, 12, 1)<>0
          RETURN "2"
      
    CASE thisform.buscar_detalle(lnidinmueble, 13, 1)<>0
          RETURN "3"
      
    OTHERWISE
          RETURN "0"
       
 ENDCASE
ENDPROC
PROCEDURE digito_ver
 LPARAMETERS tcnit

 LOCAL laconstantes(15)
 LOCAL lanit(15)
 LOCAL lcnit
 laconstantes(1) = 71
 laconstantes(2) = 67
 laconstantes(3) = 59
 laconstantes(4) = 53
 laconstantes(5) = 47
 laconstantes(6) = 43
 laconstantes(7) = 41
 laconstantes(8) = 37
 laconstantes(9) = 29
 laconstantes(10) = 23
 laconstantes(11) = 19
 laconstantes(12) = 17
 laconstantes(13) = 13
 laconstantes(14) = 7
 laconstantes(15) = 3
 lcnit = STRTRAN(tcnit, '.', '')
 IF AT('-', lcnit)>0
    lcnit = LEFT(lcnit, AT('-', lcnit)-1)
 ENDIF
 lcnit = PADL(ALLTRIM(lcnit), 15, '0')
 lnsumacar = 0
 FOR i = 1 TO 15
    lncar = INT(VAL(SUBSTR(lcnit, i, 1)))
    lnmul = lncar*laconstantes(i)
    lnsumacar = lnsumacar+(INT(VAL(SUBSTR(lcnit, i, 1))*laconstantes(i)))
 ENDFOR
 lndigver = INT(MOD(lnsumacar, 11))
 lndigver = 11-lndigver
 IF lndigver=11
    lndigver = 0
 ENDIF
 IF lndigver=10
    lndigver = 1
 ENDIF
 RETURN ALLTRIM(STR(lndigver))

ENDPROC
PROCEDURE direcciones_fjson
LPARAMETERS tcCadena_Direccion, tcTipo_direccion 

lnPosAtI = ATC("(",tcCadena_Direccion)
lnPosAtF = ATC(")",tcCadena_Direccion)
IF lnPosAtI>0 AND lnPosAtF>0
	lcCadena_atipico = SUBSTR(tcCadena_Direccion,lnPosAtI+1,lnPosAtF-(lnPosAtI+1))
	lcCadena_Direccion = SUBSTR(tcCadena_Direccion,1,lnPosAtI-1)
ENDIF 

thisform.via_ppal(lcCadena_Direccion) 	

IF LEN(ALLTRIM(lcViaPPal))=0 AND LEN(ALLTRIM(lcEjevial1))=0 AND LEN(ALLTRIM(lcEjevial2))=0 AND LEN(ALLTRIM(lcEjevial3))=0
	lcCadena_atipico = lcCadena_Direccion
ENDIF 

lcCadena_fjson = '{123}"dir":"'+ALLTRIM(tcCadena_Direccion)+'","json":"{123}\"via_principal\":\"'+ALLTRIM(lcViaPPal)+'\",\"eje_vial_1\":\"'+ALLTRIM(lcEjevial1)+;
'\",\"eje_vial_2\":\"'+ALLTRIM(lcEjevial2)+'\",\"eje_vial_3\":\"'+ALLTRIM(lcEjevial3)+'\",\"complemento_1\":\"'+ALLTRIM(lcCompl1)+'\",\"complemento_2\":\"'+;
ALLTRIM(lcCompl2)+'\",\"complemento_3\":\"'+ALLTRIM(lcCompl3)+'\",\"complemento_4\":\"'+ALLTRIM(lcCompl4)+'\",\"complemento_5\":\"'+ALLTRIM(lcCompl5)+;
'\",\"complemento_6\":\"'+ALLTRIM(lcCompl6)+'\",\"complemento_7\":\"'+ALLTRIM(lcCompl7)+'\",\"complemento_8\":\"'+ALLTRIM(lcCompl8)+'\",\"atipico\":\"'+;
ALLTRIM(lcCadena_atipico)+'\"}"}'

lnnrocharjson = LEN(ALLTRIM(lcCadena_fjson))

lcCadena1_json = SUBSTR(lcCadena_fjson,1,249)+"&"
lcCadena2_json = SUBSTR(lcCadena_fjson,250,249)+"&"
lcCadena3_json = SUBSTR(lcCadena_fjson,500,249)+"&"
lcCadena4_json = SUBSTR(lcCadena_fjson,750,249)+"&"

SELECT CLIENTE_DIRECCION
APPEND BLANK 
REPLACE;
COD_CLIENTE WITH lcNit,;
TIPO_DIRECCION WITH tcTipo_direccion ,;
VIA_PRINCIPAL WITH ALLTRIM(lcViaPPal),;
EJE_VIAL_1 WITH lcEjevial1,;
EJE_VIAL_2 WITH lcEjevial2,;
EJE_VIAL_3 WITH lcEjevial3,; 
COMPLEMENTO_1 WITH ALLTRIM(lcCompl1),;
COMPLEMENTO_2 WITH lcCompl2,;
COMPLEMENTO_3 WITH ALLTRIM(lcCompl3),;
COMPLEMENTO_4 WITH lcCompl4,;
COMPLEMENTO_6 WITH lcCompl6,;
ATIPICO WITH lcCadena_atipico,;
FJSON1 With lcCadena1_json,;
FJSON2 With lcCadena2_json,;
FJSON3 With lcCadena3_json,;
FJSON4 With lcCadena4_json;
IN CLIENTE_DIRECCION



ENDPROC
PROCEDURE eje_vial
LPARAMETERS lcCadena_Direccion, tcViappal

SET PROCEDURE TO PROGS\regexbm

lnExpr_regEjevial1 = .F.
lnExpr_regEjevial2 = .F.
lnExpr_regEjevial3 = .F. 

lnExpr_regCompl2 = .F.
lnExpr_regCompl4 = .F.
lnExpr_regCompl6 = .F.

lcVia_ppal = ALLTRIM(tcViappal)
lnLenVia_ppal = LEN(lcVia_ppal)+1
lnPosEv1 = ATC("#",lcCadena_Direccion)
IF lnPosEv1 > 0
	lcEjevial1 = ALLTRIM(SUBSTR(lcCadena_direccion,ATC(lcVia_ppal,lcCadena_Direccion)+lnLenVia_ppal,lnPosEv1-(ATC(lcVia_ppal,lcCadena_Direccion)+lnLenVia_ppal)))
	
	xpropie = "G"
	xlite = lcEjevial1
	xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
	lnExpr_regEjevial1 = REGEXBM(xpropie,xlite,xpatron,0)

	lnPosfinEv1 = ATC("-",lcCadena_Direccion)
		
	IF lnPosfinEv1 > 0
		lcEjevial2 = ALLTRIM(SUBSTR(lcCadena_Direccion,lnPosEv1+1,lnPosfinEv1-(lnPosEv1+1)))
		
		xpropie = "G"
		xlite = lcEjevial2 
		xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
		lnExpr_regEjevial2 = REGEXBM(xpropie,xlite,xpatron,0)
		
		lcEjevial3 = ALLTRIM(SUBSTR(lcCadena_Direccion,lnPosfinEv1+1))
			
		xpropie = "G"
		xlite = lcEjevial3 
		xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
		lnExpr_regEjevial3 = REGEXBM(xpropie,xlite,xpatron,0)
			
		lnPosCompl1 = ATC(" ",lcEjevial3)
		IF lnPosCompl1 >0
			lcCadena_compl = ALLTRIM(SUBSTR(lcEjevial3,lnPosCompl1+1))
			lcEjevial3 = ALLTRIM(SUBSTR(lcEjevial3,1,(lnPosCompl1-1)))
			
			xpropie = "G"
			xlite = lcEjevial3 
			xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
			lnExpr_regEjevial3 = REGEXBM(xpropie,xlite,xpatron,0)
		
			DO CASE 
				CASE ATC("APT",lcCadena_compl)>0
					lcCompl1 = "AP"
					lnCompl1 = 87
					
					lcCompl2 = SUBSTR(lcCadena_compl,ATC("APT",lcCadena_compl)+4)
					
					xpropie = "G"
					xlite = lcCompl2 
					xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
					lnExpr_regCompl2 = REGEXBM(xpropie,xlite,xpatron,0)
									
					lnPosComp3 = ATC(" ",lcCompl2)
					IF lnPosComp3 >0
						lcCadCompl3 = SUBSTR(lcCompl2,ATC("APT",lcCadena_compl)+4)
						lcCompl2 = ALLTRIM(SUBSTR(lcCompl2,1,lnPosComp3-1))
						
						xpropie = "G"
						xlite = lcCompl2 
						xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
						lnExpr_regCompl2 = REGEXBM(xpropie,xlite,xpatron,0)
				
						lnPosComp4 = ATC(" ",lcCadCompl3)
						IF lnPosComp4>0
							DO CASE 
								CASE ATC(" T ",lcCadCompl3)>0
									lcCompl3 = "TO"
									lnCompl3 = 69
									lcCompl4 = SUBSTR(lcCadCompl3,ATC(" T ",lcCadCompl3)+3)
									
									xpropie = "G"
									xlite = lcCompl4 
									xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
									lnExpr_regCompl4 = REGEXBM(xpropie,xlite,xpatron,0)
								
									lnPosComp4 = ATC(" ",lcCompl4)
									IF lnPosComp4 >0
										
										lcCompl6 = ALLTRIM(SUBSTR(lcCompl4,ATC(" ",lcCompl4)+1))
										
										xpropie = "G"
										xlite = lcCompl6 
										xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
										lnExpr_reg = REGEXBM(xpropie,xlite,xpatron,0)
									
										lcCompl4 = SUBSTR(lcCompl4,1,lnPosComp4-1)
										xpropie = "G"
										xlite = lcCompl4 
										xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
										lnExpr_regCompl6 = REGEXBM(xpropie,xlite,xpatron,0)

									ENDIF 
									
								CASE ATC("EDF",lcCadCompl3)>0
									lcCompl3  = "ED"
									lnCompl3 = 67	
									lcCompl4 = SUBSTR(lcCadCompl3,ATC("EDF",lcCadCompl3)+4)
									
									xpropie = "G"
									xlite = lcCompl4 
									xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
									lnExpr_regCompl4 = REGEXBM(xpropie,xlite,xpatron,0)

							ENDCASE 
						ENDIF 	
					ENDIF 
					
				CASE ATC("CS",lcCadena_compl)>0
					lcCompl1 = "CA"
					lnCompl1 = 84	
					
					lcCompl2 = SUBSTR(lcCadena_compl,ATC("CS",lcCadena_compl)+3)
					
					xpropie = "G"
					xlite = lcCompl2 
					xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
					lnExpr_regCompl2 = REGEXBM(xpropie,xlite,xpatron,0)
					
					lnPosComp3 = ATC(" ",lcCompl2)
					IF lnPosComp3 >0
						lcCadCompl3 = SUBSTR(lcCompl2,ATC("CS",lcCadena_compl)+3)
						lcCompl2 = ALLTRIM(SUBSTR(lcCompl2,1,lnPosComp3-1))
						
						xpropie = "G"
						xlite = lcCompl2 
						xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
						lnExpr_regCompl2 = REGEXBM(xpropie,xlite,xpatron,0)
						
						lnPosComp4 = ATC(" ",lcCadCompl3)
						IF lnPosComp4>0
							DO CASE 
								CASE ATC("MZ",lcCadCompl3)>0
									lcCompl3 = "MZ"
									lnCompl3 = 77
									lcCompl4 = SUBSTR(lcCadCompl3,ATC("MZ",lcCadCompl3)+3)
									
									xpropie = "G"
									xlite = lcCompl4 
									xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
									lnExpr_regCompl4 = REGEXBM(xpropie,xlite,xpatron,0)
																		
									lnPosComp4 = ATC(" ",lcCompl4)
									IF lnPosComp4 >0
										
										lcCompl6 = ALLTRIM(SUBSTR(lcCompl4,ATC(" ",lcCompl4)+1))
										
										xpropie = "G"
										xlite = lcCompl6 
										xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
										lnExpr_regCompl6 = REGEXBM(xpropie,xlite,xpatron,0)
																								
										lcCompl4 = SUBSTR(lcCompl4,1,lnPosComp4-1)
										
										xpropie = "G"
										xlite = lcCompl4 
										xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
										lnExpr_regCompl4 = REGEXBM(xpropie,xlite,xpatron,0)

									ENDIF 

*!*									CASE ATC("EDF",lcCadCompl3)>0
*!*										lcCompl3  = "ED"
*!*										lnCompl3 = 67	
*!*										lcCompl4 = SUBSTR(lcCadCompl3,ATC("EDF",lcCadCompl3)+4)

									OTHERWISE 
									
										lnPosComp4 = ATC(" ",lcCadCompl3)
										IF lnPosComp4>0
											lcCompl3  = ""
											lnCompl3 = 0	
											lcCompl4 = lcCadCompl3
											
											xpropie = "G"
											xlite = lcCompl4 
											xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
											lnExpr_regCompl4 = REGEXBM(xpropie,xlite,xpatron,0)
										ENDIF 	
									
							ENDCASE 
						ENDIF 	
					ENDIF 

				
				CASE ATC("OFC",lcCadena_compl)>0
					lcCompl1 = "OF"
					lnCompl1 = 76
					
					lcCompl2 = SUBSTR(lcCadena_compl,ATC("OFC",lcCadena_compl)+4)
					
					xpropie = "G"
					xlite = lcCompl2 
					xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
					lnExpr_regCompl2 = REGEXBM(xpropie,xlite,xpatron,0)
					
					lnPosComp3 = ATC(" ",lcCompl2)
					IF lnPosComp3 >0
						lcCadCompl3 = SUBSTR(lcCompl2,ATC("OFC",lcCadena_compl)+4)
						lcCompl2 = ALLTRIM(SUBSTR(lcCompl2,1,lnPosComp3-1))
						
						xpropie = "G"
						xlite = lcCompl2 
						xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
						lnExpr_regCompl2 = REGEXBM(xpropie,xlite,xpatron,0)
						
						lnPosComp4 = ATC(" ",lcCadCompl3)
						IF lnPosComp4>0
							DO CASE 
								CASE ATC(" T ",lcCadCompl3)>0
									lcCompl3 = "TO"
									lnCompl3 = 69
									lcCompl4 = SUBSTR(lcCadCompl3,ATC(" T ",lcCadCompl3)+4)
									
									xpropie = "G"
									xlite = lcCompl4 
									xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
									lnExpr_regCompl4 = REGEXBM(xpropie,xlite,xpatron,0)
									
								CASE ATC("EDF",lcCadCompl3)>0
									lcCompl3  = "ED"
									lnCompl3 = 67	
									lcCompl4 = SUBSTR(lcCadCompl3,ATC("EDF",lcCadCompl3)+4)
									
									xpropie = "G"
									xlite = lcCompl4 
									xpatron = "^[0-9' ']{123}1,3}[A-Z' ']{123}0,7}$"
									lnExpr_regCompl4 = REGEXBM(xpropie,xlite,xpatron,0)

							ENDCASE 
						ENDIF 	
					ENDIF 	
			ENDCASE 
	 
		ENDIF 
	ENDIF 	
ENDIF 	

IF lnExpr_regEjevial1 = .F.
	lcEjevial1 = ""
ENDIF 

IF lnExpr_regEjevial2 = .F.
	lcEjevial2 = ""
ENDIF 

IF lnExpr_regEjevial3 = .F. 
	lcEjevial3 = ""
ENDIF 

IF lnExpr_regCompl2 = .F.
	lcCompl2 = ""
ENDIF 

IF lnExpr_regCompl4 = .F.
	lcCompl4 = ""
ENDIF 

IF lnExpr_regCompl6 = .F.
	lcCompl6 = ""
ENDIF 


RELEASE PROCEDURE PROGS\regexbm
ENDPROC
PROCEDURE exportarconta_csv
WAIT WINDOW NOWAIT "Generando archivo conta...."  

SET DATE DMY 

SELECT BANCO
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/banco.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT CCOSTO
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/centro_costo.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT COMPROBANTE
SET ORDER TO iddoc 
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/comprobante.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT COMPROBANTE_DETALLE
SET ORDER TO iddoc 
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/comprobante_detalle.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT CSALDOS_CUENTAS 
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/saldos_cuentas.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

MESSAGEBOX("Archivo generado...",0+64,"Base de Datos Conta")

ENDPROC
PROCEDURE exportar_csv
WAIT WINDOW NOWAIT "Generando excel inmuebles...."  

SET DATE DMY 


SELECT tipo_regimen
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_regimen.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT tipo_cliente
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_cliente.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT tipo_documento
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_documento.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT tipo_consignacion
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_consignacion.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT SUCURSAL
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/sucursal.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT TIPO_INMUEBLE
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_inmueble.csv'
COPY TO (cNombreArchivo)TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT DESTINO_INMUEBLE
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/destino_inmueble.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT ESTADO_INMUEBLE
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/estado_inmueble.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT TIPO_COCINA
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_cocina.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT TIPO_PISO
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_piso.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT TIPO_PARQUEADERO
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_parqueadero.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT TIPO_CUENTA
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_cuenta.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT TIPO_ENTREGA
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_entrega.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT TIPO_PAGO
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_pago.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT ASEGURADORA
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/aseguradora.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT TIPO_REAJUSTE
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/tipo_reajuste.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT CIUDAD
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/ciudad.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT BARRIO
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/barrio.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT CLIENTES
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/clientes.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT cliente_direccion
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/cliente_direccion.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT INMUEBLE
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/inmueble.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT inmueble_direccion
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/inmueble_direccion.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT inmueble_propietario
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/inmueble_propietario.csv' 
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT CONTRATO
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/contrato.csv' 
COPY TO (cNombreArchivo)TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT CONTRATO_FIADOR
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/contrato_fiador.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT contrato_direccion
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/contrato_direccion.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT INMUEBLE_TIPO_PUBLICIDAD 
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/inmueble_tipo_publicidad.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT INMUEBLE_PREDIAL
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/inmueble_predial.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT INMUEBLE_MATRICULA
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/inmueble_matricula.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT ESTADO_FISICO
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/estado_fisico.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT UNIDADES
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/unidades.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT unidades_direccion
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/unidades_direccion.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)

SELECT RUTA_PAGO
Go top
cNombreArchivo = 'F:/ORBIS/DOCS/ruta_pago.csv'
COPY TO (cNombreArchivo) TYPE DELIMITED WITH "" WITH CHARACTER "|"
STRTOFILE(STRCONV(FILETOSTR(cNombreArchivo),9,1252,1),cNombreArchivo)



MESSAGEBOX("Archivo generado...",0+64,"Base de Datos Inmuebles")








ENDPROC
PROCEDURE exportar_informacion
WAIT WINDOW NOWAIT "Generando excel inmuebles....No lo abra hasta que no se le indique"  

SET DATE DMY 


loExcel=Createobject("Excel.application")
loExcel.Visible = .T.
loBook = loExcel.Workbooks.Open('F:/ORBIS/DOCS/BD_ORBIS_INMO.XLS')  &&este es el archivo

SELECT tipo_regimen
Go top
Cen1 = loBook.Sheets['tipo_regimen']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_REGIMEN"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_REGIMEN"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_REGIMEN) 
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_REGIMEN) 
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT tipo_cliente
Go top
Cen1 = loBook.Sheets['tipo_cliente']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_CLIENTE"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_CLIENTE"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_CLIENTE)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_CLIENTE) 
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT tipo_documento
Go top
Cen1 = loBook.Sheets['tipo_documento']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_DOCUMENTO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_DOCUMENTO"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_DOCUMENTO)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_DOCUMENTO) 
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT tipo_consignacion
Go top
Cen1 = loBook.Sheets['tipo_consignacion']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_CONSIGNACION"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_CONSIGNACION"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_CONSIGNACION)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_CONSIGNACION)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT SUCURSAL
Go top
Cen1 = loBook.Sheets['sucursal']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_SUCURSAL"
 .Range("B"+alltrim(str(linea))).Value ="NOM_SUCURSAL"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_SUCURSAL)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_SUCURSAL)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT TIPO_INMUEBLE
Go top
Cen1 = loBook.Sheets['tipo_inmueble']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_INMUEBLE"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_INMUEBLE"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_INMUEBLE) 
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_INMUEBLE) 
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT DESTINO_INMUEBLE
Go top
Cen1 = loBook.Sheets['destino_inmueble']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_DESTINO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_DESTINO"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_DESTINO)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_DESTINO)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT ESTADO_INMUEBLE
Go top
Cen1 = loBook.Sheets['estado_inmueble']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_ESTADO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_ESTADO"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_ESTADO)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_ESTADO)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT TIPO_COCINA
Go top
Cen1 = loBook.Sheets['tipo_cocina']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_COCINA"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_COCINA"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_COCINA)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_COCINA)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT TIPO_PISO
Go top
Cen1 = loBook.Sheets['tipo_piso']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_PISO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_PISO"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_PISO)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_PISO)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT TIPO_PARQUEADERO
Go top
Cen1 = loBook.Sheets['tipo_parqueadero']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_PARQUEADERO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_PARQUEADERO"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_PARQUEADERO)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_PARQUEADERO)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT TIPO_CUENTA
Go top
Cen1 = loBook.Sheets['tipo_cuenta']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_CUENTA"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_CUENTA"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_CUENTA)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_CUENTA)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT TIPO_ENTREGA
Go top
Cen1 = loBook.Sheets['tipo_entrega']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_ENTREGA"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_ENTREGA"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_ENTREGA)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_ENTREGA)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT TIPO_PAGO
Go top
Cen1 = loBook.Sheets['tipo_pago']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_PAGO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_PAGO"
 .Range("C"+alltrim(str(linea))).Value ="COD_CUENTA"
 .Range("D"+alltrim(str(linea))).Value ="COD_TIPO_COMPROBANTE"
 .Range("E"+alltrim(str(linea))).Value ="PAGO_AGRUPADO"  
 .Range("F"+alltrim(str(linea))).Value ="REQUIERE_DATOS_CUENTA"
  
linea = 2

  DO WHILE !EOF()
               	 .Range("A"+alltrim(str(linea))).Value = ALLTRIM(COD_TIPO_PAGO)
				 .Range("B"+alltrim(str(linea))).Value = ALLTRIM(NOM_TIPO_PAGO)
				 .Range("C"+alltrim(str(linea))).Value = ALLTRIM(COD_CUENTA)
				 .Range("D"+alltrim(str(linea))).Value = ALLTRIM(COD_TIPO_COMPROBANTE)
				 .Range("E"+alltrim(str(linea))).Value = PAGO_AGRUPADO
				 .Range("F"+alltrim(str(linea))).Value = REQUIERE_DATOS_CUENTA
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT ASEGURADORA
Go top
Cen1 = loBook.Sheets['aseguradora']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value ="COD_ASEGURADORA"
 .Range("B"+alltrim(str(linea))).Value ="NOM_ASEGURADORA"
 .Range("C"+alltrim(str(linea))).Value ="COD_CLIENTE"
 .Range("D"+alltrim(str(linea))).Value ="COD_CTA_FIANZA_SERVICIO"
 .Range("E"+alltrim(str(linea))).Value ="COD_CTA_FIANZA_ARRIENDO"  
 .Range("F"+alltrim(str(linea))).Value ="PORC_ASEGURADORA"
  
linea = 2

  DO WHILE !EOF()
               	 .Range("A"+alltrim(str(linea))).Value = ALLTRIM(COD_ASEGURADORA)
				 .Range("B"+alltrim(str(linea))).Value = ALLTRIM(NOM_ASEGURADORA)
				 .Range("C"+alltrim(str(linea))).Value = ALLTRIM(COD_CLIENTE)
				 .Range("D"+alltrim(str(linea))).Value = ALLTRIM(COD_CTA_FIANZA_SERVICIO)
				 .Range("E"+alltrim(str(linea))).Value = ALLTRIM(COD_CTA_FIANZA_ARRIENDO)
				 .Range("F"+alltrim(str(linea))).Value = PORC_ASEGURADORA
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT TIPO_REAJUSTE
Go top
Cen1 = loBook.Sheets['tipo_reajuste']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_TIPO_REAJUSTE"
 .Range("B"+alltrim(str(linea))).Value ="NOM_TIPO_REAJUSTE"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_REAJUSTE)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_TIPO_REAJUSTE)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT CIUDAD
Go top
Cen1 = loBook.Sheets['ciudad']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_CIUDAD"
 .Range("B"+alltrim(str(linea))).Value ="NOM_CIUDAD"
 .Range("C"+alltrim(str(linea))).Value ="COD_DEPARTAMENTO"
 .Range("D"+alltrim(str(linea))).Value ="COD_DIAN"
 .Range("E"+alltrim(str(linea))).Value ="COD_POSTAL"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_CIUDAD)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_CIUDAD)
               .Range("C"+alltrim(str(linea))).Value =ALLTRIM(COD_DEPARTAMENTO)
               .Range("D"+alltrim(str(linea))).Value =ALLTRIM(COD_DIAN)
               .Range("E"+alltrim(str(linea))).Value =ALLTRIM(COD_POSTAL)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT BARRIO
Go top
Cen1 = loBook.Sheets['barrio']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_BARRIO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_BARRIO"
 .Range("C"+alltrim(str(linea))).Value ="COD_CIUDAD"
 .Range("D"+alltrim(str(linea))).Value ="COD_ZONA"
 .Range("E"+alltrim(str(linea))).Value ="COD_RUTA_PAGO"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_BARRIO)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_BARRIO)
               .Range("C"+alltrim(str(linea))).Value =ALLTRIM(COD_CIUDAD)
               .Range("D"+alltrim(str(linea))).Value =ALLTRIM(COD_ZONA)
               .Range("E"+alltrim(str(linea))).Value =ALLTRIM(COD_RUTA_PAGO)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT estado_fisico
Go top
Cen1 = loBook.Sheets['estado_fisico']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_ESTADO_FISICO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_ESTADO_FISICO"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_ESTADO_FISICO)
               .Range("B"+alltrim(str(linea))).Value =ALLTRIM(NOM_ESTADO_FISICO) 
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

**************************************************************************************************************************
SELECT CLIENTES
Go top
Cen1 = loBook.Sheets['clientes']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_CLIENTE"
 .Range("B"+alltrim(str(linea))).Value ="COD_CIUDAD_DOCUMENTO"
 .Range("C"+alltrim(str(linea))).Value ="PRIMER_NOMBRE"
 .Range("D"+alltrim(str(linea))).Value ="SEGUNDO_NOMBRE"
 .Range("E"+alltrim(str(linea))).Value ="PRIMER_APELLIDO"
 .Range("F"+alltrim(str(linea))).Value ="SEGUNDO_APELLIDO"
 .Range("G"+alltrim(str(linea))).Value ="COD_TIPO_REGIMEN"
 .Range("H"+alltrim(str(linea))).Value ="COD_TIPO_CLIENTE"
 .Range("I"+alltrim(str(linea))).Value ="COD_TIPO_DOCUMENTO"
 .Range("J"+alltrim(str(linea))).Value ="SEQ_PROFESION"
 .Range("K"+alltrim(str(linea))).Value ="FECHA_NACIMIENTO"
 .Range("L"+alltrim(str(linea))).Value ="SEXO"
 .Range("M"+alltrim(str(linea))).Value ="DIR_CLIENTE"
 .Range("N"+alltrim(str(linea))).Value ="DIR_TRABAJO"
 .Range("O"+alltrim(str(linea))).Value ="TEL_CLIENTE" 
 .Range("P"+alltrim(str(linea))).Value ="COD_CIUDAD_CLIENTE"
 .Range("Q"+alltrim(str(linea))).Value ="EMAIL"
 .Range("R"+alltrim(str(linea))).Value ="RETIENE_SOBRE_ICA"
 .Range("S"+alltrim(str(linea))).Value ="RESPONSABLE_IVA_AGENTE_RETENEDOR"
 .Range("T"+alltrim(str(linea))).Value ="IMPUESTO_INDUSTRIA"
 .Range("U"+alltrim(str(linea))).Value ="OBS_CLIENTE"
 .Range("V"+alltrim(str(linea))).Value ="PROFESION"
 .Range("W"+alltrim(str(linea))).Value ="COD_CREE"
 .Range("X"+alltrim(str(linea))).Value ="DECLARA_RENTA"
 .Range("Y"+alltrim(str(linea))).Value ="DV_CLIENTE"
 .Range("Z"+alltrim(str(linea))).Value ="PORC_RETEICA"
 .Range("AA"+alltrim(str(linea))).Value ="DIRECCION_DIAN"
 .Range("AB"+alltrim(str(linea))).Value ="AUTORETENEDOR"
 .Range("AC"+alltrim(str(linea))).Value ="NO_IVA_ARRIENDO"
 .Range("AD"+alltrim(str(linea))).Value ="COD_CIUDAD_DIAN"
 .Range("AE"+alltrim(str(linea))).Value ="DIR_ENVIO_CORRESPONDENCIA"
 .Range("AF"+alltrim(str(linea))).Value ="HOBBIES"
 .Range("AG"+alltrim(str(linea))).Value ="COD_ESTADO_CIVIL"
 .Range("AH"+alltrim(str(linea))).Value ="COD_TITULO"
 .Range("AI"+alltrim(str(linea))).Value ="TIPO_ENVIO_CORRESPONDENCIA"
 .Range("AJ"+alltrim(str(linea))).Value ="BLOQUEAR_PAGO"
 .Range("AK"+alltrim(str(linea))).Value ="COD_BARRIO_CLIENTE"
 .Range("AL"+alltrim(str(linea))).Value ="COD_BARRIO_DIAN"
 .Range("AM"+alltrim(str(linea))).Value ="COD_BARRIO_CORRESPONDENCIA"
 .Range("AN"+alltrim(str(linea))).Value ="COD_BARRIO_DIR_TRABAJO"
linea = 2
  DO WHILE !EOF()
         .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_CLIENTE)
		 .Range("B"+alltrim(str(linea))).Value =ALLTRIM(COD_CIUDAD_DOCUMENTO)
		 .Range("C"+alltrim(str(linea))).Value =ALLTRIM(PRIMER_NOMBRE)
		 .Range("D"+alltrim(str(linea))).Value =ALLTRIM(SEGUNDO_NOMBRE)
		 .Range("E"+alltrim(str(linea))).Value =ALLTRIM(PRIMER_APELLIDO)
		 .Range("F"+alltrim(str(linea))).Value =ALLTRIM(SEGUNDO_APELLIDO)
		 .Range("G"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_REGIMEN)
		 .Range("H"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_CLIENTE)
		 .Range("I"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_DOCUMENTO)
		 .Range("J"+alltrim(str(linea))).Value =SEQ_PROFESION
		 .Range("K"+alltrim(str(linea))).Value =IIF(FECHA_NACIMIENTO={123}},"",FECHA_NACIMIENTO)
		 .Range("L"+alltrim(str(linea))).Value =SEXO
		 .Range("M"+alltrim(str(linea))).Value =ALLTRIM(DIR_CLIENTE)
		 .Range("N"+alltrim(str(linea))).Value =ALLTRIM(DIR_TRABAJO)
		 .Range("O"+alltrim(str(linea))).Value =TEL_CLIENTE
		 .Range("P"+alltrim(str(linea))).Value =ALLTRIM(COD_CIUDAD_CLIENTE)
		 .Range("Q"+alltrim(str(linea))).Value =EMAIL
		 .Range("R"+alltrim(str(linea))).Value =RETIENE_SOBRE_ICA
		 .Range("S"+alltrim(str(linea))).Value =RESPONSABLE_IVA_AGENTE_RETENEDOR
		 .Range("T"+alltrim(str(linea))).Value =IMPUESTO_INDUSTRIA
		 .Range("U"+alltrim(str(linea))).Value =OBS_CLIENTE
		 .Range("V"+alltrim(str(linea))).Value =PROFESION
		 .Range("W"+alltrim(str(linea))).Value =ALLTRIM(COD_CREE)
		 .Range("X"+alltrim(str(linea))).Value =DECLARA_RENTA
		 .Range("Y"+alltrim(str(linea))).Value =DV_CLIENTE
		 .Range("Z"+alltrim(str(linea))).Value =PORC_RETEICA
		 .Range("AA"+alltrim(str(linea))).Value =ALLTRIM(DIRECCION_DIAN)
		 .Range("AB"+alltrim(str(linea))).Value =AUTORETENEDOR
		 .Range("AC"+alltrim(str(linea))).Value =NO_IVA_ARRIENDO
		 .Range("AD"+alltrim(str(linea))).Value =ALLTRIM(COD_CIUDAD_DIAN)
		 .Range("AE"+alltrim(str(linea))).Value =ALLTRIM(DIR_ENVIO_CORRESPONDENCIA)
		 .Range("AF"+alltrim(str(linea))).Value =HOBBIES
		 .Range("AG"+alltrim(str(linea))).Value =ALLTRIM(COD_ESTADO_CIVIL)
		 .Range("AH"+alltrim(str(linea))).Value =ALLTRIM(COD_TITULO)
		 .Range("AI"+alltrim(str(linea))).Value =TIPO_ENVIO_CORRESPONDENCIA
		 .Range("AJ"+alltrim(str(linea))).Value =BLOQUEAR_PAGO
		 .Range("AK"+alltrim(str(linea))).Value =ALLTRIM(COD_BARRIO_CLIENTE)
		 .Range("AL"+alltrim(str(linea))).Value =ALLTRIM(COD_BARRIO_DIAN)
		 .Range("AM"+alltrim(str(linea))).Value =ALLTRIM(COD_BARRIO_CORRESPONDENCIA)
		 .Range("AN"+alltrim(str(linea))).Value =ALLTRIM(COD_BARRIO_DIR_TRABAJO)
         LINEA=LINEA+1
         Skip
  ENDDO
ENDWITH


SELECT cliente_direccion
Go top
Cen1 = loBook.Sheets['cliente_direccion']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_CLIENTE"
 .Range("B"+alltrim(str(linea))).Value ="TIPO_DIRECCION"
 .Range("C"+alltrim(str(linea))).Value ="VIA_PRINCIPAL"
 .Range("D"+alltrim(str(linea))).Value ="EJE_VIAL_1"
 .Range("E"+alltrim(str(linea))).Value ="EJE_VIAL_2"
 .Range("F"+alltrim(str(linea))).Value ="EJE_VIAL_3"
 .Range("G"+alltrim(str(linea))).Value ="COMPLEMENTO_1"
 .Range("H"+alltrim(str(linea))).Value ="COMPLEMENTO_2"
 .Range("I"+alltrim(str(linea))).Value ="COMPLEMENTO_3"
 .Range("J"+alltrim(str(linea))).Value ="COMPLEMENTO_4"
 .Range("K"+alltrim(str(linea))).Value ="COMPLEMENTO_5"
 .Range("L"+alltrim(str(linea))).Value ="COMPLEMENTO_6"
 .Range("M"+alltrim(str(linea))).Value ="COMPLEMENTO_7"
 .Range("N"+alltrim(str(linea))).Value ="COMPLEMENTO_8"
 .Range("O"+alltrim(str(linea))).Value ="ATIPICO"
linea = 2

  DO WHILE !EOF() 
  	
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_cliente)
               .Range("B"+alltrim(str(linea))).Value =Tipo_direccion
               .Range("C"+alltrim(str(linea))).Value =Via_principal 
               .Range("D"+alltrim(str(linea))).Value =eje_vial_1 
               .Range("E"+alltrim(str(linea))).Value =eje_vial_2
               .Range("F"+alltrim(str(linea))).Value =eje_vial_3
               .Range("G"+alltrim(str(linea))).Value =Complemento_1
               .Range("H"+alltrim(str(linea))).Value =Complemento_2
               .Range("I"+alltrim(str(linea))).Value =Complemento_3
               .Range("J"+alltrim(str(linea))).Value =Complemento_4
               .Range("K"+alltrim(str(linea))).Value =Complemento_5
               .Range("L"+alltrim(str(linea))).Value =Complemento_6
               .Range("M"+alltrim(str(linea))).Value =Complemento_7
               .Range("N"+alltrim(str(linea))).Value =Complemento_8
               .Range("O"+alltrim(str(linea))).Value =Atipico
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

****
SELECT INMUEBLE
Go top
Cen1 = loBook.Sheets['inmueble']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet
.Range("A"+alltrim(str(linea))).Value="COD_INMUEBLE"
.Range("B"+alltrim(str(linea))).Value="TEL_INMUEBLE"
.Range("C"+alltrim(str(linea))).Value="COD_INMOBILIARIA"
.Range("D"+alltrim(str(linea))).Value="COD_TIPO_CONSIG"
.Range("E"+alltrim(str(linea))).Value="COD_SUCURSAL"
.Range("F"+alltrim(str(linea))).Value="COD_BARRIO"
.Range("G"+alltrim(str(linea))).Value="COD_TIPO_INMUEBLE"
.Range("H"+alltrim(str(linea))).Value="COD_SUB_TIPO_INMUEBLE"
.Range("I"+alltrim(str(linea))).Value="COD_POT"
.Range("J"+alltrim(str(linea))).Value="COD_DESTINO"
.Range("K"+alltrim(str(linea))).Value="COD_ESTRATO"
.Range("L"+alltrim(str(linea))).Value="COD_ESTADO"
.Range("M"+alltrim(str(linea))).Value="COD_ESTADO_FISICO"
.Range("N"+alltrim(str(linea))).Value="INMUEBLE_NUEVO"
.Range("O"+alltrim(str(linea))).Value="FECHA_CONSIGNACION"
.Range("P"+alltrim(str(linea))).Value="VLR_AVALUO"
.Range("Q"+alltrim(str(linea))).Value="VLR_CANON"
.Range("R"+alltrim(str(linea))).Value="PRECIO_VENTA"
.Range("S"+alltrim(str(linea))).Value="PORC_COMISION"
.Range("T"+alltrim(str(linea))).Value="PORC_COMISION_ANTICIPADA"
.Range("U"+alltrim(str(linea))).Value="VLR_FIANZA"
.Range("V"+alltrim(str(linea))).Value="CANT_CUOTA_FIANZA"
.Range("W"+alltrim(str(linea))).Value="NRO_MATRICULA"
.Range("X"+alltrim(str(linea))).Value="VLR_ADMINISTRACION"
.Range("Y"+alltrim(str(linea))).Value="VLR_PUBLICIDAD"
.Range("Z"+alltrim(str(linea))).Value="VLR_HIPOTECA"
.Range("AA"+alltrim(str(linea))).Value="NRO_ESCRITURA"
.Range("AB"+alltrim(str(linea))).Value="FECHA_ESCRITURA"
.Range("AC"+alltrim(str(linea))).Value="NOTARIA_ESCRITURA"
.Range("AD"+alltrim(str(linea))).Value="COD_UBICACION"
.Range("AE"+alltrim(str(linea))).Value="LIQUIDA_COMISION_G"
.Range("AF"+alltrim(str(linea))).Value="LIQUIDA_COMISION_E"
.Range("AG"+alltrim(str(linea))).Value="VLR_COMISION_ESP"
.Range("AH"+alltrim(str(linea))).Value="EDAD_INMUEBLE"
.Range("AI"+alltrim(str(linea))).Value="DESTACADO_WEB"
.Range("AJ"+alltrim(str(linea))).Value="MUESTRA_FOTO_WEB"
.Range("AK"+alltrim(str(linea))).Value="COD_TIPO_COCINA"
.Range("AL"+alltrim(str(linea))).Value="COD_TIPO_PARQUEADERO"
.Range("AM"+alltrim(str(linea))).Value="COD_TIPO_PISO"
.Range("AN"+alltrim(str(linea))).Value="OBS_INMUEBLE"
.Range("AO"+alltrim(str(linea))).Value="DIR_INMUEBLE"
.Range("AP"+alltrim(str(linea))).Value="SEQ_UNIDAD"
.Range("AQ"+alltrim(str(linea))).Value="COD_TIPO_CONTRATO_MANDATO"
.Range("AR"+alltrim(str(linea))).Value="PUBLICIDAD1"
.Range("AS"+alltrim(str(linea))).Value="PUBLICIDAD2"
.Range("AT"+alltrim(str(linea))).Value="FECHA_RECONSIG"
.Range("AU"+alltrim(str(linea))).Value="PUBLICIDAD3"
.Range("AV"+alltrim(str(linea))).Value="OBS_DISTRIBUCION"
.Range("AX"+alltrim(str(linea))).Value="OBS_SERVICIO_PUBLICO"
.Range("AY"+alltrim(str(linea))).Value="OBS_SERVICIO_COMUN"
.Range("AZ"+alltrim(str(linea))).Value="FECHA_RETIRO"
.Range("BA"+alltrim(str(linea))).Value="COD_CLIENTE_PROMOTOR"
.Range("BB"+alltrim(str(linea))).Value="AREA_LOTE"
.Range("BC"+alltrim(str(linea))).Value="AREA_CONSTRUIDA"
.Range("BD"+alltrim(str(linea))).Value="NRO_PARQUEADERO"
.Range("BE"+alltrim(str(linea))).Value="COD_CLIENTE_PADRINO"
.Range("BF"+alltrim(str(linea))).Value="DIR_VIDEO"
.Range("BG"+alltrim(str(linea))).Value="VLR_CUOTA_ASEO"
.Range("BH"+alltrim(str(linea))).Value="ADMON_POR_DEFINIR"
.Range("BI"+alltrim(str(linea))).Value="COD_SEGURO"
.Range("BJ"+alltrim(str(linea))).Value="NO_COBRAR_INTERES"
.Range("BK"+alltrim(str(linea))).Value="CODIGO_ARCHIVO"
.Range("BL"+alltrim(str(linea))).Value="CODIGO_FINCA_RAIZ"
.Range("BM"+alltrim(str(linea))).Value="CODIGO_METRO_CUAD"
.Range("BN"+alltrim(str(linea))).Value="BLOQUEAR_PAGO"
.Range("BO"+alltrim(str(linea))).Value="PORC_COMISION_ADMON"
.Range("BP"+alltrim(str(linea))).Value="PORC_SEGURO_ADMON"
.Range("BQ"+alltrim(str(linea))).Value="LATITUD"
.Range("BR"+alltrim(str(linea))).Value="LONGITUD"
.Range("BS"+alltrim(str(linea))).Value="COD_RUTA_PAGO"


linea = 2
  DO WHILE !EOF()
        .Range("A"+alltrim(str(linea))).Value=ALLTRIM(COD_INMUEBLE)
		.Range("B"+alltrim(str(linea))).Value=TEL_INMUEBLE
		.Range("C"+alltrim(str(linea))).Value=ALLTRIM(COD_INMOBILIARIA)
		.Range("D"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_CONSIG)
		.Range("E"+alltrim(str(linea))).Value=ALLTRIM(COD_SUCURSAL)
		.Range("F"+alltrim(str(linea))).Value=ALLTRIM(COD_BARRIO)
		.Range("G"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_INMUEBLE)
		.Range("H"+alltrim(str(linea))).Value=ALLTRIM(COD_SUB_TIPO_INM)
		.Range("I"+alltrim(str(linea))).Value=ALLTRIM(COD_POT)
		.Range("J"+alltrim(str(linea))).Value=ALLTRIM(COD_DESTINO)
		.Range("K"+alltrim(str(linea))).Value=ALLTRIM(COD_ESTRATO)
		.Range("L"+alltrim(str(linea))).Value=ALLTRIM(COD_ESTADO)
		.Range("M"+alltrim(str(linea))).Value=ALLTRIM(COD_ESTADO_FIS)
		.Range("N"+alltrim(str(linea))).Value=INMUEBLE_NUEVO
		.Range("O"+alltrim(str(linea))).Value=IIF(FECHA_CONSIGN={123}},"",FECHA_CONSIGN)
		.Range("P"+alltrim(str(linea))).Value=VLR_AVALUO
		.Range("Q"+alltrim(str(linea))).Value=VLR_CANON
		.Range("R"+alltrim(str(linea))).Value=PRECIO_VENTA
		.Range("S"+alltrim(str(linea))).Value=PORC_COMISION
		.Range("T"+alltrim(str(linea))).Value=PORC_COMISION_ANT
		.Range("U"+alltrim(str(linea))).Value=VLR_FIANZA
		.Range("V"+alltrim(str(linea))).Value=CANT_CUOTA_FIANZA
		.Range("W"+alltrim(str(linea))).Value=NRO_MATRICULA
		.Range("X"+alltrim(str(linea))).Value=VLR_ADMINISTRACION
		.Range("Y"+alltrim(str(linea))).Value=VLR_PUBLICIDAD
		.Range("Z"+alltrim(str(linea))).Value=VLR_HIPOTECA
		.Range("AA"+alltrim(str(linea))).Value=NRO_ESCRITURA
		.Range("AB"+alltrim(str(linea))).Value=IIF(FECHA_ESCRITURA={123}},"",FECHA_ESCRITURA)
		.Range("AC"+alltrim(str(linea))).Value=NOTARIA_ESCRITURA
		.Range("AD"+alltrim(str(linea))).Value=ALLTRIM(COD_UBICACION)
		.Range("AE"+alltrim(str(linea))).Value=LIQUIDA_COMISION_G
		.Range("AF"+alltrim(str(linea))).Value=LIQUIDA_COMISION_E
		.Range("AG"+alltrim(str(linea))).Value=VLR_COMISION_ESP
		.Range("AH"+alltrim(str(linea))).Value=EDAD_INMUEBLE
		.Range("AI"+alltrim(str(linea))).Value=DESTACADO_WEB
		.Range("AJ"+alltrim(str(linea))).Value=MUESTRA_FOTO_WEB
		.Range("AK"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_COCINA)
		.Range("AL"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_PARQ)
		.Range("AM"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_PISO)
		.Range("AN"+alltrim(str(linea))).Value=OBS_INMUEBLE
		.Range("AO"+alltrim(str(linea))).Value=ALLTRIM(DIR_INMUEBLE)
		.Range("AP"+alltrim(str(linea))).Value=SEQ_UNIDAD
		.Range("AQ"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_CONT_MAND)
		.Range("AR"+alltrim(str(linea))).Value=PUBLICIDAD1
		.Range("AS"+alltrim(str(linea))).Value=PUBLICIDAD2
		.Range("AT"+alltrim(str(linea))).Value=IIF(FECHA_RECONSIG={123}},"",FECHA_RECONSIG)
		.Range("AU"+alltrim(str(linea))).Value=PUBLICIDAD3
		.Range("AV"+alltrim(str(linea))).Value=OBS_DISTRIBUCION
		.Range("AX"+alltrim(str(linea))).Value=OBS_SERVICIO_PUB
		.Range("AY"+alltrim(str(linea))).Value=OBS_SERVICIO_COM
		.Range("AZ"+alltrim(str(linea))).Value=IIF(FECHA_RETIRO={123}},"",FECHA_RETIRO)
		.Range("BA"+alltrim(str(linea))).Value=ALLTRIM(COD_CLIENTE_PROMOTOR)
		.Range("BB"+alltrim(str(linea))).Value=AREA_LOTE
		.Range("BC"+alltrim(str(linea))).Value=AREA_CONSTRUIDA
		.Range("BD"+alltrim(str(linea))).Value=NRO_PARQUEADERO
		.Range("BE"+alltrim(str(linea))).Value=ALLTRIM(COD_CLIENTE_PAD)
		.Range("BF"+alltrim(str(linea))).Value=ALLTRIM(DIR_VIDEO)
		.Range("BG"+alltrim(str(linea))).Value=VLR_CUOTA_ASEO
		.Range("BH"+alltrim(str(linea))).Value=ADMON_POR_DEFINIR
		.Range("BI"+alltrim(str(linea))).Value=ALLTRIM(COD_SEGURO)
		.Range("BJ"+alltrim(str(linea))).Value=NO_COBRAR_INTERES
		.Range("BK"+alltrim(str(linea))).Value=ALLTRIM(CODIGO_ARCHIVO)
		.Range("BL"+alltrim(str(linea))).Value=ALLTRIM(CODIGO_FINCA_RAIZ)
		.Range("BM"+alltrim(str(linea))).Value=ALLTRIM(CODIGO_METRO_CUAD)
		.Range("BN"+alltrim(str(linea))).Value=BLOQUEAR_PAGO
		.Range("BO"+alltrim(str(linea))).Value=PORC_COMISION_ADMON
		.Range("BP"+alltrim(str(linea))).Value=PORC_SEGURO_ADMON
		.Range("BQ"+alltrim(str(linea))).Value=LATITUD
		.Range("BR"+alltrim(str(linea))).Value=LONGITUD
		.Range("BS"+alltrim(str(linea))).Value=ALLTRIM(COD_RUTA_PAGO)

         LINEA=LINEA+1
         Skip
  ENDDO
ENDWITH


SELECT inmueble_direccion
Go top
Cen1 = loBook.Sheets['inmueble_direccion']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_INMUEBLE"
 .Range("B"+alltrim(str(linea))).Value ="VIA_PRINCIPAL"
 .Range("C"+alltrim(str(linea))).Value ="EJE_VIAL_1"
 .Range("D"+alltrim(str(linea))).Value ="EJE_VIAL_2"
 .Range("E"+alltrim(str(linea))).Value ="EJE_VIAL_3"
 .Range("F"+alltrim(str(linea))).Value ="COMPLEMENTO_1"
 .Range("G"+alltrim(str(linea))).Value ="COMPLEMENTO_2"
 .Range("H"+alltrim(str(linea))).Value ="COMPLEMENTO_3"
 .Range("I"+alltrim(str(linea))).Value ="COMPLEMENTO_4"
 .Range("J"+alltrim(str(linea))).Value ="COMPLEMENTO_5"
 .Range("K"+alltrim(str(linea))).Value ="COMPLEMENTO_6"
 .Range("L"+alltrim(str(linea))).Value ="COMPLEMENTO_7"
 .Range("M"+alltrim(str(linea))).Value ="COMPLEMENTO_8"
 .Range("N"+alltrim(str(linea))).Value ="ATIPICO"
linea = 2

  DO WHILE !EOF() 
  	
               .Range("A"+alltrim(str(linea))).Value =ALLTRIM(COD_inmueble)
               .Range("B"+alltrim(str(linea))).Value =Via_principal 
               .Range("C"+alltrim(str(linea))).Value =eje_vial_1 
               .Range("D"+alltrim(str(linea))).Value =eje_vial_2
               .Range("E"+alltrim(str(linea))).Value =eje_vial_3
               .Range("F"+alltrim(str(linea))).Value =Complemento_1
               .Range("G"+alltrim(str(linea))).Value =Complemento_2
               .Range("H"+alltrim(str(linea))).Value =Complemento_3
               .Range("I"+alltrim(str(linea))).Value =Complemento_4
               .Range("J"+alltrim(str(linea))).Value =Complemento_5
               .Range("K"+alltrim(str(linea))).Value =Complemento_6
               .Range("L"+alltrim(str(linea))).Value =Complemento_7
               .Range("M"+alltrim(str(linea))).Value =Complemento_8
               .Range("N"+alltrim(str(linea))).Value =Atipico
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH


SELECT inmueble_propietario
Go top
Cen1 = loBook.Sheets['inmueble_propietario']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "SEQ_PROPIETARIO"
 .Range("B"+alltrim(str(linea))).Value ="COD_INMUEBLE"
 .Range("C"+alltrim(str(linea))).Value ="COD_CLIENTE_PROPIETARIO"
 .Range("D"+alltrim(str(linea))).Value ="COD_CLIENTE_BENEFICIARIO"
 .Range("E"+alltrim(str(linea))).Value ="COD_CLIENTE_REPRESENTANTE"
 .Range("F"+alltrim(str(linea))).Value ="PORC_PAGO"
 .Range("G"+alltrim(str(linea))).Value ="NRO_CUENTA"
 .Range("H"+alltrim(str(linea))).Value ="COD_CIUDAD"
 .Range("I"+alltrim(str(linea))).Value ="COD_BANCO"
 .Range("J"+alltrim(str(linea))).Value ="COD_TIPO_PAGO"
 .Range("K"+alltrim(str(linea))).Value ="COD_TIPO_ENTREGA"
 .Range("L"+alltrim(str(linea))).Value ="COD_TIPO_CUENTA"

linea = 2

  DO WHILE !EOF() 
  	
	 .Range("A"+alltrim(str(linea))).Value =SEQ_PROPIETARIO
	 .Range("B"+alltrim(str(linea))).Value =ALLTRIM(COD_INMUEBLE)
	 .Range("C"+alltrim(str(linea))).Value =ALLTRIM(COD_CLIENTE_PROPIETARIO)
	 .Range("D"+alltrim(str(linea))).Value =ALLTRIM(COD_CLIENTE_BENEFICIARIO)
	 .Range("E"+alltrim(str(linea))).Value =ALLTRIM(COD_CLIENTE_REPRESENTANTE)
	 .Range("F"+alltrim(str(linea))).Value =PORC_PAGO
	 .Range("G"+alltrim(str(linea))).Value =NRO_CUENTA
	 .Range("H"+alltrim(str(linea))).Value =ALLTRIM(COD_CIUDAD)
	 .Range("I"+alltrim(str(linea))).Value =ALLTRIM(COD_BANCO)
	 .Range("J"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_PAGO)
	 .Range("K"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_ENTREGA)
	 .Range("L"+alltrim(str(linea))).Value =ALLTRIM(COD_TIPO_CUENTA)
     LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT CONTRATO
Go top
Cen1 = loBook.Sheets['contrato']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet
.Range("A"+alltrim(str(linea))).Value="SEQ_CONTRATO"
.Range("B"+alltrim(str(linea))).Value="COD_INMUEBLE"
.Range("C"+alltrim(str(linea))).Value="COD_CLIENTE_ARRENDATARIO1"
.Range("D"+alltrim(str(linea))).Value="COD_CLIENTE_ARRENDATARIO2"
.Range("E"+alltrim(str(linea))).Value="COD_CLIENTE_REPRESENTANTE1"
.Range("F"+alltrim(str(linea))).Value="COD_CLIENTE_REPRESENTANTE2"
.Range("G"+alltrim(str(linea))).Value="COD_ASEGURADORA"
.Range("H"+alltrim(str(linea))).Value="COD_ABOGADO"
.Range("I"+alltrim(str(linea))).Value="NRO_SOLICITUD"
.Range("J"+alltrim(str(linea))).Value="COD_SUCURSAL"
.Range("K"+alltrim(str(linea))).Value="COD_DESTINO"
.Range("L"+alltrim(str(linea))).Value="COD_TIPO_DESOCUPACION"
.Range("M"+alltrim(str(linea))).Value="COD_ESTADO_CONTRATO"
.Range("N"+alltrim(str(linea))).Value="COD_TIPO_CONTRATO"
.Range("O"+alltrim(str(linea))).Value="COD_TIPO_CONTRATO_MANDATO"
.Range("P"+alltrim(str(linea))).Value="COD_TIPO_REAJUSTE"
.Range("Q"+alltrim(str(linea))).Value="COD_TIPO_PINTURA"
.Range("R"+alltrim(str(linea))).Value="COD_INTERNO_ASEGURADORA"
.Range("S"+alltrim(str(linea))).Value="FECHA_CONTRATO"
.Range("T"+alltrim(str(linea))).Value="FECHA_LIQUIDACION"
.Range("U"+alltrim(str(linea))).Value="FECHA_POSIBLE_DESOCUPACION"
.Range("V"+alltrim(str(linea))).Value="DIR_ENVIO_CORRESPONDENCIA"
.Range("W"+alltrim(str(linea))).Value="COD_CIUDAD_CORRESPONDENCIA"
.Range("X"+alltrim(str(linea))).Value="DIAS_GRACIA"
.Range("Y"+alltrim(str(linea))).Value="VLR_CANON"
.Range("Z"+alltrim(str(linea))).Value="VLR_FIANZA"
.Range("AA"+alltrim(str(linea))).Value="VLR_DOCUMENTOS"
.Range("AB"+alltrim(str(linea))).Value="VLR_CANON_CESION"
.Range("AC"+alltrim(str(linea))).Value="DIAS_INDEMNIZACION"
.Range("AD"+alltrim(str(linea))).Value="VLR_INDEMNIZACION"
.Range("AE"+alltrim(str(linea))).Value="PORC_REAJUSTE"
.Range("AF"+alltrim(str(linea))).Value="PORC_REAJUSTE_ADICIONAL"
.Range("AG"+alltrim(str(linea))).Value="MESES_DURACION_CONTRATO"
.Range("AH"+alltrim(str(linea))).Value="CLAUSULA"
.Range("AI"+alltrim(str(linea))).Value="OBS_CONTRATO"
.Range("AJ"+alltrim(str(linea))).Value="DETALLE_DESTINO"
.Range("AK"+alltrim(str(linea))).Value="CESION"
.Range("AL"+alltrim(str(linea))).Value="FECHA_CORTE"
.Range("AM"+alltrim(str(linea))).Value="RETENER_FACTURA"
.Range("AN"+alltrim(str(linea))).Value="DISPONIBLE_ARRIENDO"
.Range("AO"+alltrim(str(linea))).Value="RETIENE_PAGO_MORA_SRV"
.Range("AP"+alltrim(str(linea))).Value="AUTORIZA_SERVICIOS"
.Range("AQ"+alltrim(str(linea))).Value="COD_BARRIO"
.Range("AR"+alltrim(str(linea))).Value="FECHA_INGRESO"
.Range("AS"+alltrim(str(linea))).Value="VLR_CESION"
.Range("AT"+alltrim(str(linea))).Value="NO_REPORTAR_CIFIN"
.Range("AU"+alltrim(str(linea))).Value="NOMBRE_ENTREGA"
.Range("AV"+alltrim(str(linea))).Value="LLAVES_ENTREGA"
.Range("AX"+alltrim(str(linea))).Value="LINEAS_ACTUALES"
.Range("AY"+alltrim(str(linea))).Value="LINEAS_RETIRADAS"
.Range("AZ"+alltrim(str(linea))).Value="NEGOCIAR_INDEMNIZACION"
.Range("BA"+alltrim(str(linea))).Value="FECHA_DESOCUPACION"
.Range("BB"+alltrim(str(linea))).Value="SALDO_FIANZA"
.Range("BC"+alltrim(str(linea))).Value="COD_CLIENTE_PROMOTOR"
.Range("BD"+alltrim(str(linea))).Value="PORC_RETEIVA"
.Range("BE"+alltrim(str(linea))).Value="COD_MOTIVO_DESOCUPACION"
.Range("BF"+alltrim(str(linea))).Value="RETENER_SISTEMAS"
.Range("BG"+alltrim(str(linea))).Value="REAJUSTE_MINIMO"
.Range("BH"+alltrim(str(linea))).Value="REPORTE_SERVICIOS"
.Range("BI"+alltrim(str(linea))).Value="PORC_ASEGURADORA"
.Range("BJ"+alltrim(str(linea))).Value="CODIGO_ARCHIVO"
.Range("BK"+alltrim(str(linea))).Value="VR_FIANZA_SERVICIOS"
.Range("BL"+alltrim(str(linea))).Value="COD_ASEGURADORA_FIANZA"
.Range("BM"+alltrim(str(linea))).Value="NO_RENOVAR"
.Range("BN"+alltrim(str(linea))).Value="BLOQUEO_PAGO"
.Range("BO"+alltrim(str(linea))).Value="OBS_BLOQUEO_PAGO"
.Range("BP"+alltrim(str(linea))).Value="NO_COBRAR_CARTAS"
.Range("BQ"+alltrim(str(linea))).Value="VR_DEUDA_SERVICIOS"
.Range("BR"+alltrim(str(linea))).Value="VR_DEUDA_REPARACIONES"
.Range("BS"+alltrim(str(linea))).Value="CODIGO_FINCA_RAIZ"
.Range("BT"+alltrim(str(linea))).Value="CODIGO_METRO_CUADRADO"
.Range("BU"+alltrim(str(linea))).Value="NO_COBRAR_INTERES"
.Range("BV"+alltrim(str(linea))).Value="PORC_RETEICA"



linea = 2
  DO WHILE !EOF()
        .Range("A"+alltrim(str(linea))).Value=SEQ_CONTRATO
		.Range("B"+alltrim(str(linea))).Value=ALLTRIM(COD_INMUEBLE)
		.Range("C"+alltrim(str(linea))).Value=ALLTRIM(COD_CLIENTE_ARRENDATARIO1)
		.Range("D"+alltrim(str(linea))).Value=ALLTRIM(COD_CLIENTE_ARRENDATARIO2)
		.Range("E"+alltrim(str(linea))).Value=ALLTRIM(COD_CLIENTE_REPRESENTANTE1)
		.Range("F"+alltrim(str(linea))).Value=ALLTRIM(COD_CLIENTE_REPRESENTANTE2)
		.Range("G"+alltrim(str(linea))).Value=ALLTRIM(COD_ASEGURADORA)
		.Range("H"+alltrim(str(linea))).Value=ALLTRIM(COD_ABOGADO)
		.Range("I"+alltrim(str(linea))).Value=NRO_SOLICITUD
		.Range("J"+alltrim(str(linea))).Value=ALLTRIM(COD_SUCURSAL)
		.Range("K"+alltrim(str(linea))).Value=ALLTRIM(COD_DESTINO)
		.Range("L"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_DESOCUPACION)
		.Range("M"+alltrim(str(linea))).Value=ALLTRIM(COD_ESTADO_CONTRATO)
		.Range("N"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_CONTRATO)
		.Range("O"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_CONTRATO_MANDATO)
		.Range("P"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_REAJUSTE)
		.Range("Q"+alltrim(str(linea))).Value=ALLTRIM(COD_TIPO_PINTURA)
		.Range("R"+alltrim(str(linea))).Value=ALLTRIM(COD_INTERNO_ASEGURADORA)
		.Range("S"+alltrim(str(linea))).Value=IIF(FECHA_CONTRATO={123}},"",FECHA_CONTRATO)
		.Range("T"+alltrim(str(linea))).Value=IIF(FECHA_LIQUIDACION={123}},"",FECHA_LIQUIDACION)
		.Range("U"+alltrim(str(linea))).Value=IIF(FECHA_POSIBLE_DESOCUPACION={123}},"",FECHA_POSIBLE_DESOCUPACION)
		.Range("V"+alltrim(str(linea))).Value=ALLTRIM(DIR_ENVIO_CORRESPONDENCIA)
		.Range("W"+alltrim(str(linea))).Value=ALLTRIM(COD_CIUDAD_CORRESPONDENCIA)
		.Range("X"+alltrim(str(linea))).Value=DIAS_GRACIA
		.Range("Y"+alltrim(str(linea))).Value=VLR_CANON
		.Range("Z"+alltrim(str(linea))).Value=VLR_FIANZA
		.Range("AA"+alltrim(str(linea))).Value=VLR_DOCUMENTOS
		.Range("AB"+alltrim(str(linea))).Value=VLR_CANON_CESION
		.Range("AC"+alltrim(str(linea))).Value=DIAS_INDEMNIZACION
		.Range("AD"+alltrim(str(linea))).Value=VLR_INDEMNIZACION
		.Range("AE"+alltrim(str(linea))).Value=PORC_REAJUSTE
		.Range("AF"+alltrim(str(linea))).Value=PORC_REAJUSTE_ADICIONAL
		.Range("AG"+alltrim(str(linea))).Value=MESES_DURACION_CONTRATO
		.Range("AH"+alltrim(str(linea))).Value=CLAUSULA
		.Range("AI"+alltrim(str(linea))).Value=OBS_CONTRATO
		.Range("AJ"+alltrim(str(linea))).Value=DETALLE_DESTINO
		.Range("AK"+alltrim(str(linea))).Value=CESION
		.Range("AL"+alltrim(str(linea))).Value=IIF(FECHA_CORTE={123}},"",FECHA_CORTE)
		.Range("AM"+alltrim(str(linea))).Value=RETENER_FACTURA
		.Range("AN"+alltrim(str(linea))).Value=DISPONIBLE_ARRIENDO
		.Range("AO"+alltrim(str(linea))).Value=RETIENE_PAGO_MORA_SRV
		.Range("AP"+alltrim(str(linea))).Value=AUTORIZA_SERVICIOS
		.Range("AQ"+alltrim(str(linea))).Value=ALLTRIM(COD_BARRIO)
		.Range("AR"+alltrim(str(linea))).Value=IIF(FECHA_INGRESO={123}},"",FECHA_INGRESO)
		.Range("AS"+alltrim(str(linea))).Value=VLR_CESION
		.Range("AT"+alltrim(str(linea))).Value=NO_REPORTAR_CIFIN
		.Range("AU"+alltrim(str(linea))).Value=ALLTRIM(NOMBRE_ENTREGA)
		.Range("AV"+alltrim(str(linea))).Value=LLAVES_ENTREGA
		.Range("AX"+alltrim(str(linea))).Value=LINEAS_ACTUALES
		.Range("AY"+alltrim(str(linea))).Value=LINEAS_RETIRADAS
		.Range("AZ"+alltrim(str(linea))).Value=NEGOCIAR_INDEMNIZACION
		.Range("BA"+alltrim(str(linea))).Value=IIF(FECHA_DESOCUPACION={123}},"",FECHA_DESOCUPACION)
		.Range("BB"+alltrim(str(linea))).Value=SALDO_FIANZA
		.Range("BC"+alltrim(str(linea))).Value=ALLTRIM(COD_CLIENTE_PROMOTOR)
		.Range("BD"+alltrim(str(linea))).Value=PORC_RETEIVA
		.Range("BE"+alltrim(str(linea))).Value=ALLTRIM(COD_MOTIVO_DESOCUPACION)
		.Range("BF"+alltrim(str(linea))).Value=RETENER_SISTEMAS
		.Range("BG"+alltrim(str(linea))).Value=REAJUSTE_MINIMO
		.Range("BH"+alltrim(str(linea))).Value=IIF(REPORTE_SERVICIOS={123}},"",REPORTE_SERVICIOS)
		.Range("BI"+alltrim(str(linea))).Value=PORC_ASEGURADORA
		.Range("BJ"+alltrim(str(linea))).Value=ALLTRIM(CODIGO_ARCHIVO)
		.Range("BK"+alltrim(str(linea))).Value=VR_FIANZA_SERVICIOS
		.Range("BL"+alltrim(str(linea))).Value=ALLTRIM(COD_ASEGURADORA_FIANZA)
		.Range("BM"+alltrim(str(linea))).Value=NO_RENOVAR
		.Range("BN"+alltrim(str(linea))).Value=BLOQUEO_PAGO
		.Range("BO"+alltrim(str(linea))).Value=OBS_BLOQUEO_PAGO
		.Range("BP"+alltrim(str(linea))).Value=NO_COBRAR_CARTAS
		.Range("BQ"+alltrim(str(linea))).Value=VR_DEUDA_SERVICIOS
		.Range("BR"+alltrim(str(linea))).Value=VR_DEUDA_REPARACIONES
		.Range("BS"+alltrim(str(linea))).Value=ALLTRIM(CODIGO_FINCA_RAIZ)
		.Range("BT"+alltrim(str(linea))).Value=ALLTRIM(CODIGO_METRO_CUADRADO)
		.Range("BU"+alltrim(str(linea))).Value=NO_COBRAR_INTERES
		.Range("BV"+alltrim(str(linea))).Value=PORC_RETEICA


         LINEA=LINEA+1
         Skip
  ENDDO
ENDWITH

SELECT CONTRATO_FIADOR
Go top
Cen1 = loBook.Sheets['contrato_fiador']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "SEQ_CONTRATO_FIADOR"
 .Range("B"+alltrim(str(linea))).Value ="SEQ_CONTRATO"
 .Range("C"+alltrim(str(linea))).Value ="COD_CLIENTE"
 
linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =SEQ_CONTRATO_FIADOR
               .Range("B"+alltrim(str(linea))).Value =SEQ_CONTRATO
               .Range("C"+alltrim(str(linea))).Value =ALLTRIM(COD_CLIENTE)
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT contrato_direccion
Go top
Cen1 = loBook.Sheets['contrato_direccion']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "SEQ_CONTRATO"
 .Range("B"+alltrim(str(linea))).Value ="VIA_PRINCIPAL"
 .Range("C"+alltrim(str(linea))).Value ="EJE_VIAL_1"
 .Range("D"+alltrim(str(linea))).Value ="EJE_VIAL_2"
 .Range("E"+alltrim(str(linea))).Value ="EJE_VIAL_3"
 .Range("F"+alltrim(str(linea))).Value ="COMPLEMENTO_1"
 .Range("G"+alltrim(str(linea))).Value ="COMPLEMENTO_2"
 .Range("H"+alltrim(str(linea))).Value ="COMPLEMENTO_3"
 .Range("I"+alltrim(str(linea))).Value ="COMPLEMENTO_4"
 .Range("J"+alltrim(str(linea))).Value ="COMPLEMENTO_5"
 .Range("K"+alltrim(str(linea))).Value ="COMPLEMENTO_6"
 .Range("L"+alltrim(str(linea))).Value ="COMPLEMENTO_7"
 .Range("M"+alltrim(str(linea))).Value ="COMPLEMENTO_8"
 .Range("N"+alltrim(str(linea))).Value ="ATIPICO"
linea = 2

  DO WHILE !EOF() 
  	
               .Range("A"+alltrim(str(linea))).Value =seq_contrato
               .Range("B"+alltrim(str(linea))).Value =Via_principal 
               .Range("C"+alltrim(str(linea))).Value =eje_vial_1 
               .Range("D"+alltrim(str(linea))).Value =eje_vial_2
               .Range("E"+alltrim(str(linea))).Value =eje_vial_3
               .Range("F"+alltrim(str(linea))).Value =Complemento_1
               .Range("G"+alltrim(str(linea))).Value =Complemento_2
               .Range("H"+alltrim(str(linea))).Value =Complemento_3
               .Range("I"+alltrim(str(linea))).Value =Complemento_4
               .Range("J"+alltrim(str(linea))).Value =Complemento_5
               .Range("K"+alltrim(str(linea))).Value =Complemento_6
               .Range("L"+alltrim(str(linea))).Value =Complemento_7
               .Range("M"+alltrim(str(linea))).Value =Complemento_8
               .Range("N"+alltrim(str(linea))).Value =Atipico
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH




_Screen.LockScreen= .F.
RELEASE loExcel

MESSAGEBOX("Archivo generado...",0+64,"Base de Datos Inmuebles")








ENDPROC
PROCEDURE exportar_informacion_conta
WAIT WINDOW NOWAIT "Generando excel conta....No lo abra hasta que no se le indique"  

SET DATE DMY 


loExcel=Createobject("Excel.application")
loExcel.Visible = .T.
loBook = loExcel.Workbooks.Open('F:/ORBIS/DOCS/BD_ORBIS_CONTA.XLS')  &&este es el archivo

SELECT BANCO
Go top
Cen1 = loBook.Sheets['banco']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_BANCO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_BANCO"
 .Range("C"+alltrim(str(linea))).Value ="VLR_TRANSACCION"
 .Range("D"+alltrim(str(linea))).Value ="CODIGO_PLATAFORMA"
 .Range("E"+alltrim(str(linea))).Value ="DIGITO_CHEQUEO"
 
linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =COD_BANCO
               .Range("B"+alltrim(str(linea))).Value =NOM_BANCO
               .Range("C"+alltrim(str(linea))).Value =VLR_TRANSACCION
               .Range("D"+alltrim(str(linea))).Value =CODIGO_PLATAFORMA
               .Range("E"+alltrim(str(linea))).Value =DIGITO_CHEQUEO
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT CCOSTO
Go top
Cen1 = loBook.Sheets['centro_costo']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "COD_CENTRO_COSTO"
 .Range("B"+alltrim(str(linea))).Value ="NOM_CENTRO_COSTO"

linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =IDCCOSTO 
               .Range("B"+alltrim(str(linea))).Value =CENTRO_COSTO
                 LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT COMPROBANTE
Go top
Cen1 = loBook.Sheets['comprobante']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value = "SEQ_COMPROBANTE"
 .Range("B"+alltrim(str(linea))).Value ="COD_TIPO_COMPROBANTE"
 .Range("C"+alltrim(str(linea))).Value ="NRO_COMPROBANTE"
 .Range("D"+alltrim(str(linea))).Value ="FECHA_COMPROBANTE"
 .Range("E"+alltrim(str(linea))).Value ="CONTABILIZADO"
 .Range("F"+alltrim(str(linea))).Value ="ACTUALIZA_SALDO"
 .Range("G"+alltrim(str(linea))).Value ="NOTA_ACLARATORIA"
 linea = 2

  DO WHILE !EOF()
               .Range("A"+alltrim(str(linea))).Value =SEQ_COMPROBANTE
               .Range("B"+alltrim(str(linea))).Value =COD_TIPO_COMPROBANTE
               .Range("C"+alltrim(str(linea))).Value =NRO_COMPROBANTE
               .Range("D"+alltrim(str(linea))).Value =IIF(FECHA_COMPROBANTE={123}},"",FECHA_COMPROBANTE)
               .Range("E"+alltrim(str(linea))).Value =CONTABILIZADO
               .Range("F"+alltrim(str(linea))).Value =ACTUALIZA_SALDO
               .Range("G"+alltrim(str(linea))).Value =NOTA_ACLARATORIA
                LINEA=LINEA+1
           Skip
  ENDDO
ENDWITH

SELECT COMPROBANTE_DETALLE
Go top
Cen1 = loBook.Sheets['comprobante_detalle']    && Esta es la hoja
linea = 1  &&& desde que fila empiezan
ban=0
Cen1.ACTIVATE
WITH lobook.ActiveSheet

 .Range("A"+alltrim(str(linea))).Value ="SEQ_COMPROBANTE_DETALLE"
 .Range("B"+alltrim(str(linea))).Value ="SEQ_COMPROBANTE"
 .Range("C"+alltrim(str(linea))).Value ="SEQ_COMPROBANTE_ANULA"
 .Range("D"+alltrim(str(linea))).Value ="DETALLE_REGISTRO"
 .Range("E"+alltrim(str(linea))).Value ="COD_CLIENTE"
 .Range("F"+alltrim(str(linea))).Value ="COD_CUENTA"
 .Range("G"+alltrim(str(linea))).Value ="COD_CONCEPTO"
 .Range("H"+alltrim(str(linea))).Value ="VLR_DEBE"
 .Range("I"+alltrim(str(linea))).Value ="VLR_HABER"
 .Range("J"+alltrim(str(linea))).Value ="COD_TIPO_SOPORTE"
 .Range("K"+alltrim(str(linea))).Value ="NRO_DOC_SOPORTE"
 .Range("L"+alltrim(str(linea))).Value ="FECHA_DOC_SOPORTE"
 .Range("M"+alltrim(str(linea))).Value ="COD_TIPO_INGRESO"
 .Range("N"+alltrim(str(linea))).Value ="NRO_DOC_PAGO"
 .Range("O"+alltrim(str(linea))).Value ="FECHA_DOC_PAGO"
 .Range("P"+alltrim(str(linea))).Value ="COD_BANCO" 
 .Range("Q"+alltrim(str(linea))).Value ="MES"
 .Range("R"+alltrim(str(linea))).Value ="ANO"
 .Range("S"+alltrim(str(linea))).Value ="COMPROBANTE_CIERRE"
 .Range("T"+alltrim(str(linea))).Value ="APLICA_IVA"
 .Range("U"+alltrim(str(linea))).Value ="APLICA_RFTE"
 .Range("V"+alltrim(str(linea))).Value ="SEQ_CONTRATO"
 .Range("W"+alltrim(str(linea))).Value ="COD_INMUEBLE"
 .Range("X"+alltrim(str(linea))).Value ="COD_SUCURSAL"
 .Range("Y"+alltrim(str(linea))).Value ="NRO_CHEQUE"
 .Range("Z"+alltrim(str(linea))).Value ="NRO_FACTURA_VARIOS"
 .Range("AA"+alltrim(str(linea))).Value ="CDEBE"
 .Range("AB"+alltrim(str(linea))).Value ="CHABER"
 .Range("AC"+alltrim(str(linea))).Value ="COD_CENTRO_COSTO"
 .Range("AD"+alltrim(str(linea))).Value ="VLR_BASE"
 .Range("AE"+alltrim(str(linea))).Value ="COD_CUENTA_NIIF"
ENDWITH  
linea = 2
  n = 0 	
  DO WHILE !EOF()
  	IF LINEA<=65500
  		WITH lobook.ActiveSheet
	         .Range("A"+alltrim(str(linea))).Value =SEQ_COMPROBANTE_DETALLE
			 .Range("B"+alltrim(str(linea))).Value =SEQ_COMPROBANTE
			 .Range("C"+alltrim(str(linea))).Value =SEQ_COMPROBANTE_ANULA
			 .Range("D"+alltrim(str(linea))).Value =DETALLE_REGISTRO
			 .Range("E"+alltrim(str(linea))).Value =COD_CLIENTE
			 .Range("F"+alltrim(str(linea))).Value =COD_CUENTA
			 .Range("G"+alltrim(str(linea))).Value =COD_CONCEPTO
			 .Range("H"+alltrim(str(linea))).Value =VLR_DEBE
			 .Range("I"+alltrim(str(linea))).Value =VLR_HABER
			 .Range("J"+alltrim(str(linea))).Value =COD_TIPO_SOPORTE
			 .Range("K"+alltrim(str(linea))).Value =NRO_DOC_SOPORTE
			 .Range("L"+alltrim(str(linea))).Value =IIF(FECHA_DOC_SOPORTE={123}},"",FECHA_DOC_SOPORTE)
			 .Range("M"+alltrim(str(linea))).Value =COD_TIPO_INGRESO
			 .Range("N"+alltrim(str(linea))).Value =NRO_DOC_PAGO
			 .Range("O"+alltrim(str(linea))).Value =IIF(FECHA_DOC_PAGO={123}},"",FECHA_DOC_PAGO)
			 .Range("P"+alltrim(str(linea))).Value =COD_BANCO
			 .Range("Q"+alltrim(str(linea))).Value =MES
			 .Range("R"+alltrim(str(linea))).Value =ANO
			 .Range("S"+alltrim(str(linea))).Value =COMPROBANTE_CIERRE
			 .Range("T"+alltrim(str(linea))).Value =APLICA_IVA
			 .Range("U"+alltrim(str(linea))).Value =APLICA_RFTE
			 .Range("V"+alltrim(str(linea))).Value =SEQ_CONTRATO
			 .Range("W"+alltrim(str(linea))).Value =COD_INMUEBLE
			 .Range("X"+alltrim(str(linea))).Value =COD_SUCURSAL
			 .Range("Y"+alltrim(str(linea))).Value =NRO_CHEQUE
			 .Range("Z"+alltrim(str(linea))).Value =NRO_FACTURA_VARIOS
			 .Range("AA"+alltrim(str(linea))).Value =CDEBE
			 .Range("AB"+alltrim(str(linea))).Value =CHABER
			 .Range("AC"+alltrim(str(linea))).Value =COD_CENTRO_COSTO
			 .Range("AD"+alltrim(str(linea))).Value =VLR_BASE
			 .Range("AE"+alltrim(str(linea))).Value =COD_CUENTA_NIIF
			 ENDWITH
	         LINEA=LINEA+1
	         SKIP
	  ELSE 
	  	n=n+1
	  	lcCad = "comprobante_detalle_"+ALLTRIM(STR(n))
		Cen1 = loBook.Sheets[lccad]    && Esta es la hoja
		linea = 1  &&& desde que fila empiezan
		ban=0
		Cen1.ACTIVATE
		WITH lobook.ActiveSheet

		 .Range("A"+alltrim(str(linea))).Value ="SEQ_COMPROBANTE_DETALLE"
		 .Range("B"+alltrim(str(linea))).Value ="SEQ_COMPROBANTE"
		 .Range("C"+alltrim(str(linea))).Value ="SEQ_COMPROBANTE_ANULA"
		 .Range("D"+alltrim(str(linea))).Value ="DETALLE_REGISTRO"
		 .Range("E"+alltrim(str(linea))).Value ="COD_CLIENTE"
		 .Range("F"+alltrim(str(linea))).Value ="COD_CUENTA"
		 .Range("G"+alltrim(str(linea))).Value ="COD_CONCEPTO"
		 .Range("H"+alltrim(str(linea))).Value ="VLR_DEBE"
		 .Range("I"+alltrim(str(linea))).Value ="VLR_HABER"
		 .Range("J"+alltrim(str(linea))).Value ="COD_TIPO_SOPORTE"
		 .Range("K"+alltrim(str(linea))).Value ="NRO_DOC_SOPORTE"
		 .Range("L"+alltrim(str(linea))).Value ="FECHA_DOC_SOPORTE"
		 .Range("M"+alltrim(str(linea))).Value ="COD_TIPO_INGRESO"
		 .Range("N"+alltrim(str(linea))).Value ="NRO_DOC_PAGO"
		 .Range("O"+alltrim(str(linea))).Value ="FECHA_DOC_PAGO"
		 .Range("P"+alltrim(str(linea))).Value ="COD_BANCO" 
		 .Range("Q"+alltrim(str(linea))).Value ="MES"
		 .Range("R"+alltrim(str(linea))).Value ="ANO"
		 .Range("S"+alltrim(str(linea))).Value ="COMPROBANTE_CIERRE"
		 .Range("T"+alltrim(str(linea))).Value ="APLICA_IVA"
		 .Range("U"+alltrim(str(linea))).Value ="APLICA_RFTE"
		 .Range("V"+alltrim(str(linea))).Value ="SEQ_CONTRATO"
		 .Range("W"+alltrim(str(linea))).Value ="COD_INMUEBLE"
		 .Range("X"+alltrim(str(linea))).Value ="COD_SUCURSAL"
		 .Range("Y"+alltrim(str(linea))).Value ="NRO_CHEQUE"
		 .Range("Z"+alltrim(str(linea))).Value ="NRO_FACTURA_VARIOS"
		 .Range("AA"+alltrim(str(linea))).Value ="CDEBE"
		 .Range("AB"+alltrim(str(linea))).Value ="CHABER"
		 .Range("AC"+alltrim(str(linea))).Value ="COD_CENTRO_COSTO"
		 .Range("AD"+alltrim(str(linea))).Value ="VLR_BASE"
		 .Range("AE"+alltrim(str(linea))).Value ="COD_CUENTA_NIIF"
		ENDWITH	  
		linea = 2		  	
	  ENDIF       
  ENDDO
  
  _Screen.LockScreen= .F.
RELEASE loExcel

MESSAGEBOX("Archivo generado...",0+64,"Base de Datos Conta")

ENDPROC
PROCEDURE Init

SELECT nits 
*DELETE ALL FOR INLIST(VAL(NIT),21,1325,2320,5842,17106001,23653002,1355150501,28447092,80401558,9002683594,13809502,123456789012345) IN NITS

UPDATE NITS SET NOMBRE = "(NO GRABAR)"+" "+ALLTRIM(NITS.NOMBRE) WHERE INLIST(VAL(NIT),21,1325,2320,5842,17106001,23653002,1355150501,28447092,80401558,9002683594,13809502,123456789012345)
UPDATE nits SET nit="91507119" WHERE ALLTRIM(nit)=="91507119CRA"
UPDATE nits SET nit="37799270" WHERE ALLTRIM(nit)=="37799270A"         
UPDATE nits SET nit="19582116" WHERE ALLTRIM(nit)=="19582116|"
UPDATE nits SET nit="91238477" WHERE ALLTRIM(nit)=="91238477|"         
           
UPDATE arrendatarios SET nit="91507119" WHERE ALLTRIM(nit)=="91507119CRA"
UPDATE propietarios SET cedula="91507119" WHERE ALLTRIM(cedula)=="91507119CRA"
UPDATE fiadores SET nit="91507119" WHERE ALLTRIM(nit)=="91507119CRA"

UPDATE arrendatarios SET nit="37799270" WHERE ALLTRIM(nit)=="37799270A"
UPDATE propietarios SET cedula="37799270" WHERE ALLTRIM(cedula)=="37799270A"
UPDATE fiadores SET nit="37799270" WHERE ALLTRIM(nit)=="37799270A"

UPDATE arrendatarios SET nit="19582116" WHERE ALLTRIM(nit)=="19582116|"
UPDATE propietarios SET cedula="19582116" WHERE ALLTRIM(cedula)=="19582116|"
UPDATE fiadores SET nit="19582116" WHERE ALLTRIM(nit)=="19582116|"

UPDATE arrendatarios SET nit="91238477" WHERE ALLTRIM(nit)=="91238477|"
UPDATE propietarios SET cedula="91238477" WHERE ALLTRIM(cedula)=="91238477|"
UPDATE fiadores SET nit="91238477" WHERE ALLTRIM(nit)=="91238477|"


***SE LLENAN LAS TABLAS PARAMETRICAS 
SELECT tipo_regimen
INSERT INTO tipo_regimen VALUES("RC", "REGIMEN COMUN")
INSERT INTO tipo_regimen VALUES("RS", "REGIMEN SIMPLIFICADO")
INSERT INTO tipo_regimen VALUES("SR", "SIN REGIMEN")
INSERT INTO tipo_regimen VALUES("SA", "SIN ANIMO DE LUCRO")

SELECT tipo_cliente
INSERT INTO tipo_cliente VALUES("SL", "SIN ANIMO DE LUCRO")
INSERT INTO tipo_cliente VALUES("PN", "PERSONA NATURAL")
INSERT INTO tipo_cliente VALUES("PJ", "PERSONA JURIDICA")
INSERT INTO tipo_cliente VALUES("GC", "GRAN CONTRIBUYENTE")

*!*	INSERT INTO tipo_cliente VALUES("1", "ARRENDATARIO")
*!*	INSERT INTO tipo_cliente VALUES("2", "PROPIETARIO")
*!*	INSERT INTO tipo_cliente VALUES("3", "TERCERO")
*!*	INSERT INTO tipo_cliente VALUES("4", "ARRENDATARIO Y PROPIETARIO")
*!*	INSERT INTO tipo_cliente VALUES("5", "ARRENDATARIO Y TERCERO")
*!*	INSERT INTO tipo_cliente VALUES("6", "PROPIETARIO Y TERCERO")
*!*	INSERT INTO tipo_cliente VALUES("7", "ARRENDATARIO PROPIETARIO Y TERCERO")
*!*	INSERT INTO tipo_cliente VALUES("8", "EMPLEADO")
*!*	INSERT INTO tipo_cliente VALUES("9", "FIADOR")
*!*	INSERT INTO tipo_cliente VALUES("10", "PROMOTOR")
*!*	INSERT INTO tipo_cliente VALUES("11", "ABOGADO")
*!*	INSERT INTO tipo_cliente VALUES("12", "BENEFICIARIO")

*11.Registro civil,11,12. Tarjeta de Identidad,12,13. Cdula de Ciudadania,13,21. Tarjeta de Extranjera,21,;
22. Cdula de Extranjera,22,31. Nit,31,41. Pasaporte,41

SELECT tipo_documento
INSERT INTO tipo_documento VALUES("11", "REGISTRO CIVIL")
INSERT INTO tipo_documento VALUES("12", "TARJETA DE IDENTIDAD")
INSERT INTO tipo_documento VALUES("13", "CEDULA DE CIUDADANIA")
INSERT INTO tipo_documento VALUES("21", "TARJETA DE EXTRANJERIA")
INSERT INTO tipo_documento VALUES("22", "CEDULA DE EXTRANJERIA")
INSERT INTO tipo_documento VALUES("31", "NIT")
INSERT INTO tipo_documento VALUES("41", "PASAPORTE")
INSERT INTO tipo_documento VALUES("PEP", "PERMISO ESPECIAL DE PERMANENCIA")


SET SAFETY OFF
 SELECT CIUDAD
 ZAP
 gctabla = " "
 wfilew = " "
 gctabla = GETFILE('xls', 'Leer Archivo:', 'Abrir', 0, 'ESCOJA EL ARCHIVO DE CIUDADES')
 DO CASE
    CASE 'Sin t***tulo'$gctabla
       CREATE (gctabla)
    CASE EMPTY(gctabla)
       RETURN
    OTHERWISE
       wfilew = gctabla
 ENDCASE
 wfileapp = "'"+ALLTRIM(wfilew)+"'"
 SELECT ciudad
 APPEND FROM &wfileapp XLS 

SELECT xbarrios 
GO TOP 
SCAN 	
	INSERT INTO barrio VALUES (ALLTRIM(STR(xbarrios.idbarrio)), ALLTRIM(xbarrios.barrio),"","",ALLTRIM(STR(xbarrios.ruta)))
ENDSCAN 

SELECT BANCOS 
GO TOP 
SCAN 
	INSERT INTO BANCO VALUES(ALLTRIM(BANCOS.CODIGO), ALLTRIM(BANCOS.BANCO), 0, RIGHT(ALLTRIM(BANCOS.COD_BANCARIO),3),"")
ENDSCAN 

SELECT XTCONSIGNACION
GO TOP 
SCAN 
	INSERT INTO tipo_consignacion VALUES (ALLTRIM(STR(XTCONSIGNACION.IDTCONSIGNACION)), ALLTRIM(XTCONSIGNACION.TCONSIGNACION))
ENDSCAN 

SELECT XCIUDADES_CONT
GO TOP 
SCAN 
	INSERT INTO SUCURSAL VALUES (ALLTRIM(STR(XCIUDADES_CONT.IDCIUDAD)), ALLTRIM(XCIUDADES_CONT.CIUDAD))
ENDSCAN 

SELECT xtiposinm
GO TOP 
SCAN 
	INSERT INTO TIPO_INMUEBLE VALUES (ALLTRIM(STR(xtiposinm.idtipo_inm)), ALLTRIM(xtiposinm.tipo_inm))
ENDSCAN 

SELECT XDESTINO
GO TOP 
SCAN 
	INSERT INTO DESTINO_INMUEBLE VALUES (ALLTRIM(STR(XDESTINO.IDDESTINO)), ALLTRIM(XDESTINO.DESTINO))
ENDSCAN 

INSERT INTO ESTADO_INMUEBLE VALUES("1","CONSIGNADO")
INSERT INTO ESTADO_INMUEBLE VALUES("2","OCUPADO")
INSERT INTO ESTADO_INMUEBLE VALUES("3","DESOCUPADO")
INSERT INTO ESTADO_INMUEBLE VALUES("4","PENDIENTE")
INSERT INTO ESTADO_INMUEBLE VALUES("5","RETIRADO")
INSERT INTO ESTADO_INMUEBLE VALUES("6","INMUEBLE EN CONTRATO - ARRENDATARIO")

INSERT INTO TIPO_COCINA VALUES("1","COCINA TRADICIONAL")
INSERT INTO TIPO_COCINA VALUES("2","COCINA SEMI-INTEGRAL")
INSERT INTO TIPO_COCINA VALUES("3","COCINA INTEGRAL")

INSERT INTO TIPO_PISO VALUES("1","PISO EN BALDOSIN")
INSERT INTO TIPO_PISO VALUES("2","PISO EN CERAMICA")
INSERT INTO TIPO_PISO VALUES("3","PISO EN MARMOL")
INSERT INTO TIPO_PISO VALUES("4","PISO EN GRANITO")
INSERT INTO TIPO_PISO VALUES("5","PISO ENTAPETADO")
INSERT INTO TIPO_PISO VALUES("6","PISO EN CEMENTO")
INSERT INTO TIPO_PISO VALUES("7","PISO EN PLASTICO")
INSERT INTO TIPO_PISO VALUES("8","PISO EN PORCELANATO")
INSERT INTO TIPO_PISO VALUES("9","PISO EN TABLETA")
INSERT INTO TIPO_PISO VALUES("10","PISO EN MADERA")

INSERT INTO TIPO_PARQUEADERO VALUES ("1", "GARAJE DOBLE")
INSERT INTO TIPO_PARQUEADERO VALUES ("2", "GARAJE SENCILLO")
INSERT INTO TIPO_PARQUEADERO VALUES ("3", "GARAJE CUBIERTO")
INSERT INTO TIPO_PARQUEADERO VALUES ("4", "GARAJE DESCUBIERTO")
INSERT INTO TIPO_PARQUEADERO VALUES ("5", "PARQUEADERO COMUNAL")

INSERT INTO TIPO_CUENTA VALUES ("1","CUENTA CORRIENTE")
INSERT INTO TIPO_CUENTA VALUES ("2","CUENTA AHORROS")
INSERT INTO TIPO_CUENTA VALUES ("3","FIDUCIA")
INSERT INTO TIPO_CUENTA VALUES ("4","EMBARGO")
INSERT INTO TIPO_CUENTA VALUES ("5","DEPOSITO JUDICIAL")
INSERT INTO TIPO_CUENTA VALUES ("6","CREDITO HIPOTECARIO")

INSERT INTO TIPO_ENTREGA VALUES ("1","RECOGE EN OFICINA")
INSERT INTO TIPO_ENTREGA VALUES ("2","CONSIGNAR EN CUENTA")
INSERT INTO TIPO_ENTREGA VALUES ("3","ENVIAR A DIRECCION")
INSERT INTO TIPO_ENTREGA VALUES ("4","GIRO POSTAL")

INSERT INTO TIPO_PAGO VALUES ("1","CHEQUE","","","","")
INSERT INTO TIPO_PAGO VALUES ("2","TRANSFERENCIA","","","","S")
INSERT INTO TIPO_PAGO VALUES ("3","EFECTIVO","","","","")
INSERT INTO TIPO_PAGO VALUES ("4","NO GENERAR","","","","")

SELECT XASEGURADORAS
GO TOP 
SCAN 
	INSERT INTO ASEGURADORA VALUES (ALLTRIM(STR(XASEGURADORAS.IDASEGURADORA)),ALLTRIM(XASEGURADORAS.NOMBRE),;
	ALLTRIM(XASEGURADORAS.NIT),"","",0)
ENDSCAN 

INSERT INTO TIPO_REAJUSTE VALUES ("1","IPC")
INSERT INTO TIPO_REAJUSTE VALUES ("2","IPC MAS PUNTOS")
INSERT INTO TIPO_REAJUSTE VALUES ("3","PORCENTAJE")

INSERT INTO ESTADO_FISICO VALUES ("1","EXCELENTE")
INSERT INTO ESTADO_FISICO VALUES ("2","BUENO")
INSERT INTO ESTADO_FISICO VALUES ("3","REGULAR")
INSERT INTO ESTADO_FISICO VALUES ("3","MALO")

*0.Transferencias,7,1. Porterias,1,6. Consignar - Recogen Adm,6,8. Ruta8,8
INSERT INTO RUTA_PAGO VALUES ("1", "TRANSFERENCIAS")
INSERT INTO RUTA_PAGO VALUES ("2", "PORTERIAS")
INSERT INTO RUTA_PAGO VALUES ("3", "CONSIGNAR - RECOGEN ADM")
INSERT INTO RUTA_PAGO VALUES ("4", "RUTA8")

****listado de nombres 
SET SAFETY OFF
 SELECT NOMBRES 
 ZAP
 gctabla = " "
 wfilew = " "
 gctabla = GETFILE('xls', 'Leer Archivo:', 'Abrir', 0, 'ESCOJA EL ARCHIVO DE NOMBRES')
 DO CASE
    CASE 'Sin t***tulo'$gctabla
       CREATE (gctabla)
    CASE EMPTY(gctabla)
       RETURN
    OTHERWISE
       wfilew = gctabla
 ENDCASE
 wfileapp = "'"+ALLTRIM(wfilew)+"'"
 SELECT NOMBRES 
 APPEND FROM &wfileapp XLS 
ENDPROC
PROCEDURE Load
CLOSE DATABASES ALL 

*!*	USE "F:/ORBIS/INMO/DATA/PROPIETARIOS.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/INMO/DATA/ARRENDATARIOS.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/INMO/DATA/FIADORES.DBF" IN 0 SHARED
*!*	USE "F:/ORBIS/INMO/DATA/INMUEBLES.DBF" IN 0 SHARED  
*!*	USE "F:/ORBIS/INMO/DATA/XTCONSIGNACION.DBF" IN 0 SHARED
*!*	USE "F:/ORBIS/INMO/DATA/XTIPOSINM.DBF" IN 0 SHARED  
*!*	USE "F:/ORBIS/INMO/DATA/XDESTINO.DBF" IN 0 SHARED  
*!*	USE "F:/ORBIS/DATA/CIUDADES.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/DATA/BANCOS.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/INMO/DATA/XBARRIOS.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/CONTA/DATA/2017/NITS.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/CONTA/DATA/2017/MOV.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/CONTA/DATA/2017/RC.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/CONTA/DATA/2017/CE.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/CONTA/DATA/2017/NC.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/CONTA/DATA/2017/CCOSTO.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/CONTA/DATA/2017/MAYOR.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/CONTA/DATA/2017/XCIUDADES_CONT.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/INMO/DATA/INM_DESC.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/INMO/DATA/DETAINM.DBF" IN 0 SHARED 
*!*	USE "F:/ORBIS/INMO/DATA/INMPRO.DBF" IN 0 SHARED
*!*	USE "F:/ORBIS/INMO/DATA/XASEGURADORAS.DBF" IN 0 SHARED

USE "D:/ORBIS/INMO/DATA/PROPIETARIOS.DBF" IN 0 SHARED 
USE "D:/ORBIS/INMO/DATA/ARRENDATARIOS.DBF" IN 0 SHARED 
USE "D:/ORBIS/INMO/DATA/FIADORES.DBF" IN 0 SHARED
USE "D:/ORBIS/INMO/DATA/INMUEBLES.DBF" IN 0 SHARED 
USE "D:/ORBIS/INMO/DATA/DESOCUPADOS.DBF" IN 0 SHARED  
USE "D:/ORBIS/INMO/DATA/XADMONES.DBF" IN 0 SHARED  
USE "D:/ORBIS/INMO/DATA/XTCONSIGNACION.DBF" IN 0 SHARED
USE "D:/ORBIS/INMO/DATA/XTIPOSINM.DBF" IN 0 SHARED  
USE "D:/ORBIS/INMO/DATA/XDESTINO.DBF" IN 0 SHARED  
USE "D:/ORBIS/INMO/DATA/XPROMOTOR.DBF" IN 0 SHARED 
USE "D:/ORBIS/INMO/DATA/XABOGADOS.DBF" IN 0 SHARED  
USE "D:/ORBIS/DATA/CIUDADES.DBF" IN 0 SHARED 
USE "D:/ORBIS/DATA/BANCOS.DBF" IN 0 SHARED 
USE "D:/ORBIS/INMO/DATA/XBARRIOS.DBF" IN 0 SHARED 
USE "D:/ORBIS/INMO/DATA/FIAD_ARR.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2018/NITS.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2017/MOV.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2017/RC.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2017/CE.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2017/NC.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2017/CCOSTO.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2017/MAYOR.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2017/MAYORNIT.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2017/MAYORINM.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2018/XCIUDADES_CONT.DBF" IN 0 SHARED 
USE "D:/ORBIS/CONTA/DATA/2018/XCIUDADES_RETICA.DBF" IN 0 SHARED 
USE "D:/ORBIS/INMO/DATA/INM_DESC.DBF" IN 0 SHARED 
USE "D:/ORBIS/INMO/DATA/DETAINM.DBF" IN 0 SHARED 
USE "D:/ORBIS/INMO/DATA/INMPRO.DBF" IN 0 SHARED
USE "D:/ORBIS/INMO/DATA/XASEGURADORAS.DBF" IN 0 SHARED

**
USE "D:/ORBIS/CONTA/DATA/2018/MOV.DBF" IN 0 SHARED ALIAS mov_2018
USE "D:/ORBIS/CONTA/DATA/2018/RC.DBF" IN 0 SHARED ALIAS RC_2018
USE "D:/ORBIS/CONTA/DATA/2018/CE.DBF" IN 0 SHARED ALIAS CE_2018
USE "D:/ORBIS/CONTA/DATA/2018/NC.DBF" IN 0 SHARED ALIAS NC_2018


* -OK
CREATE CURSOR CLIENTES(;
COD_CLIENTE c(20),;
COD_CIUDAD_DOCUMENTO c(5),;
PRIMER_NOMBRE c(200),;	
SEGUNDO_NOMBRE c(50),;	
PRIMER_APELLIDO	c(30),;
SEGUNDO_APELLIDO c(30),;
COD_TIPO_REGIMEN c(3),;	
COD_TIPO_CLIENTE c(3),;	
COD_TIPO_DOCUMENTO c(3),;	
SEQ_PROFESION c(3),;	
FECHA_NACIMIENTO d,;	
SEXO c(1),;	
DIR_CLIENTE c(250),;	
DIR_TRABAJO c(250),;	
TEL_CLIENTE c(250),;	
COD_CIUDAD_CLIENTE c(5),;
EMAIL c(60),;	
RETIENE_SOBRE_ICA c(1),;
RESPONSABLE_IVA c(1),;
AGENTE_RETENEDOR C(1),;
RETIENE_SOBRE_IVA c(1),;	
IMPUESTO_INDUSTRIA c(1),;	
OBS_CLIENTE c(250),;	
PROFESION c(50),;	
COD_CREE c(4),;	
DECLARA_RENTA c(1),;	
DV_CLIENTE c(1),;	
PORC_RETEICA y,;	
DIRECCION_DIAN c(250),;	
AUTORETENEDOR c(1),;	
NO_IVA_ARRIENDO c(1),;	
COD_CIUDAD_DIAN c(5),;	
DIR_ENVIO_CORRESPONDENCIA c(250),;	
HOBBIES c(250),;	
COD_ESTADO_CIVIL c(3),;	
COD_TITULO c(3),;	
TIPO_ENVIO_CORRESPONDENCIA c(3),;	
BLOQUEAR_PAGO c(1),;	
COD_BARRIO_CLIENTE c(5),;	
COD_BARRIO_DIAN c(5),;	
COD_BARRIO_CORRESPONDENCIA c(5),;	
COD_HUELLA C(1),;
VIVO C(1),;
COD_BARRIO_DIR_TRABAJO c(5),;
COD_CIUDAD_DIR_TRABAJO c(5);				
)
INDEX ON ALLTRIM(COD_CLIENTE) TAG COD_CLI

* -OK
CREATE CURSOR cliente_direccion(;
cod_cliente	c(20),;
Tipo_direccion	c(20),;
Via_principal c(20),;
eje_vial_1 c(10),;	
Eje_vial_2 c(10),;	
Eje_vial_3	c(10),;
Complemento_1 c(20),;
Complemento_2 c(20),;
Complemento_3 c(20),;
Complemento_4 c(20),;
Complemento_5 c(20),;
Complemento_6 c(20),;	
Complemento_7 c(20),;
Complemento_8 c(20),;
Atipico  c(200),;
FJSON1 c(250),;
FJSON2 c(250),;
FJSON3 c(250),;
FJSON4 c(250);
)

* -OK
CREATE CURSOR INMUEBLE(;
COD_INMUEBLE C(6),;
TEL_INMUEBLE C(100),;
COD_INMOBILIARIA C(3),;
COD_TIPO_CONSIG C(3),;
COD_SUCURSAL C(3),;
COD_BARRIO C(5),;
COD_TIPO_INMUEBLE C(3),;
COD_SUB_TIPO_INM C(3),;
COD_POT	C(3),;
COD_DESTINO	C(3),;
COD_ESTRATO	C(3),;
COD_ESTADO C(3),;
COD_ESTADO_FIS C(3),;
INMUEBLE_NUEVO C(1),;
FECHA_CONSIGN D,;
VLR_AVALUO Y,;
VLR_CANON Y,;
PRECIO_VENTA Y,;
PORC_COMISION Y,;
PORC_COMISION_ANT Y,;
VLR_FIANZA Y,;
CANT_CUOTA_FIANZA I,;
NRO_MATRICULA C(30),;
VLR_ADMINISTRACION I,;
VLR_PUBLICIDAD I,;
VLR_HIPOTECA I,;
NRO_ESCRITURA C(30),;
FECHA_ESCRITURA D,;
NOTARIA_ESCRITURA C(30),;
COD_UBICACION C(3),;
LIQUIDA_COMISION_G C(1),;
LIQUIDA_COMISION_E C(1),;
VLR_COMISION_ESP Y,;
EDAD_INMUEBLE I,;
DESTACADO_WEB C(1),;
MUESTRA_FOTO_WEB C(1),;
COD_TIPO_COCINA C(3),;
COD_TIPO_PARQ C(3),;
COD_TIPO_PISO C(3),;
OBS_INMUEBLE C(200),;
DIR_INMUEBLE C(150),;
SEQ_UNIDAD I,;
COD_TIPO_CONT_MAND C(3),;
PUBLICIDAD1 C(250),;
PUBLICIDAD2 C(250),;
FECHA_RECONSIG D,;
PUBLICIDAD3 C(250),;
OBS_DISTRIBUCION C(250),;
OBS_SERVICIO_PUB C(250),;
OBS_SERVICIO_COM C(250),;
FECHA_RETIRO D,;
COD_CLIENTE_PROMOTOR C(20),;
AREA_LOTE Y,;
AREA_CONSTRUIDA Y,;
NRO_PARQUEADERO C(10),;
COD_CLIENTE_PAD C(20),;
DIR_VIDEO C(250),;
VLR_CUOTA_ASEO 	Y,;
ADMON_POR_DEFINIR C(1),;
COD_SEGURO C(3),;
NO_COBRAR_INTERES C(1),;
CODIGO_ARCHIVO C(20),;
CODIGO_FINCA_RAIZ C(10),;
CODIGO_METRO_CUAD C(10),;
BLOQUEAR_PAGO C(1),;
PORC_COMISION_ADMON y,;
PORC_SEGURO_ADMON y,;
LATITUD c(20),;
LONGITUD c(20),;
COD_RUTA_PAGO C(3);
)

* -OK
CREATE CURSOR inmueble_direccion(;
cod_inmueble c(20),;
Via_principal c(20),;
eje_vial_1 c(10),;	
Eje_vial_2 c(10),;	
Eje_vial_3	c(10),;
Complemento_1 c(20),;
Complemento_2 c(20),;
Complemento_3 c(20),;
Complemento_4 c(20),;
Complemento_5 c(20),;
Complemento_6 c(20),;	
Complemento_7 c(20),;
Complemento_8 c(20),;
Atipico  c(200),;
FJSON1 c(250),;
FJSON2 c(250),;
FJSON3 c(250),;
FJSON4 c(250);
)

* -OK
CREATE CURSOR INMUEBLE_PROPIETARIO(;
SEQ_PROPIETARIO I,;
COD_INMUEBLE C(6),;
COD_CLIENTE_PROPIETARIO C(20),;
COD_CLIENTE_BENEFICIARIO C(20),;
COD_CLIENTE_REPRESENTANTE C(20),;
PORC_PAGO y,;
NRO_CUENTA C(30),;
COD_CIUDAD C(3),;
COD_BANCO C(3),;
COD_TIPO_PAGO C(3),;
COD_TIPO_ENTREGA C(3),;
COD_TIPO_CUENTA	C(3);
)

* -OK
CREATE CURSOR INMUEBLE_TIPO_PUBLICIDAD (;
SEQ_INMUEBLE_TIPO_PUBLICIDAD I,;
COD_INMUEBLE C(6),; 
COD_TIPO_PUBLICACION C(3),; 
DETALLE_PUBLICIDAD C(250);
)

* -OK
CREATE CURSOR CONTRATO(;
SEQ_CONTRATO i,;
COD_INMUEBLE C(6),;
COD_CLIENTE_ARRENDATARIO1 C(20),;
COD_CLIENTE_ARRENDATARIO2 C(20),;
COD_CLIENTE_REPRESENTANTE1 C(20),;
COD_CLIENTE_REPRESENTANTE2 C(20),;
COD_ASEGURADORA C(3),;
COD_ABOGADO C(3),;
NRO_SOLICITUD I,;
COD_SUCURSAL C(3),;
COD_DESTINO C(3),;
COD_TIPO_DESOCUPACION C(3),;
COD_ESTADO_CONTRATO C(3),;
COD_TIPO_CONTRATO C(3),;
COD_TIPO_CONTRATO_MANDATO C(3),;
COD_TIPO_REAJUSTE C(3),;
COD_TIPO_PINTURA C(3),;
COD_INTERNO_ASEGURADORA C(10),;
FECHA_CONTRATO D,;
FECHA_LIQUIDACION D,;
FECHA_POSIBLE_DESOCUPACION D,;
DIR_ENVIO_CORRESPONDENCIA C(200),;
COD_CIUDAD_CORRESPONDENCIA C(3),;
DIAS_GRACIA Y,;
VLR_CANON Y,;
VLR_FIANZA Y,;
VLR_DOCUMENTOS Y,;
VLR_CANON_CESION Y,;
DIAS_INDEMNIZACION Y,;
VLR_INDEMNIZACION Y,;
PORC_REAJUSTE Y,;
PORC_REAJUSTE_ADICIONAL Y,;
MESES_DURACION_CONTRATO Y,;
CLAUSULA C(250),;
OBS_CONTRATO C(250),;
DETALLE_DESTINO C(250),;
CESION C(1),;
FECHA_CORTE	 D,;
RETENER_FACTURA C(1),;
DISPONIBLE_ARRIENDO C(1),;
RETIENE_PAGO_MORA_SRV C(1),;
AUTORIZA_SERVICIOS C(1),;
COD_BARRIO C(5),;
FECHA_INGRESO D,;
VLR_CESION Y,;
NO_REPORTAR_CIFIN C(1),;
NOMBRE_ENTREGA C(100),;
LLAVES_ENTREGA Y,;
LINEAS_ACTUALES C(100),;
LINEAS_RETIRADAS C(100),;
NEGOCIAR_INDEMNIZACION C(1),;
FECHA_DESOCUPACION D,;
SALDO_FIANZA Y,;
COD_CLIENTE_PROMOTOR C(20),;
PORC_RETEIVA Y,;
COD_MOTIVO_DESOCUPACION C(3),;
RETENER_SISTEMAS C(1),;
REAJUSTE_MINIMO Y,;
REPORTE_SERVICIOS C(1),;
PORC_ASEGURADORA Y,;
CODIGO_ARCHIVO C(20),;
VR_FIANZA_SERVICIOS Y,;
COD_ASEGURADORA_FIANZA C(3),;
NO_RENOVAR C(1),;
BLOQUEO_PAGO C(1),;
OBS_BLOQUEO_PAGO C(200),;
NO_COBRAR_CARTAS C(1),;
VR_DEUDA_SERVICIOS Y,;
VR_DEUDA_REPARACIONES Y,;
CODIGO_FINCA_RAIZ C(10),;
CODIGO_METRO_CUADRADO C(10),;
NO_COBRAR_INTERES C(1),;
PORC_RETEICA Y)
INDEX on PADL(ALLTRIM(COD_INMUEBLE),6,"0")+PADL(ALLTRIM(COD_CLIENTE_ARRENDATARIO1),20,"0") TAG key1

*- OK
CREATE CURSOR contrato_direccion(;
seq_contrato i,;
Via_principal c(20),;
eje_vial_1 c(10),;	
Eje_vial_2 c(10),;	
Eje_vial_3	c(10),;
Complemento_1 c(20),;
Complemento_2 c(20),;
Complemento_3 c(20),;
Complemento_4 c(20),;
Complemento_5 c(20),;
Complemento_6 c(20),;	
Complemento_7 c(20),;
Complemento_8 c(20),;
Atipico  c(200),;
FJSON1 c(250),;
FJSON2 c(250),;
FJSON3 c(250),;
FJSON4 c(250);
)

CREATE CURSOR CONTRATO_COBRO_CONCEPTO(;
SEQ_CONTRATO_COBRO I,;
SEQ_CONTRATO i,;
COD_CONCEPTO C(3),;
COD_RESPONSABLE C(3),;
COD_CLIENTE C(20),;
VLR_COBRO Y,;
REAJUSTE_AUTOMATICO	 C(1),;
VLR_COBRO2 Y)

* -OK
CREATE CURSOR CONTRATO_FIADOR(;
SEQ_CONTRATO_FIADOR I,;
SEQ_CONTRATO i,;
COD_CLIENTE C(20))



*========================================================
CREATE CURSOR INMUEBLE_PUBLICIDAD(;
COD_INMUEBLE C(6),;
DETALLE_PUBLICIDAD C(250),;
PRECIO Y,;
FECHA_PUBLICACION D,;
COD_TIPO_PUBLICACION C(5),;
SEQ_PUBLICIDAD I;
)

CREATE CURSOR INMUEBLE_COBRO_CONCEPTO(;
SEQ_INMUEBLE_COBRO I,;
COD_INMUEBLE C(6),;
COD_CONCEPTO C(3),;
COD_RESPONSABLE	C(3),;
COD_CLIENTE C(20),;
VLR_COBRO Y,;
VLR_COBRO2 Y)

* -OK
CREATE CURSOR INMUEBLE_PREDIAL(;
COD_INMUEBLE C(6),;
COD_TIPO_PREDIAL C(3),;
PAGA_PREDIAL C(1),;
NRO_PREDIAL	 C(30),;
ANO_PREDIAL	 I,;
VLR_AVALUO_PREDIAL I,;
SEQ_INMUEBLE_PREDIAL I)

* -OK
CREATE CURSOR INMUEBLE_MATRICULA(;
SEQ_INMUEBLE_MATRICULA I,;
COD_INMUEBLE C(6),;
COD_TIPO_PREDIAL C(3),;
NRO_MATRICULA C(30),;
NRO_ESCRITURA C(30),;
FECHA_ESCRITURA	D,;
NOTARIA	C(50))

CREATE CURSOR INMUEBLE_DISTRIBUCION(;
COD_INMUEBLE C(6),;
COD_TIPO_DISTRIBUCION C(3),;
ORDEN I,;
VLR_DISTRIBUCION C(7),;
OBS_DISTRIBUCION C(250),;
SEQ_INMUEBLE_DISTRIBUCION I)


CREATE CURSOR INMUEBLE_DOCUMENTO(;
COD_INMUEBLE C(6),;
COD_CLASE_DOCUMENTO C(3),;
RECIBIDO C(1),;
FECHA_RECIBIDO D,;
SEQ_INMUEBLE_DOC I)
*================================================


**************************************
* -OK
CREATE CURSOR COMPROBANTE(;
SEQ_COMPROBANTE I,;
COD_TIPO_COMPROBANTE C(3),;	
NRO_COMPROBANTE I,;	
FECHA_COMPROBANTE D,;
CONTABILIZADO C(1),;	
ACTUALIZA_SALDO C(1),;	
NOTA_ACLARATORIA C(250);
)
INDEX ON SEQ_COMPROBANTE TAG IDDOC 

* -OK
CREATE CURSOR COMPROBANTE_DETALLE(;
SEQ_COMPROBANTE_DETALLE I,;
SEQ_COMPROBANTE I,;
SEQ_COMPROBANTE_ANULA I,;
DETALLE_REGISTRO C(250),;
COD_CLIENTE C(20),;
COD_CUENTA C(16),;
COD_CONCEPTO C(3),;
VLR_DEBE Y,;
VLR_HABER Y,;
COD_TIPO_SOPORTE C(3),;
NRO_DOC_SOPORTE C(20),;
FECHA_DOC_SOPORTE D,;
COD_TIPO_INGRESO C(3),;
NRO_DOC_PAGO C(20),;
FECHA_DOC_PAGO D,;
COD_BANCO C(3),;
MES I,;
ANO I,;
COMPROBANTE_CIERRE C(1),;
APLICA_IVA C(1),;
APLICA_RFTE C(1),;
SEQ_CONTRATO I,;
COD_INMUEBLE C(6),;
COD_SUCURSAL C(3),;
NRO_CHEQUE I,;
NRO_FACTURA_VARIOS C(20),;
CDEBE Y,;
CHABER Y,;
COD_CENTRO_COSTO C(3),;
VLR_BASE Y,;
COD_CUENTA_NIIF C(20);
)
INDEX ON SEQ_COMPROBANTE TAG IDDOC 

**tablas parametricas -OK
CREATE CURSOR tipo_regimen(;
COD_TIPO_REGIMEN c(3),;
NOM_TIPO_REGIMEN c(60);	
)

* -OK
CREATE CURSOR tipo_cliente(;
COD_TIPO_CLIENTE c(3),;
NOM_TIPO_CLIENTE c(60);	
)

* -OK
CREATE CURSOR tipo_documento(;
COD_TIPO_DOCUMENTO c(3),;
NOM_TIPO_DOCUMENTO c(60);	
)

* -OK
CREATE CURSOR CIUDAD(;
COD_CIUDAD C(5),;
NOM_CIUDAD C(60),;
COD_DEPARTAMENTO C(3),;
COD_DIAN C(3),;
COD_POSTAL C(20);
)
INDEX ON ALLTRIM(NOM_CIUDAD) TAG CIUDAD

* -OK
CREATE CURSOR BARRIO(;
COD_BARRIO C(5),;
NOM_BARRIO C(60),;
COD_CIUDAD C(6),;
COD_ZONA C(3),;
COD_RUTA_PAGO C(3);
)
INDEX ON ALLTRIM(COD_BARRIO) TAG CODIGO

* -OK
CREATE CURSOR BANCO(;
COD_BANCO C(3),;
NOM_BANCO C(60),;
VLR_TRANSACCION Y,;
CODIGO_PLATAFORMA C(3),;
DIGITO_CHEQUEO C(1);
)

* -OK
CREATE CURSOR tipo_consignacion(;
COD_TIPO_CONSIGNACION c(3),;
NOM_TIPO_CONSIGNACION c(60);	
)

* -OK
CREATE CURSOR SUCURSAL(;
COD_SUCURSAL c(3),;
NOM_SUCURSAL c(60);	
)

* -OK
CREATE CURSOR TIPO_INMUEBLE(;
COD_TIPO_INMUEBLE c(3),;
NOM_TIPO_INMUEBLE c(60);	
)

* -OK
CREATE CURSOR DESTINO_INMUEBLE(;
COD_DESTINO c(3),;
NOM_DESTINO c(60);	
)

* -OK
CREATE CURSOR ESTADO_INMUEBLE(;
COD_ESTADO C(3),;
NOM_ESTADO C(60);
)

* -OK
CREATE CURSOR TIPO_COCINA(;
COD_TIPO_COCINA C(3),;
NOM_TIPO_COCINA C(60);
)

* -OK
CREATE CURSOR TIPO_PISO(;
COD_TIPO_PISO C(3),;
NOM_TIPO_PISO C(60);
)

* -OK
CREATE CURSOR TIPO_PARQUEADERO(;
COD_TIPO_PARQUEADERO C(3),;
NOM_TIPO_PARQUEADERO C(60);
)

* -OK
CREATE CURSOR TIPO_CUENTA(;
COD_TIPO_CUENTA C(3),;
NOM_TIPO_CUENTA C(60);
)

* -OK
CREATE CURSOR TIPO_ENTREGA(;
COD_TIPO_ENTREGA C(3),;
NOM_TIPO_ENTREGA C(60);
)

* -OK
CREATE CURSOR TIPO_PAGO(;
COD_TIPO_PAGO C(3),;
NOM_TIPO_PAGO C(60),;
COD_CUENTA C(12),;
COD_TIPO_COMPROBANTE C(3),;
PAGO_AGRUPADO C(1),;
REQUIERE_DATOS_CUENTA C(1);
)

* -OK
CREATE CURSOR ASEGURADORA(;
COD_ASEGURADORA C(3),;
NOM_ASEGURADORA C(60),;
COD_CLIENTE C(20),;
COD_CTA_FIANZA_SERVICIO C(12),;
COD_CTA_FIANZA_ARRIENDO C(12),;
PORC_ASEGURADORA Y;
)
INDEX ON ALLTRIM(COD_CLIENTE) TAG NIT 

* -OK
CREATE CURSOR TIPO_REAJUSTE(;
COD_TIPO_REAJUSTE C(3),;
NOM_TIPO_REAJUSTE C(60);
)

* -OK
CREATE CURSOR ESTADO_FISICO(;
COD_ESTADO_FISICO C(3),;
NOM_ESTADO_FISICO C(60);
)

* -OK
CREATE CURSOR UNIDADES(;
SEQ_UNIDAD I,;
NOM_UNIDAD C(60),;
ACTIVO	C(1),;
COD_CLIENTE	C(20),;
TIENE_REGLAMENTO C(1),;
COD_CLIENTE_FUNCIONARIO	C(20),;
COD_TIPO_PAGO	C(3),;
DIA_PAGO	C(15),;
COD_BANCO	C(3),;
NRO_CUENTA	C(30),;
COD_TIPO_CUENTA C(3),;
OBSERVACION C(250),;
DIA_RUTA I,;
COD_RUTA_PAGO C(3),;
DIR_CORRESPONDENCIA	C(250),;
COD_CIUDAD_CORRESPONDENCIA C(5),;
COD_CLIENTE_BENEFICIARIO C(20),;
TELEFONO_PORTERIA C(60),;
LONGITUD I,;
LATITUD	I,;
COD_CLIENTE_ADMINISTRADOR C(20),;
COD_CLIENTE_REPRESENTANTE C(20),;
DIA_PAGO2 C(15))
INDEX ON SEQ_UNIDAD TAG SEQ_UNIDAD 

* -OK
CREATE CURSOR unidades_direccion(;
SEQ_UNIDAD i,;
Via_principal c(20),;
eje_vial_1 c(10),;	
Eje_vial_2 c(10),;	
Eje_vial_3	c(10),;
Complemento_1 c(20),;
Complemento_2 c(20),;
Complemento_3 c(20),;
Complemento_4 c(20),;
Complemento_5 c(20),;
Complemento_6 c(20),;	
Complemento_7 c(20),;
Complemento_8 c(20),;
Atipico  c(200),;
FJSON1 c(250),;
FJSON2 c(250),;
FJSON3 c(250),;
FJSON4 c(250);
)

*************************
* -OK
CREATE CURSOR RUTA_PAGO(;
COD_RUTA_PAGO C(3),;
NOM_RUTA_PAGO C(60))


CREATE CURSOR CSALDOS_CUENTAS(;
CODIGO C(20),;
COD_CLIENTE C(20),;
COD_INMUEBLE C(6),;
SEQ_CONTRATO I,;
SALDO Y)

*************************
CREATE CURSOR CNITS_ERROR(;
IDINMUEBLE I,;
DOCUMENTO C(20),;
NOMBRE C(100),;
TIPO C(3))

*************************
CREATE CURSOR NOMBRES (HOMBRES C(80), MUJERES C(80))
INDEX ON ALLTRIM(HOMBRES) TAG NMAS
INDEX ON ALLTRIM(MUJERES) TAG NFEM


ENDPROC
PROCEDURE migrarcontratos

SELECT INMUEBLES 
GO TOP 
n = 0
NF = 0
SCAN FOR INMUEBLES.ESTADO = 2
	n = n+1
	
	lnSEQ_CONTRATO = n
	lcCOD_INMUEBLE = ALLTRIM(STR(INMUEBLES.IDINMUEBLE))
	lcCOD_CLIENTE_ARRENDATARIO1 = ""
	lcCOD_CLIENTE_ARRENDATARIO2 = ""  &&??EN ORBIS NO SE MANEJA
	lcCOD_CLIENTE_REPRESENTANTE1 = ""  &&??EN ORBIS NO SE MANEJA
	lcCOD_CLIENTE_REPRESENTANTE2 = ""  &&??EN ORBIS NO SE MANEJA
	lcCOD_ASEGURADORA = "" 
	lcCOD_ABOGADO = ""
	lnNRO_SOLICITUD = 0
	lcCOD_SUCURSAL = ALLTRIM(STR(INMUEBLES.IDCIUDAD_CONT))
	lcCOD_DESTINO  = ALLTRIM(STR(INMUEBLES.DESTINO))
	lcCOD_TIPO_DESOCUPACION  = "" &&??EN ORBIS NO SE MANEJA
	lcCOD_ESTADO_CONTRATO  = "VIG"
	lcCOD_TIPO_CONTRATO  = "NUE" &&??EN ORBIS NO SE MANEJA
	lcCOD_TIPO_CONTRATO_MANDATO  = "EST" &&??EN ORBIS NO SE MANEJA
	lcCOD_TIPO_REAJUSTE  = ALLTRIM(STR(INMUEBLES.TIPOREAJUSTE))
	lcCOD_TIPO_PINTURA  = "" &&??EN ORBIS NO SE MANEJA
	lcCOD_INTERNO_ASEGURADORA  = ALLTRIM(INMUEBLES.NSOLICITUD)
	ldFECHA_CONTRATO = INMUEBLES.FCONTRATO_AR
	ldFECHA_LIQUIDACION = INMUEBLES.FLEGALIZACION
	ldFECHA_POSIBLE_DESOCUPACION = INMUEBLES.FRESTITUCION 
	lcDIR_ENVIO_CORRESPONDENCIA  = ""
	lcCOD_CIUDAD_CORRESPONDENCIA  = ALLTRIM(STR(INMUEBLES.IDBARRIO_COR))
	lnDIAS_GRACIA = 0 &&??EN ORBIS NO SE MANEJA
	lnVLR_CANON = INMUEBLES.CANON_VIG 
	lnVLR_FIANZA = INMUEBLES.VCANON_ASEG
	lnVLR_DOCUMENTOS = 0 &&??EN ORBIS NO SE MANEJA
	lnVLR_CANON_CESION = IIF(INMUEBLES.CESION,CANON_VIG,0) 
	lnDIAS_INDEMNIZACION = 0 &&??EN ORBIS NO SE MANEJA
	lnVLR_INDEMNIZACION = 0 &&??EN ORBIS NO SE MANEJA
	lnPORC_REAJUSTE = INMUEBLES.PORC_REAJUSTE  
	lnPORC_REAJUSTE_ADICIONAL = INMUEBLES.PUNTOSREA
	lnMESES_DURACION_CONTRATO = INMUEBLES.NMESES
	lcCLAUSULA  = "" &&??EN ORBIS NO SE MANEJA
	lcOBS_CONTRATO  = "" 
	lcDETALLE_DESTINO  = "" &&??A Q HACE REFERENCIA 
	lcCESION  = IIF(INMUEBLES.CESION,"S","N")
	ldFECHA_CORTE = INMUEBLES.CORTE_FECHA
	lcRETENER_FACTURA  = IIF(INMUEBLES.ESTADO_CAR>1 OR INMUEBLES.REQ_CARTERA = 2,"S","N")
	lcDISPONIBLE_ARRIENDO  = "" &&??A Q HACE REFERENCIA 
	lcRETIENE_PAGO_MORA_SRV  = "N" &&??EN ORBIS NO SE MANEJA
	lcAUTORIZA_SERVICIOS  = "N" &&??A Q HACE REFERENCIA 
	lcCOD_BARRIO  = ALLTRIM(STR(INMUEBLES.IDBARRIO))
	ldFECHA_INGRESO = INMUEBLES.FLEGALIZACION
	lnVLR_CESION = 0 &&??EN ORBIS NO SE MANEJA
	lcNO_REPORTAR_CIFIN  = "N" &&??EN ORBIS NO SE MANEJA
	lcNOMBRE_ENTREGA  = "" &&--------------->>>>>>>>>>PARA DESOCUPADOS
	lnLLAVES_ENTREGA = 0 &&--------------->>>>>>>>>>PARA DESOCUPADOS
	lctelefono = ''
	thisform.Telefonosjson(ALLTRIM(INMUEBLES.TELEFONO), "","")
	lcLINEAS_ACTUALES = lctelefono
	lcLINEAS_RETIRADAS = "" &&??EN ORBIS NO SE MANEJA
	lcNEGOCIAR_INDEMNIZACION  = "N"&&??EN ORBIS NO SE MANEJA
	ldFECHA_DESOCUPACION = {123}} &&--------------->>>>>>>>>>PARA DESOCUPADOS INMUEBLES.FDESOCUPACION
	lnSALDO_FIANZA = 0 &&??EN ORBIS NO SE MANEJA
	lcCOD_CLIENTE_PROMOTOR  = ""
	lcCOD_MOTIVO_DESOCUPACION  = "" &&--------------->>>>>>>>>>PARA DESOCUPADOS ARMAR TABLA DE MOTIVOS
	lcRETENER_SISTEMAS  = "" &&??A Q HACE REFERENCIA
	lnREAJUSTE_MINIMO = IIF(INMUEBLES.PORC_REAJUSTE<5,INMUEBLES.PORC_REAJUSTE,0)
	ldREPORTE_SERVICIOS = "N" &&??A Q HACE REFERENCIA
	lnPORC_ASEGURADORA = INMUEBLES.SEG_CANON
	lcCODIGO_ARCHIVO  = "" &&??EN ORBIS NO SE MANEJA
	lnVR_FIANZA_SERVICIOS = INMUEBLES.SEG_VSERVASEG
	lcCOD_ASEGURADORA_FIANZA  = ""
	lcNO_RENOVAR  = "N" &&??EN ORBIS NO SE MANEJA	
	lcBLOQUEO_PAGO  = IIF(INMUEBLES.FORMA_PAGO=4,"S","N")
	lcOBS_BLOQUEO_PAGO  = "" &&??EN ORBIS NO SE MANEJA	
	lcNO_COBRAR_CARTAS  = "N" &&??EN ORBIS NO SE MANEJA	
	lnVR_DEUDA_SERVICIOS = 0 &&??A Q HACE REFERENCIA	
	lnVR_DEUDA_REPARACIONES = 0 &&??A Q HACE REFERENCIA	
	lcCODIGO_FINCA_RAIZ  = ALLTRIM(STR(INMUEBLES.IDINMUEBLE))
	lcCODIGO_METRO_CUADRADO  = ALLTRIM(STR(INMUEBLES.IDINMUEBLE))
	lcNO_COBRAR_INTERES  = 'N' &&??EN ORBIS NO SE MANEJA	
	lnPORC_RETEICA = 0
	
	lcCadena_Direccion = ALLTRIM(INMUEBLES.DIR_COR) 
		 		
	lcCadena_atipico = ""
	lcViaPPal=""
	lcEjevial1=""
	lcEjevial2=""
	lcEjevial3=""
	lcCompl1=""
	lcCompl2=""
	lcCompl3=""
	lcCompl4=""
	lcCompl5="" 
	lcCompl6="" 
	lcCompl7="" 
	lcCompl8="" 
	lnViaPPal = 0
	lnCompl1 = 0
	lnCompl3 = 0
	lnCompl5 = 0
	lcCadena_fjson = ""
	
	IF LEN(ALLTRIM(lcCadena_Direccion))>0 
		lnPosAtI = ATC("(",lcCadena_Direccion)
		lnPosAtF = ATC(")",lcCadena_Direccion)
		IF lnPosAtI>0 AND lnPosAtF>0
			lcCadena_atipico = SUBSTR(lcCadena_Direccion,lnPosAtI+1,lnPosAtF-(lnPosAtI+1))
			lcDir_inmueble = SUBSTR(lcCadena_Direccion,1,lnPosAtI-1)
		ENDIF 
		
		thisform.via_ppal(lcCadena_Direccion) 	
		
		IF LEN(ALLTRIM(lcViaPPal))=0 AND LEN(ALLTRIM(lcEjevial1))=0 AND LEN(ALLTRIM(lcEjevial2))=0 AND LEN(ALLTRIM(lcEjevial3))=0
			lcCadena_atipico = lcCadena_Direccion
		ENDIF 
		
		lcCadena_fjson = '{123}"dir":"'+ALLTRIM(lcCadena_Direccion)+'","json":"{123}\"via_principal\":\"'+ALLTRIM(lcViaPPal)+'\",\"eje_vial_1\":\"'+ALLTRIM(lcEjevial1)+;
		'\",\"eje_vial_2\":\"'+ALLTRIM(lcEjevial2)+'\",\"eje_vial_3\":\"'+ALLTRIM(lcEjevial3)+'\",\"complemento_1\":\"'+ALLTRIM(lcCompl1)+'\",\"complemento_2\":\"'+;
		ALLTRIM(lcCompl2)+'\",\"complemento_3\":\"'+ALLTRIM(lcCompl3)+'\",\"complemento_4\":\"'+ALLTRIM(lcCompl4)+'\",\"complemento_5\":\"'+ALLTRIM(lcCompl5)+;
		'\",\"complemento_6\":\"'+ALLTRIM(lcCompl6)+'\",\"complemento_7\":\"'+ALLTRIM(lcCompl7)+'\",\"complemento_8\":\"'+ALLTRIM(lcCompl8)+'\",\"atipico\":\"'+;
		ALLTRIM(lcCadena_atipico)+'\"}"}'
		
		lnnrocharjson = LEN(ALLTRIM(lcCadena_fjson))

		lcCadena1_json = SUBSTR(lcCadena_fjson,1,249)+"&"
		lcCadena2_json = SUBSTR(lcCadena_fjson,250,249)+"&"
		lcCadena3_json = SUBSTR(lcCadena_fjson,500,249)+"&"
		lcCadena4_json = SUBSTR(lcCadena_fjson,750,249)+"&"
		
		SELECT Contrato_direccion
 			APPEND BLANK 
 			REPLACE;
 			SEQ_CONTRATO WITH lnSEQ_CONTRATO,;
 			VIA_PRINCIPAL WITH ALLTRIM(lcViaPPal),;
 			EJE_VIAL_1 WITH lcEjevial1,;
 			EJE_VIAL_2 WITH lcEjevial2,;
 			EJE_VIAL_3 WITH lcEjevial3,; 
 			COMPLEMENTO_1 WITH ALLTRIM(lcCompl1),;
 			COMPLEMENTO_2 WITH lcCompl2,;
 			COMPLEMENTO_3 WITH ALLTRIM(lcCompl3),;
 			COMPLEMENTO_4 WITH lcCompl4,;
 			COMPLEMENTO_6 WITH lcCompl6,;
			ATIPICO WITH lcCadena_atipico,;
			FJSON1 With lcCadena1_json,;
			FJSON2 With lcCadena2_json,;
			FJSON3 With lcCadena3_json,;
			FJSON4 With lcCadena4_json;
 			IN Contrato_direccion
	ENDIF
	
	lcDIR_ENVIO_CORRESPONDENCIA = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
	IF LEN(ALLTRIM(lcDIR_ENVIO_CORRESPONDENCIA))=0
		lcDIR_ENVIO_CORRESPONDENCIA = lcCadena_atipico
	ENDIF  
	
	SET EXACT ON 
	
	IF SEEK(ALLTRIM(INMUEBLES.NIT),'CLIENTES',"COD_CLI")
		lcCOD_CLIENTE_ARRENDATARIO1 = ALLTRIM(INMUEBLES.NIT)
	ELSE 
		IF SEEK(ALLTRIM(INMUEBLES.NIT),'ARRENDATARIOS',"NIT")
			INSERT INTO CNITS_ERROR VALUES(INMUEBLES.IDINMUEBLE,ALLTRIM(INMUEBLES.NIT),; 
			ALLTRIM(ARRENDATARIOS.NOMBRE)+" "+ALLTRIM(ARRENDATARIOS.APELLIDO),"ARR")	
		ENDIF 	
	ENDIF 
	
	IF SEEK(INMUEBLES.IDINMUEBLE,"INM_DESC","IDINMUEBLE")
		lcObservaciones1 = STRTRAN(ALLTRIM(INM_DESC.OBS_OCUPACION),chr(13)+chr(10),"/")
		lcobservaciones2 = STRTRAN(lcobservaciones1,",","/")
		lcobservaciones3 = STRTRAN(lcobservaciones2,"'","/")
		lcobservaciones4 = STRTRAN(lcobservaciones3,"|","/")			
					
		lcOBS_CONTRATO  = ALLTRIM(lcobservaciones4)
	ENDIF 
		    
    IF SEEK(INMUEBLES.ACTIVIDAD,"XABOGADOS","IDABOGADO")
    	IF SEEK(ALLTRIM(XABOGADOS.CEDULA),"NITS","NIT")
    		IF SEEK(ALLTRIM(NITS.NIT),'CLIENTES',"COD_CLI")
	    		lcCOD_ABOGADO = ALLTRIM(NITS.NIT)
	    	ELSE 
	    		INSERT INTO CNITS_ERROR VALUES(INMUEBLES.IDINMUEBLE,ALLTRIM(NITS.NIT), ALLTRIM(NITS.NOMBRE)+" "+ALLTRIM(NITS.APELLIDO),"ABO")		
	    	ENDIF 	
    	ENDIF 
    ENDIF 
    
    IF SEEK(INMUEBLES.ACTIVIDAD,"XPROMOTOR","IDPROMOTOR")
    	IF SEEK(ALLTRIM(XPROMOTOR.CEDULA),"NITS","NIT")
			IF SEEK(ALLTRIM(NITS.NIT),'CLIENTES',"COD_CLI")
			   	lcCOD_CLIENTE_PROMOTOR  = ALLTRIM(NITS.NIT)
			ELSE
				INSERT INTO CNITS_ERROR VALUES(INMUEBLES.IDINMUEBLE,ALLTRIM(NITS.NIT), ALLTRIM(NITS.NOMBRE)+" "+ALLTRIM(NITS.APELLIDO),"PRM")		
			ENDIF 	
	    ENDIF 	
    ENDIF 
    
    IF SEEK(ALLTRIM(INMUEBLES.NIT),"ARRENDATARIOS","NIT")
    	lnIdArrendatario = ARRENDATARIOS.IDARRENDATARIO
    ENDIF 
    
    IF SEEK(ALLTRIM(INMUEBLES.NITFIANZADORA),"ASEGURADORA","NIT")
    	lcCOD_ASEGURADORA_FIANZA = ALLTRIM(ASEGURADORA.COD_ASEGURADORA)
    	lcCOD_ASEGURADORA = ALLTRIM(ASEGURADORA.COD_ASEGURADORA)
    ENDIF 
         
	SET EXACT OFF 
	
	SELECT * FROM INMPRO WHERE IDINMUEBLE = INMUEBLES.IDINMUEBLE INTO CURSOR CPROPS
	
	lnPORC_RETEIVA = 0 
	SELECT CPROPS
	GO TOP 
	SCAN 
		SET EXACT ON 
		IF SEEK(CPROPS.IDPROPIETARIO,'PROPIETARIOS',"IDPROPIETA")
			IF PROPIETARIOS.FORMA_PAGO = 4 AND PROPIETARIOS.TIPO_PAGO<=2 
				lcBLOQUEO_PAGO = "S" 
				
				lcObservaciones1 = STRTRAN(ALLTRIM(PROPIETARIOS.OBSERVACIONESNOGEN),chr(13)+chr(10),"/")
				lcobservaciones2 = STRTRAN(lcobservaciones1,",","/")
				lcobservaciones3 = STRTRAN(lcobservaciones2,"'","/")
				lcobservaciones4 = STRTRAN(lcobservaciones3,"|","/")	
		
				lcOBS_BLOQUEO_PAGO = ALLTRIM(lcobservaciones4)
			ENDIF 
			
			IF PROPIETARIOS.TIPO_PAGO <> 2
				ldFECHA_CORTE = PROPIETARIOS.CORTE_FECHA
			ENDIF 
			IF  PROPIETARIOS.regcomun AND  (inmuebles.iva_arriendo .OR. inmuebles.destino>1)
				IF SEEK(ALLTRIM(INMUEBLES.NIT),"ARRENDATARIOS","NIT")
					IF arrendatarios.ret_iva
						lnPORC_RETEIVA = arrendatarios.porc_retiva
					ENDIF 	
				ENDIF 	
			ENDIF 
		ENDIF 
		SET EXACT OFF
	ENDSCAN
	
	lnPORC_RETEICA = 0
	SET EXACT ON
		IF SEEK(ALLTRIM(INMUEBLES.NIT),"ARRENDATARIOS","NIT")
			IF arrendatarios.ret_ica
				IF SEEK(inmuebles.idciudad, 'XCIUDADES_RETICA', 'IDORBIS')
			       lnPORC_RETEICA = xciudades_retica.porc_retica
		    	ENDIF
		    ENDIF 	
	    ENDIF 	
	SET EXACT OFF 
		
	INSERT INTO CONTRATO VALUES(;
	lnSEQ_CONTRATO,;
	lcCOD_INMUEBLE ,;
	lcCOD_CLIENTE_ARRENDATARIO1,;
	lcCOD_CLIENTE_ARRENDATARIO2,;
	lcCOD_CLIENTE_REPRESENTANTE1,;
	lcCOD_CLIENTE_REPRESENTANTE2,;
	lcCOD_ASEGURADORA,;
	lcCOD_ABOGADO,;
	lnNRO_SOLICITUD ,;
	lcCOD_SUCURSAL ,;
	lcCOD_DESTINO ,;
	lcCOD_TIPO_DESOCUPACION ,; &&??EN ORBIS NO SE MANEJA
	lcCOD_ESTADO_CONTRATO,;
	lcCOD_TIPO_CONTRATO ,; &&??EN ORBIS NO SE MANEJA
	lcCOD_TIPO_CONTRATO_MANDATO ,; &&??EN ORBIS NO SE MANEJA
	lcCOD_TIPO_REAJUSTE ,;
	lcCOD_TIPO_PINTURA ,; &&??EN ORBIS NO SE MANEJA
	lcCOD_INTERNO_ASEGURADORA ,; &&??A Q HACE REFERENCIA 
	ldFECHA_CONTRATO ,;
	ldFECHA_LIQUIDACION ,; &&??A Q HACE REFERENCIA 
	ldFECHA_POSIBLE_DESOCUPACION,;
	lcDIR_ENVIO_CORRESPONDENCIA ,;
	lcCOD_CIUDAD_CORRESPONDENCIA,;
	lnDIAS_GRACIA,; &&??EN ORBIS NO SE MANEJA
	lnVLR_CANON,;
	lnVLR_FIANZA,;
	lnVLR_DOCUMENTOS,; &&??EN ORBIS NO SE MANEJA
	lnVLR_CANON_CESION,; &&??EN ORBIS NO SE MANEJA
	lnDIAS_INDEMNIZACION,; &&??EN ORBIS NO SE MANEJA
	lnVLR_INDEMNIZACION,; &&??EN ORBIS NO SE MANEJA
	lnPORC_REAJUSTE,;
	lnPORC_REAJUSTE_ADICIONAL,;
	lnMESES_DURACION_CONTRATO,;
	lcCLAUSULA ,; &&??EN ORBIS NO SE MANEJA
	lcOBS_CONTRATO ,; 
	lcDETALLE_DESTINO ,; &&??A Q HACE REFERENCIA 
	lcCESION ,;
	ldFECHA_CORTE ,; &&??A Q HACE REFERENCIA 
	lcRETENER_FACTURA ,;
	lcDISPONIBLE_ARRIENDO ,; &&??A Q HACE REFERENCIA 
	lcRETIENE_PAGO_MORA_SRV ,; &&??EN ORBIS NO SE MANEJA
	lcAUTORIZA_SERVICIOS ,; &&??A Q HACE REFERENCIA 
	lcCOD_BARRIO ,;
	ldFECHA_INGRESO ,; &&??A Q HACE REFERENCIA 
	lnVLR_CESION,; &&??EN ORBIS NO SE MANEJA
	lcNO_REPORTAR_CIFIN ,; &&??EN ORBIS NO SE MANEJA
	lcNOMBRE_ENTREGA ,; &&??EN ORBIS NO SE MANEJA
	lnLLAVES_ENTREGA,; &&??EN ORBIS NO SE MANEJA
	lcLINEAS_ACTUALES ,; &&??EN ORBIS NO SE MANEJA
	lcLINEAS_RETIRADAS ,; &&??EN ORBIS NO SE MANEJA
	lcNEGOCIAR_INDEMNIZACION ,;&&??EN ORBIS NO SE MANEJA
	ldFECHA_DESOCUPACION,;
	lnSALDO_FIANZA,; &&??EN ORBIS NO SE MANEJA
	lcCOD_CLIENTE_PROMOTOR ,;
	lnPORC_RETEIVA,; &&??A Q HACE REFERENCIA
	lcCOD_MOTIVO_DESOCUPACION ,; &&??EN ORBIS NO SE MANEJA
	lcRETENER_SISTEMAS ,; &&??A Q HACE REFERENCIA
	lnREAJUSTE_MINIMO,; &&??A Q HACE REFERENCIA
	ldREPORTE_SERVICIOS ,; &&??A Q HACE REFERENCIA
	lnPORC_ASEGURADORA,;
	lcCODIGO_ARCHIVO ,; &&??EN ORBIS NO SE MANEJA
	lnVR_FIANZA_SERVICIOS,;
	lcCOD_ASEGURADORA_FIANZA,;
	lcNO_RENOVAR ,; &&??EN ORBIS NO SE MANEJA	
	lcBLOQUEO_PAGO ,; &&??A Q HACE REFERENCIA	
	lcOBS_BLOQUEO_PAGO ,; &&??EN ORBIS NO SE MANEJA	
	lcNO_COBRAR_CARTAS ,; &&??EN ORBIS NO SE MANEJA	
	lnVR_DEUDA_SERVICIOS,; &&??A Q HACE REFERENCIA	
	lnVR_DEUDA_REPARACIONES,; &&??A Q HACE REFERENCIA	
	lcCODIGO_FINCA_RAIZ,;
	lcCODIGO_METRO_CUADRADO,;
	lcNO_COBRAR_INTERES,; &&??EN ORBIS NO SE MANEJA	
	lnPORC_RETEICA;
	)
	
	SELECT * FROM FIAD_ARR WHERE IDINMUEBLE = INMUEBLES.IDINMUEBLE AND INMUEBLES.IDARRENDATARIO = lnIdArrendatario INTO CURSOR CFIADORES_CONT 
	
	SELECT CFIADORES_CONT
	GO TOP 
	SCAN 
		IF SEEK(ALLTRIM(CFIADORES_CONT.NITFIADOR),'CLIENTES',"COD_CLI")
			NF = NF + 1
			INSERT INTO CONTRATO_FIADOR VALUES (NF, N, ALLTRIM(CFIADORES_CONT.NITFIADOR))
		ELSE 
			IF SEEK(ALLTRIM(CFIADORES_CONT.NITFIADOR),'FIADORES',"NIT")
				INSERT INTO CNITS_ERROR VALUES(INMUEBLES.IDINMUEBLE,ALLTRIM(CFIADORES_CONT.NITFIADOR),;
				 ALLTRIM(FIADORES.NOMBRE)+" "+ALLTRIM(FIADORES.APELLIDO),"FIA")	
			ENDIF 		
		ENDIF 	
	ENDSCAN 
	
ENDSCAN 

this.ncontrato = n
this.nfiadores = nf
ENDPROC
PROCEDURE migrardesocupados

SELECT DESOCUPADOS  
GO TOP 
n = this.ncontrato 
NF = this.nfiadores 
SCAN
	n = n+1
	
	lnSEQ_CONTRATO = n
	lcCOD_INMUEBLE = ALLTRIM(STR(DESOCUPADOS.IDINMUEBLE))
	lcCOD_CLIENTE_ARRENDATARIO1 = ""
	lcCOD_CLIENTE_ARRENDATARIO2 = ""  &&??EN ORBIS NO SE MANEJA
	lcCOD_CLIENTE_REPRESENTANTE1 = ""  &&??EN ORBIS NO SE MANEJA
	lcCOD_CLIENTE_REPRESENTANTE2 = ""  &&??EN ORBIS NO SE MANEJA
	lcCOD_ASEGURADORA = "" 
	lcCOD_ABOGADO = ""
	lnNRO_SOLICITUD = 0
	lcCOD_INTERNO_ASEGURADORA  = ALLTRIM(DESOCUPADOS.NSOL_SEGURO)
	ldFECHA_CONTRATO = DESOCUPADOS.FINICIO
	ldFECHA_LIQUIDACION = DESOCUPADOS.FINICIO
	ldFECHA_POSIBLE_DESOCUPACION = DESOCUPADOS.FDESOCUPACION 
	ldFECHA_INGRESO = DESOCUPADOS.FINICIO
	lcCOD_TIPO_DESOCUPACION  = "" &&??EN ORBIS NO SE MANEJA
	lcCOD_ESTADO_CONTRATO  = "INA"
	lcCOD_TIPO_CONTRATO  = "NUE" &&??EN ORBIS NO SE MANEJA
	lcCOD_TIPO_CONTRATO_MANDATO  = "EST" &&??EN ORBIS NO SE MANEJA
	lcCOD_TIPO_PINTURA  = "" &&??EN ORBIS NO SE MANEJA
	lcDIR_ENVIO_CORRESPONDENCIA  = ""
	lnDIAS_GRACIA = 0 &&??EN ORBIS NO SE MANEJA
	lnVLR_CANON = DESOCUPADOS.CANON
	lnVLR_FIANZA = DESOCUPADOS.VCANON_ASEG
	lnVLR_DOCUMENTOS = 0 &&??EN ORBIS NO SE MANEJA
	lnVLR_CANON_CESION = 0
	lnDIAS_INDEMNIZACION = 0 &&??EN ORBIS NO SE MANEJA
	lnVLR_INDEMNIZACION = 0 &&??EN ORBIS NO SE MANEJA
	lnPORC_REAJUSTE = 0 &&NO HAY INFORMACION EN LA TABLA DE DESOCUPADOS
	lnPORC_REAJUSTE_ADICIONAL = 0
	lnMESES_DURACION_CONTRATO = 0
	lcCLAUSULA  = "" &&??EN ORBIS NO SE MANEJA
	lcOBS_CONTRATO  = "" 
	lcDETALLE_DESTINO  = "" &&??A Q HACE REFERENCIA 
	lcCESION  = "N"
	ldFECHA_CORTE = {123}}
	lcRETENER_FACTURA  = "N"
	lcDISPONIBLE_ARRIENDO  = "" &&??A Q HACE REFERENCIA 
	lcRETIENE_PAGO_MORA_SRV  = "N" &&??EN ORBIS NO SE MANEJA
	lcAUTORIZA_SERVICIOS  = "N" &&??A Q HACE REFERENCIA 
	lnVLR_CESION = 0 &&??EN ORBIS NO SE MANEJA
	lcNO_REPORTAR_CIFIN  = "N" &&??EN ORBIS NO SE MANEJA
	lcNOMBRE_ENTREGA  = "" &&--------------->>>>>>>>>>PARA DESOCUPADOS
	lnLLAVES_ENTREGA = 0 &&--------------->>>>>>>>>>PARA DESOCUPADOS
	lcLINEAS_RETIRADAS = "" &&??EN ORBIS NO SE MANEJA
	lcNEGOCIAR_INDEMNIZACION  = "N"&&??EN ORBIS NO SE MANEJA
	ldFECHA_DESOCUPACION = {123}} &&--------------->>>>>>>>>>PARA DESOCUPADOS INMUEBLES.FDESOCUPACION
	lnSALDO_FIANZA = 0 &&??EN ORBIS NO SE MANEJA
	lcCOD_CLIENTE_PROMOTOR  = ""
	lcCOD_MOTIVO_DESOCUPACION  = "" &&--------------->>>>>>>>>>PARA DESOCUPADOS ARMAR TABLA DE MOTIVOS
	lcRETENER_SISTEMAS  = "" &&??A Q HACE REFERENCIA
	lnREAJUSTE_MINIMO = 0
	ldREPORTE_SERVICIOS = "N" &&??A Q HACE REFERENCIA
	lnPORC_ASEGURADORA = 0
	lcCODIGO_ARCHIVO  = "" &&??EN ORBIS NO SE MANEJA
	lnVR_FIANZA_SERVICIOS = DESOCUPADOS.VMONTO_SERV
	lcCOD_ASEGURADORA_FIANZA  = ""
	lcNO_RENOVAR  = "N" &&??EN ORBIS NO SE MANEJA	
	lcBLOQUEO_PAGO  = "S"
	lcOBS_BLOQUEO_PAGO  = "" &&??EN ORBIS NO SE MANEJA	
	lcNO_COBRAR_CARTAS  = "N" &&??EN ORBIS NO SE MANEJA	
	lnVR_DEUDA_SERVICIOS = 0 &&??A Q HACE REFERENCIA	
	lnVR_DEUDA_REPARACIONES = 0 &&??A Q HACE REFERENCIA	
	lcCODIGO_FINCA_RAIZ  =  ""
	lcCODIGO_METRO_CUADRADO  = ""
	lcNO_COBRAR_INTERES  = 'N' &&??EN ORBIS NO SE MANEJA	
	lnPORC_RETEICA = 0
	lcOBS_CONTRATO = ""
	lcCOD_ABOGADO = ""
    lcCOD_CLIENTE_PROMOTOR  = ""

	SET EXACT ON 
	
	IF SEEK(ALLTRIM(DESOCUPADOS.NIT_ARR),'CLIENTES',"COD_CLI")
		lcCOD_CLIENTE_ARRENDATARIO1 = ALLTRIM(INMUEBLES.NIT)
	ELSE 
		IF SEEK(ALLTRIM(DESOCUPADOS.NIT_ARR),'ARRENDATARIOS',"NIT")
			INSERT INTO CNITS_ERROR VALUES(DESOCUPADOS.IDINMUEBLE,ALLTRIM(DESOCUPADOS.NIT_ARR),; 
			ALLTRIM(ARRENDATARIOS.NOMBRE)+" "+ALLTRIM(ARRENDATARIOS.APELLIDO),"ARR")	
		ENDIF 	
	ENDIF 
   
    IF SEEK(ALLTRIM(DESOCUPADOS.NIT_ARR),"ARRENDATARIOS","NIT")
    	lnIdArrendatario = ARRENDATARIOS.IDARRENDATARIO
    ENDIF 
    
    IF SEEK(ALLTRIM(DESOCUPADOS.NITFIANZADORA),"ASEGURADORA","NIT")
    	lcCOD_ASEGURADORA_FIANZA = ALLTRIM(ASEGURADORA.COD_ASEGURADORA)
    	lcCOD_ASEGURADORA = ALLTRIM(ASEGURADORA.COD_ASEGURADORA)
    ENDIF 
         
	SET EXACT OFF 
	
	lnPORC_RETEIVA = 0 
	
	
	lnPORC_RETEICA = 0
	SET EXACT ON
	IF SEEK(ALLTRIM(DESOCUPADOS.NIT_ARR),"ARRENDATARIOS","NIT")
		IF arrendatarios.ret_ica
			IF SEEK(desocupados.idciudad, 'XCIUDADES_RETICA', 'IDORBIS')
		       lnPORC_RETEICA = xciudades_retica.porc_retica
	    	ENDIF
	    ENDIF 	
    ENDIF 	
	
	IF SEEK(DESOCUPADOS.IDINMUEBLE,"INMUEBLES","IDINMUEBLE")
		lctelefono = ''
		thisform.Telefonosjson(ALLTRIM(INMUEBLES.TELEFONO), "","")
		lcCOD_TIPO_REAJUSTE  = ALLTRIM(STR(INMUEBLES.TIPOREAJUSTE))
		lcCOD_SUCURSAL = ALLTRIM(STR(INMUEBLES.IDCIUDAD_CONT))
		lcCOD_DESTINO  = ALLTRIM(STR(INMUEBLES.DESTINO))
		lcCOD_CIUDAD_CORRESPONDENCIA  = ALLTRIM(STR(INMUEBLES.IDBARRIO_COR))
		lcCOD_BARRIO  = ALLTRIM(STR(INMUEBLES.IDBARRIO))
		lcLINEAS_ACTUALES = lctelefono
		
		lcCadena_Direccion = ALLTRIM(INMUEBLES.DIR_COR) 
			 		
		lcCadena_atipico = ""
		lcViaPPal=""
		lcEjevial1=""
		lcEjevial2=""
		lcEjevial3=""
		lcCompl1=""
		lcCompl2=""
		lcCompl3=""
		lcCompl4=""
		lcCompl5="" 
		lcCompl6="" 
		lcCompl7="" 
		lcCompl8="" 
		lnViaPPal = 0
		lnCompl1 = 0
		lnCompl3 = 0
		lnCompl5 = 0
		lcCadena_fjson = ""
		
		IF LEN(ALLTRIM(lcCadena_Direccion))>0 
			lnPosAtI = ATC("(",lcCadena_Direccion)
			lnPosAtF = ATC(")",lcCadena_Direccion)
			IF lnPosAtI>0 AND lnPosAtF>0
				lcCadena_atipico = SUBSTR(lcCadena_Direccion,lnPosAtI+1,lnPosAtF-(lnPosAtI+1))
				lcDir_inmueble = SUBSTR(lcCadena_Direccion,1,lnPosAtI-1)
			ENDIF 
			
			thisform.via_ppal(lcCadena_Direccion) 	
			
			IF LEN(ALLTRIM(lcViaPPal))=0 AND LEN(ALLTRIM(lcEjevial1))=0 AND LEN(ALLTRIM(lcEjevial2))=0 AND LEN(ALLTRIM(lcEjevial3))=0
				lcCadena_atipico = lcCadena_Direccion
			ENDIF 
			
			lcCadena_fjson = '{123}"dir":"'+ALLTRIM(lcCadena_Direccion)+'","json":"{123}\"via_principal\":\"'+ALLTRIM(lcViaPPal)+'\",\"eje_vial_1\":\"'+ALLTRIM(lcEjevial1)+;
			'\",\"eje_vial_2\":\"'+ALLTRIM(lcEjevial2)+'\",\"eje_vial_3\":\"'+ALLTRIM(lcEjevial3)+'\",\"complemento_1\":\"'+ALLTRIM(lcCompl1)+'\",\"complemento_2\":\"'+;
			ALLTRIM(lcCompl2)+'\",\"complemento_3\":\"'+ALLTRIM(lcCompl3)+'\",\"complemento_4\":\"'+ALLTRIM(lcCompl4)+'\",\"complemento_5\":\"'+ALLTRIM(lcCompl5)+;
			'\",\"complemento_6\":\"'+ALLTRIM(lcCompl6)+'\",\"complemento_7\":\"'+ALLTRIM(lcCompl7)+'\",\"complemento_8\":\"'+ALLTRIM(lcCompl8)+'\",\"atipico\":\"'+;
			ALLTRIM(lcCadena_atipico)+'\"}"}'
			
			lnnrocharjson = LEN(ALLTRIM(lcCadena_fjson))

			lcCadena1_json = SUBSTR(lcCadena_fjson,1,249)+"&"
			lcCadena2_json = SUBSTR(lcCadena_fjson,250,249)+"&"
			lcCadena3_json = SUBSTR(lcCadena_fjson,500,249)+"&"
			lcCadena4_json = SUBSTR(lcCadena_fjson,750,249)+"&"
			
			SELECT Contrato_direccion
	 			APPEND BLANK 
	 			REPLACE;
	 			SEQ_CONTRATO WITH lnSEQ_CONTRATO,;
	 			VIA_PRINCIPAL WITH ALLTRIM(lcViaPPal),;
	 			EJE_VIAL_1 WITH lcEjevial1,;
	 			EJE_VIAL_2 WITH lcEjevial2,;
	 			EJE_VIAL_3 WITH lcEjevial3,; 
	 			COMPLEMENTO_1 WITH ALLTRIM(lcCompl1),;
	 			COMPLEMENTO_2 WITH lcCompl2,;
	 			COMPLEMENTO_3 WITH ALLTRIM(lcCompl3),;
	 			COMPLEMENTO_4 WITH lcCompl4,;
	 			COMPLEMENTO_6 WITH lcCompl6,;
				ATIPICO WITH lcCadena_atipico,;
				FJSON1 With lcCadena1_json,;
				FJSON2 With lcCadena2_json,;
				FJSON3 With lcCadena3_json,;
				FJSON4 With lcCadena4_json;
	 			IN Contrato_direccion
		ENDIF
		
		lcDIR_ENVIO_CORRESPONDENCIA = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
		IF LEN(ALLTRIM(lcDIR_ENVIO_CORRESPONDENCIA))=0
			lcDIR_ENVIO_CORRESPONDENCIA = lcCadena_atipico
		ENDIF    
	ENDIF 
	
	SET EXACT OFF 
		
	INSERT INTO CONTRATO VALUES(;
	lnSEQ_CONTRATO,;
	lcCOD_INMUEBLE ,;
	lcCOD_CLIENTE_ARRENDATARIO1,;
	lcCOD_CLIENTE_ARRENDATARIO2,;
	lcCOD_CLIENTE_REPRESENTANTE1,;
	lcCOD_CLIENTE_REPRESENTANTE2,;
	lcCOD_ASEGURADORA,;
	lcCOD_ABOGADO,;
	lnNRO_SOLICITUD ,;
	lcCOD_SUCURSAL ,;
	lcCOD_DESTINO ,;
	lcCOD_TIPO_DESOCUPACION ,; &&??EN ORBIS NO SE MANEJA
	lcCOD_ESTADO_CONTRATO,;
	lcCOD_TIPO_CONTRATO ,; &&??EN ORBIS NO SE MANEJA
	lcCOD_TIPO_CONTRATO_MANDATO ,; &&??EN ORBIS NO SE MANEJA
	lcCOD_TIPO_REAJUSTE ,;
	lcCOD_TIPO_PINTURA ,; &&??EN ORBIS NO SE MANEJA
	lcCOD_INTERNO_ASEGURADORA ,; &&??A Q HACE REFERENCIA 
	ldFECHA_CONTRATO ,;
	ldFECHA_LIQUIDACION ,; &&??A Q HACE REFERENCIA 
	ldFECHA_POSIBLE_DESOCUPACION,;
	lcDIR_ENVIO_CORRESPONDENCIA ,;
	lcCOD_CIUDAD_CORRESPONDENCIA,;
	lnDIAS_GRACIA,; &&??EN ORBIS NO SE MANEJA
	lnVLR_CANON,;
	lnVLR_FIANZA,;
	lnVLR_DOCUMENTOS,; &&??EN ORBIS NO SE MANEJA
	lnVLR_CANON_CESION,; &&??EN ORBIS NO SE MANEJA
	lnDIAS_INDEMNIZACION,; &&??EN ORBIS NO SE MANEJA
	lnVLR_INDEMNIZACION,; &&??EN ORBIS NO SE MANEJA
	lnPORC_REAJUSTE,;
	lnPORC_REAJUSTE_ADICIONAL,;
	lnMESES_DURACION_CONTRATO,;
	lcCLAUSULA ,; &&??EN ORBIS NO SE MANEJA
	lcOBS_CONTRATO ,; 
	lcDETALLE_DESTINO ,; &&??A Q HACE REFERENCIA 
	lcCESION ,;
	ldFECHA_CORTE ,; &&??A Q HACE REFERENCIA 
	lcRETENER_FACTURA ,;
	lcDISPONIBLE_ARRIENDO ,; &&??A Q HACE REFERENCIA 
	lcRETIENE_PAGO_MORA_SRV ,; &&??EN ORBIS NO SE MANEJA
	lcAUTORIZA_SERVICIOS ,; &&??A Q HACE REFERENCIA 
	lcCOD_BARRIO ,;
	ldFECHA_INGRESO ,; &&??A Q HACE REFERENCIA 
	lnVLR_CESION,; &&??EN ORBIS NO SE MANEJA
	lcNO_REPORTAR_CIFIN ,; &&??EN ORBIS NO SE MANEJA
	lcNOMBRE_ENTREGA ,; &&??EN ORBIS NO SE MANEJA
	lnLLAVES_ENTREGA,; &&??EN ORBIS NO SE MANEJA
	lcLINEAS_ACTUALES ,; &&??EN ORBIS NO SE MANEJA
	lcLINEAS_RETIRADAS ,; &&??EN ORBIS NO SE MANEJA
	lcNEGOCIAR_INDEMNIZACION ,;&&??EN ORBIS NO SE MANEJA
	ldFECHA_DESOCUPACION,;
	lnSALDO_FIANZA,; &&??EN ORBIS NO SE MANEJA
	lcCOD_CLIENTE_PROMOTOR ,;
	lnPORC_RETEIVA,; &&??A Q HACE REFERENCIA
	lcCOD_MOTIVO_DESOCUPACION ,; &&??EN ORBIS NO SE MANEJA
	lcRETENER_SISTEMAS ,; &&??A Q HACE REFERENCIA
	lnREAJUSTE_MINIMO,; &&??A Q HACE REFERENCIA
	ldREPORTE_SERVICIOS ,; &&??A Q HACE REFERENCIA
	lnPORC_ASEGURADORA,;
	lcCODIGO_ARCHIVO ,; &&??EN ORBIS NO SE MANEJA
	lnVR_FIANZA_SERVICIOS,;
	lcCOD_ASEGURADORA_FIANZA,;
	lcNO_RENOVAR ,; &&??EN ORBIS NO SE MANEJA	
	lcBLOQUEO_PAGO ,; &&??A Q HACE REFERENCIA	
	lcOBS_BLOQUEO_PAGO ,; &&??EN ORBIS NO SE MANEJA	
	lcNO_COBRAR_CARTAS ,; &&??EN ORBIS NO SE MANEJA	
	lnVR_DEUDA_SERVICIOS,; &&??A Q HACE REFERENCIA	
	lnVR_DEUDA_REPARACIONES,; &&??A Q HACE REFERENCIA	
	lcCODIGO_FINCA_RAIZ,;
	lcCODIGO_METRO_CUADRADO,;
	lcNO_COBRAR_INTERES,; &&??EN ORBIS NO SE MANEJA	
	lnPORC_RETEICA;
	)
	
	SELECT * FROM FIAD_ARR WHERE IDINMUEBLE = INMUEBLES.IDINMUEBLE AND INMUEBLES.IDARRENDATARIO = lnIdArrendatario INTO CURSOR CFIADORES_CONT 
	
	SELECT CFIADORES_CONT
	GO TOP 
	SCAN 
		IF SEEK(ALLTRIM(CFIADORES_CONT.NITFIADOR),'CLIENTES',"COD_CLI")
			NF = NF + 1
			INSERT INTO CONTRATO_FIADOR VALUES (NF, N, ALLTRIM(CFIADORES_CONT.NITFIADOR))
		ELSE 
			IF SEEK(ALLTRIM(CFIADORES_CONT.NITFIADOR),'FIADORES',"NIT")
				INSERT INTO CNITS_ERROR VALUES(INMUEBLES.IDINMUEBLE,ALLTRIM(CFIADORES_CONT.NITFIADOR),;
				 ALLTRIM(FIADORES.NOMBRE)+" "+ALLTRIM(FIADORES.APELLIDO),"FIA")	
			ENDIF 		
		ENDIF 	
	ENDSCAN 
	
ENDSCAN 

ENDPROC
PROCEDURE migrarinmuebles

SELECT INMUEBLES 
GO TOP
N = 0 
LNSEQ_INMPUB = 0 
LNSEQ_INMUEBLE_PREDIAL = 0 
LNSEQ_INMUEBLE_MATRICULA = 0
SCAN 
	lctelefono = ''
	lcCodInmueble = ALLTRIM(STR(INMUEBLES.IDINMUEBLE))
	thisform.Telefonosjson(ALLTRIM(INMUEBLES.TELEFONO), "","")
	lcTel_inmueble = lctelefono
	lccod_inmobiliaria = "" &&??EN ORBIS NO SE MANEJA
	lctipo_cod_consig = ALLTRIM(STR(INMUEBLES.TCONSIGNACION))
	lccod_sucursal = ALLTRIM(STR(INMUEBLES.IDCIUDAD_CONT))
	lcod_barrio =  ALLTRIM(STR(INMUEBLES.IDBARRIO))
	lccod_tipo_inmueble = ALLTRIM(STR(INMUEBLES.idtinmueble))
	lccod_sub_tipo_inm = "41" &&??EN ORBIS NO SE MANEJA
	lcCod_destino = ALLTRIM(STR(IIF(INMUEBLES.DESTINO=1,1,2)))
	lcCod_estrato = ALLTRIM(STR(INMUEBLES.ESTRATO))
	lccod_estado = ALLTRIM(STR(INMUEBLES.ESTADO))
	lccod_estado_fis = IIF(LEFT(ALLTRIM(INMUEBLES.EST_CONSERVA),1)=="E","1",IIF(LEFT(ALLTRIM(INMUEBLES.EST_CONSERVA),1)=="B","2",;
	IIF(LEFT(ALLTRIM(INMUEBLES.EST_CONSERVA),1)=="R","3",IIF(LEFT(ALLTRIM(INMUEBLES.EST_CONSERVA),1)=="M","4",""))))
	lcinm_nuevo = "N" &&??EN ORBIS NO SE MANEJA 
	ldFecha_cons = INMUEBLES.FCONSIGNACION
	lnValor_avaluo = 0 
	lnvalor_canon = INMUEBLES.CANON_NEG
	lnprecio_venta = 0
	lnPorc_comision = INMUEBLES.PORC_COMISION
	lnPorc_comision_ant = IIF(INMUEBLES.COM_ANTICIPADA,2,0)
	lnVlr_fianza = INMUEBLES.vmonto_serv  &&??-> ESSTO ES DE SERVICIOS PUBLICOS????
	lnCant_cuota_fianza = INMUEBLES.ncuotas_serv  &&??-> ESSTO ES DE SERVICIOS PUBLICOS????
	lcNro_matricula = ""
	lnVlr_admon = INMUEBLES.VADMON
	lnVlr_publicidad = 0 &&??EN ORBIS NO SE MANEJA
	lnVlr_hipoteca = 0
	lcNro_escritura = ""
	ldFecha_escritura = {123}} &&??EN ORBIS NO SE MANEJA
	lcNotaria_Escritura = "" 
	lcCod_ubicacion = "" &&?? A QUE HACE REFERENCIA?????
	lcLiquida_comision_g = IIF(INMUEBLES.comision_min,"N","S") 
	lcLiquida_comision_e = IIF(INMUEBLES.comision_min AND inmuebles.canon_vig<=500000,"S","N")
	lnVlr_com_esp = IIF(INMUEBLES.comision_min AND inmuebles.canon_vig<=500000,50000,0) 
	lnEdad_inm = 0 &&??EN ORBIS NO SE MANEJA
	lcDestacado_web = "N" &&??EN ORBIS NO SE MANEJA
	lcMuestrafoto_web = "N" &&??EN ORBIS NO SE MANEJA
	lcCod_tipo_coc = thisform.cocina(inmuebles.idinmueble)
	lcCod_tipo_parq = thisform.parqueadero(inmuebles.idinmueble)
	lcCod_tipo_piso = thisform.piso(inmuebles.idinmueble)
	lcObservaciones = ALLTRIM(INMUEBLES.OBSERVACIONES)
	lcObservaciones_1 = STRTRAN(lcObservaciones,chr(13)+chr(10),"/")
	lcObservaciones1_ = STRTRAN(lcObservaciones_1,chr(13),"/")
	lcObservaciones1 = STRTRAN(lcObservaciones1_,chr(10),"/")
	lcobservaciones2 = STRTRAN(lcobservaciones1,",","/")
	lcobservaciones3 = STRTRAN(lcobservaciones2,"'","/")
	lcobservaciones4 = STRTRAN(lcobservaciones3,"|","/")	
	lcObs_inm = ALLTRIM(lcObservaciones4)
	lcDir_inmueble = ALLTRIM(INMUEBLES.DIRECCION)
	lcCot_tipo_cman = "ADM" &&??EN ORBIS NO SE MANEJA  
	lcPub1 = "" &&??EN ORBIS NO SE MANEJA
	lcPub2 = "" &&??EN ORBIS NO SE MANEJA
	ldfecha_recons = {123}}
	lcPub3 = "" &&??EN ORBIS NO SE MANEJA
	lcObs_dist = "" &&??
	lcObs_servp = "" &&??
	lcObservaciones1 = STRTRAN(ALLTRIM(INMUEBLES.OBS_ADMON),chr(13)+chr(10),"/")
	lcobservaciones2 = STRTRAN(lcobservaciones1,",","/")
	lcobservaciones3 = STRTRAN(lcobservaciones2,"'","/")
	lcobservaciones4 = STRTRAN(lcobservaciones3,"|","/")
	lcObs_servcom = ALLTRIM(lcObservaciones4)
	ldFecha_retiro = INMUEBLES.FRETIRO
	lcCod_cliente_prom = "" 
	lnArea_lote = 0
	lnArea_const = 0
	lcNro_parqueadero = ""  &&??EN ORBIS NO SE MANEJA
	lcCod_cliente_pad = "" &&??EN ORBIS NO SE MANEJA
	lcDir_video = "" &&??EN ORBIS NO SE MANEJA
	lnVlr_cuota_Aseo = 0 &&??EN ORBIS NO SE MANEJA
	lcAdmon_por_def = "N" &&??EN ORBIS NO SE MANEJA
	lcCod_seg = "A" &&??EN ORBIS NO SE MANEJA -->> PREGUNTAR A ALIANZA SI ES LA COMISION ANTTICIPADA 
	lcNo_cob_int = "N" &&??EN ORBIS NO SE MANEJA
	lcCod_arch = "" &&??EN ORBIS NO SE MANEJA
	lcCod_fr = "" &&??EN ORBIS NO SE MANEJA
	lcCod_mc = "" &&??EN ORBIS NO SE MANEJA
	lcBloq_pag = "N" &&??EN ORBIS NO SE MANEJA
	lnPorc_comad = INMUEBLES.COMADMON
	lnPorc_seg_adm = INMUEBLES.SEG_ADMON 
	lnLatitud = 0 
	lnLongitud = 0 
	lcCod_ruta_pago = "" 
	
	lccod_pot = ALLTRIM(INMUEBLES.POT) 
	DO CASE 
		CASE ALLTRIM(INMUEBLES.POT) = "RT1"
			lccod_pot = "RE1" 
		CASE ALLTRIM(INMUEBLES.POT) = "RT2"
			lccod_pot = "RE2" 
		CASE ALLTRIM(INMUEBLES.POT) = "RT3"
			lccod_pot = "RE3" 
		CASE !INLIST(ALLTRIM(INMUEBLES.POT), "CO1","CO2","DO1","DO2","DO3","IND","MU1","MU2","RE1","RE2","RE3","RE4")
			lccod_pot = "SDE" 
	ENDCASE 	
	
	lcObs_fr = ""
	lnVavaluo = 0
	lnPVavaluo = 0
	lcNcatastro = ""
	lcPNcatastro = ""
	lcNro_matricula = ""
 	lcNro_escritura = ""
 	lcPNro_matricula = ""
 	lcPNro_escritura = ""
	SET EXACT ON 
	 IF  SEEK(INMUEBLES.IDINMUEBLE, "INM_DESC", "IDINMUEBLE")
	 	lnValor_avaluo = INM_DESC.VAVALUO	
	 	lcNro_matricula = ALLTRIM(INM_DESC.NMATRICULA)
	 	lcNro_escritura = ALLTRIM(INM_DESC.NESCRITURA) 
	 	lcPNro_matricula = ALLTRIM(INM_DESC.PNMATRICULA)
	 	lcPNro_escritura = ALLTRIM(INM_DESC.PNESCRITURA)
	 	lnArea_lote = INM_DESC.AREA_TOTAL 
	 	lnArea_const = INM_DESC.AREA_CONST 
	 	lnLatitud = SUBSTR(ALLTRIM(inm_desc.posicion),1,AT(",",ALLTRIM(inm_desc.posicion))-1)
	 	lnLongitud = SUBSTR(ALLTRIM(inm_desc.posicion),AT(",",ALLTRIM(inm_desc.posicion))+1)
	 	lnVlr_hipoteca = INM_DESC.vhipoteca 
	 	ldfecha_recons = INM_DESC.FRECONSIGNACION
	 	lcNro_parqueadero = ALLTRIM(STR(INM_DESC.NRO_PAR))
	 	lcObs_fr = ALLTRIM(INM_DESC.OBSERVACIONES_FR)
	 	lnVavaluo = INM_DESC.VAVALUO 
		lnPVavaluo = INM_DESC.PVAVALUO
		lcNcatastro = ALLTRIM(INM_DESC.NCATASTRO)
		lcPNcatastro = ALLTRIM(INM_DESC.PNCATASTRO)
	 ENDIF 
	 
	 IF SEEK(INMUEBLES.IDBARRIO,"xbarrios","idbarrio")
	 	lcCod_ruta_pago = ALLTRIM(STR(XBARRIOS.RUTA))
	 ENDIF 

	lnSec_unidad = 0 &&??esto es la administracion ***************************************************NO ENVIARION ESTRUCTURAS DE TABLAS 
	IF SEEK(ALLTRIM(inmuebles.nitadmon),"xadmones","nit")
		lnSec_unidad = xadmones.idadmon 
		IF SEEK(ALLTRIM(inmuebles.nitadmon),"clientes","COD_CLI")
			IF !SEEK(xadmones.idadmon,"UNIDADES","SEQ_UNIDAD")
				DO CASE 
					CASE ALLTRIM(xadmones.forma_pago)=='CHEQUE'	
						lnFormapago = "1"
					CASE ALLTRIM(xadmones.forma_pago)=='TRANSFERECIA'	
						lnFormapago = "2"
					CASE ALLTRIM(xadmones.forma_pago)=='EFECTIVO'	
						lnFormapago = "3"			
					OTHERWISE 
						lnFormapago = "1"	
				ENDCASE 	
				*0.Transferencias,7,1. Porterias,1,6. Consignar - Recogen Adm,6,8. Ruta8,8
				lnrutapago = "0"
				DO CASE 
					CASE XADMONES.RUTA = 7
						lnrutapago = "1"		
					CASE XADMONES.RUTA = 1
						lnrutapago = "2"
					CASE XADMONES.RUTA = 6
						lnrutapago = "3"
					CASE XADMONES.RUTA = 8
						lnrutapago = "4"
				ENDCASE 
				
								
				lcCod_ciudad = '68001'	
				lnidCiudad = XADMONES.IDCIUDAD_XADMON
				IF SEEK(lnidCiudad,"CIUDADES","IDCIUDAD")
					lcCiudad = ALLTRIM(CIUDADES.CIUDAD)
					IF SEEK(lcCiudad,"CIUDAD","CIUDAD")
						lcCod_ciudad = ALLTRIM(CIUDAD.COD_CIUDAD)
					ENDIF 
				ENDIF 
				
				lcObservaciones1 = STRTRAN(ALLTRIM(xadmones.observaciones),chr(13)+chr(10),"/")
				lcobservaciones2 = STRTRAN(lcobservaciones1,",","/")
				lcobservaciones3 = STRTRAN(lcobservaciones2,"'","/")
				lcobservaciones4 = STRTRAN(lcobservaciones3,"|","/")


				lcCadena_Direccion = ALLTRIM(xadmones.direccion) 
					 		
				lcCadena_atipico = ""
				lcViaPPal=""
				lcEjevial1=""
				lcEjevial2=""
				lcEjevial3=""
				lcCompl1=""
				lcCompl2=""
				lcCompl3=""
				lcCompl4=""
				lcCompl5="" 
				lcCompl6="" 
				lcCompl7="" 
				lcCompl8="" 
				lnViaPPal = 0
				lnCompl1 = 0
				lnCompl3 = 0
				lnCompl5 = 0
				lcCadena_fjson = ""
				
				IF LEN(ALLTRIM(lcCadena_Direccion))>0 
					lnPosAtI = ATC("(",lcCadena_Direccion)
					lnPosAtF = ATC(")",lcCadena_Direccion)
					IF lnPosAtI>0 AND lnPosAtF>0
						lcCadena_atipico = SUBSTR(lcCadena_Direccion,lnPosAtI+1,lnPosAtF-(lnPosAtI+1))
						lcDir_unidad = SUBSTR(lcCadena_Direccion,1,lnPosAtI-1)
					ENDIF 
					
					thisform.via_ppal(lcCadena_Direccion) 	
					
					IF LEN(ALLTRIM(lcViaPPal))=0 AND LEN(ALLTRIM(lcEjevial1))=0 AND LEN(ALLTRIM(lcEjevial2))=0 AND LEN(ALLTRIM(lcEjevial3))=0
						lcCadena_atipico = lcCadena_Direccion
					ENDIF 
					
					lcCadena_fjson = '{123}"dir":"'+ALLTRIM(lcCadena_Direccion)+'","json":"{123}\"via_principal\":\"'+ALLTRIM(lcViaPPal)+'\",\"eje_vial_1\":\"'+ALLTRIM(lcEjevial1)+;
					'\",\"eje_vial_2\":\"'+ALLTRIM(lcEjevial2)+'\",\"eje_vial_3\":\"'+ALLTRIM(lcEjevial3)+'\",\"complemento_1\":\"'+ALLTRIM(lcCompl1)+'\",\"complemento_2\":\"'+;
					ALLTRIM(lcCompl2)+'\",\"complemento_3\":\"'+ALLTRIM(lcCompl3)+'\",\"complemento_4\":\"'+ALLTRIM(lcCompl4)+'\",\"complemento_5\":\"'+ALLTRIM(lcCompl5)+;
					'\",\"complemento_6\":\"'+ALLTRIM(lcCompl6)+'\",\"complemento_7\":\"'+ALLTRIM(lcCompl7)+'\",\"complemento_8\":\"'+ALLTRIM(lcCompl8)+'\",\"atipico\":\"'+;
					ALLTRIM(lcCadena_atipico)+'\"}"}'
					
					lnnrocharjson = LEN(ALLTRIM(lcCadena_fjson))

					lcCadena1_json = SUBSTR(lcCadena_fjson,1,249)+"&"
					lcCadena2_json = SUBSTR(lcCadena_fjson,250,249)+"&"
					lcCadena3_json = SUBSTR(lcCadena_fjson,500,249)+"&"
					lcCadena4_json = SUBSTR(lcCadena_fjson,750,249)+"&"
					
					SELECT unidades_direccion
			 			APPEND BLANK 
			 			REPLACE;
			 			SEQ_UNIDAD WITH xadmones.idadmon,;
			 			VIA_PRINCIPAL WITH ALLTRIM(lcViaPPal),;
			 			EJE_VIAL_1 WITH lcEjevial1,;
			 			EJE_VIAL_2 WITH lcEjevial2,;
			 			EJE_VIAL_3 WITH lcEjevial3,; 
			 			COMPLEMENTO_1 WITH ALLTRIM(lcCompl1),;
			 			COMPLEMENTO_2 WITH lcCompl2,;
			 			COMPLEMENTO_3 WITH ALLTRIM(lcCompl3),;
			 			COMPLEMENTO_4 WITH lcCompl4,;
			 			COMPLEMENTO_6 WITH lcCompl6,;
						ATIPICO WITH lcCadena_atipico,;
						FJSON1 With lcCadena1_json,;
						FJSON2 With lcCadena2_json,;
						FJSON3 With lcCadena3_json,;
						FJSON4 With lcCadena4_json;
			 			IN unidades_direccion
				ENDIF
				
				lcDir_unidad = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
				IF LEN(ALLTRIM(lcDir_inmueble))=0
					lcDir_unidad =lcCadena_atipico
				ENDIF  

	
				INSERT INTO UNIDADES VALUES (xadmones.idadmon,ALLTRIM(XADMONES.NOMBRE)+" "+ALLTRIM(xadmones.APELLIDO), "S", ALLTRIM(xadmones.nit),"N",;
				"",lnformapago,ALLTRIM(xadmones.dia_limite), ALLTRIM(xadmones.idbanco), ALLTRIM(xadmones.ncuenta), ALLTRIM(STR(xadmones.tcuenta)), ALLTRIM(lcobservaciones4),;
				0, lnrutapago, lcDir_unidad ,lcCod_ciudad, ALLTRIM(xadmones.nit), ALLTRIM(xadmones.telefono), 0, 0, ALLTRIM(xadmones.nit), ALLTRIM(xadmones.nit),ALLTRIM(xadmones.dia_limite))
			ENDIF 	
		ELSE 
			INSERT INTO CNITS_ERROR VALUES(INMUEBLES.IDINMUEBLE,ALLTRIM(xadmones.NIT), ALLTRIM(xadmones.NOMBRE)+" "+ALLTRIM(xadmones.APELLIDO),"ADM")			
		ENDIF 
	ENDIF 	 
	SET EXACT OFF 
	
	lcCadena_Direccion = lcDir_inmueble 
		 		
	lcCadena_atipico = ""
	lcViaPPal=""
	lcEjevial1=""
	lcEjevial2=""
	lcEjevial3=""
	lcCompl1=""
	lcCompl2=""
	lcCompl3=""
	lcCompl4=""
	lcCompl5="" 
	lcCompl6="" 
	lcCompl7="" 
	lcCompl8="" 
	lnViaPPal = 0
	lnCompl1 = 0
	lnCompl3 = 0
	lnCompl5 = 0
	lcCadena_fjson = ""
	
	IF LEN(ALLTRIM(lcCadena_Direccion))>0 
		lnPosAtI = ATC("(",lcCadena_Direccion)
		lnPosAtF = ATC(")",lcCadena_Direccion)
		IF lnPosAtI>0 AND lnPosAtF>0
			lcCadena_atipico = SUBSTR(lcCadena_Direccion,lnPosAtI+1,lnPosAtF-(lnPosAtI+1))
			lcDir_inmueble = SUBSTR(lcCadena_Direccion,1,lnPosAtI-1)
		ENDIF 
		
		thisform.via_ppal(lcCadena_Direccion) 	
		
		IF LEN(ALLTRIM(lcViaPPal))=0 AND LEN(ALLTRIM(lcEjevial1))=0 AND LEN(ALLTRIM(lcEjevial2))=0 AND LEN(ALLTRIM(lcEjevial3))=0
			lcCadena_atipico = lcCadena_Direccion
		ENDIF 
		
		lcCadena_fjson = '{123}"dir":"'+ALLTRIM(lcCadena_Direccion)+'","json":"{123}\"via_principal\":\"'+ALLTRIM(lcViaPPal)+'\",\"eje_vial_1\":\"'+ALLTRIM(lcEjevial1)+;
		'\",\"eje_vial_2\":\"'+ALLTRIM(lcEjevial2)+'\",\"eje_vial_3\":\"'+ALLTRIM(lcEjevial3)+'\",\"complemento_1\":\"'+ALLTRIM(lcCompl1)+'\",\"complemento_2\":\"'+;
		ALLTRIM(lcCompl2)+'\",\"complemento_3\":\"'+ALLTRIM(lcCompl3)+'\",\"complemento_4\":\"'+ALLTRIM(lcCompl4)+'\",\"complemento_5\":\"'+ALLTRIM(lcCompl5)+;
		'\",\"complemento_6\":\"'+ALLTRIM(lcCompl6)+'\",\"complemento_7\":\"'+ALLTRIM(lcCompl7)+'\",\"complemento_8\":\"'+ALLTRIM(lcCompl8)+'\",\"atipico\":\"'+;
		ALLTRIM(lcCadena_atipico)+'\"}"}'
		
		lnnrocharjson = LEN(ALLTRIM(lcCadena_fjson))

		lcCadena1_json = SUBSTR(lcCadena_fjson,1,249)+"&"
		lcCadena2_json = SUBSTR(lcCadena_fjson,250,249)+"&"
		lcCadena3_json = SUBSTR(lcCadena_fjson,500,249)+"&"
		lcCadena4_json = SUBSTR(lcCadena_fjson,750,249)+"&"
					
		SELECT inmueble_direccion
 			APPEND BLANK 
 			REPLACE;
 			COD_INMUEBLE WITH lcCodInmueble,;
 			VIA_PRINCIPAL WITH ALLTRIM(lcViaPPal),;
 			EJE_VIAL_1 WITH lcEjevial1,;
 			EJE_VIAL_2 WITH lcEjevial2,;
 			EJE_VIAL_3 WITH lcEjevial3,; 
 			COMPLEMENTO_1 WITH ALLTRIM(lcCompl1),;
 			COMPLEMENTO_2 WITH lcCompl2,;
 			COMPLEMENTO_3 WITH ALLTRIM(lcCompl3),;
 			COMPLEMENTO_4 WITH lcCompl4,;
 			COMPLEMENTO_6 WITH lcCompl6,;
			ATIPICO WITH lcCadena_atipico,;
			FJSON1 With lcCadena1_json,;
			FJSON2 With lcCadena2_json,;
			FJSON3 With lcCadena3_json,;
			FJSON4 With lcCadena4_json;
 			IN inmueble_direccion
	ENDIF
	
	lcDir_inmueble = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
	IF LEN(ALLTRIM(lcDir_inmueble))=0
		lcDir_inmueble =lcCadena_atipico
	ENDIF  
	
	 IF SEEK(INMUEBLES.COMISIONISTA,"XPROMOTOR","IDPROMOTOR")
    	IF SEEK(ALLTRIM(XPROMOTOR.CEDULA),"NITS","NIT")
			IF SEEK(ALLTRIM(NITS.NIT),'CLIENTES',"COD_CLI")
			   	lcCod_cliente_prom = ALLTRIM(NITS.NIT)
			ELSE
				INSERT INTO CNITS_ERROR VALUES(INMUEBLES.IDINMUEBLE,ALLTRIM(NITS.NIT), ALLTRIM(NITS.NOMBRE)+" "+ALLTRIM(NITS.APELLIDO),"PRM")		
			ENDIF 	
	    ENDIF 	
    ENDIF 
	
	INSERT INTO INMUEBLE VALUES(lcCodInmueble, lcTel_inmueble, lccod_inmobiliaria, lctipo_cod_consig, lccod_sucursal, lcod_barrio, lccod_tipo_inmueble,;
	lccod_sub_tipo_inm, lccod_pot, lcCod_destino, lcCod_estrato, lccod_estado, lccod_estado_fis, lcinm_nuevo, ldFecha_cons, lnValor_avaluo, lnvalor_canon,;
	lnprecio_venta, lnPorc_comision, lnPorc_comision_ant, lnVlr_fianza, lnCant_cuota_fianza, lcNro_matricula, lnVlr_admon, lnVlr_publicidad, lnVlr_hipoteca,;
	lcNro_escritura, ldFecha_escritura, lcNotaria_Escritura, lcCod_ubicacion, lcLiquida_comision_g, lcLiquida_comision_e, lnVlr_com_esp, lnEdad_inm,;
	lcDestacado_web, lcMuestrafoto_web, lcCod_tipo_coc, lcCod_tipo_parq, lcCod_tipo_piso, lcObs_inm, lcDir_inmueble, lnSec_unidad, lcCot_tipo_cman,;
	lcPub1, lcPub2, ldfecha_recons, lcPub3, lcObs_dist, lcObs_servp, lcObs_servcom, ldFecha_retiro, lcCod_cliente_prom,	lnArea_lote, lnArea_const,;
	lcNro_parqueadero, lcCod_cliente_pad, lcDir_video, lnVlr_cuota_Aseo, lcAdmon_por_def, lcCod_seg, lcNo_cob_int, lcCod_arch, lcCod_fr, lcCod_mc,;
	lcBloq_pag, lnPorc_comad, lnPorc_seg_adm, lnLatitud, lnLongitud, lcCod_ruta_pago)
	
	IF LEN(ALLTRIM(lcObs_fr))>0
		LNSEQ_INMPUB = LNSEQ_INMPUB + 1
		INSERT INTO INMUEBLE_TIPO_PUBLICIDAD VALUES(LNSEQ_INMPUB, lcCodInmueble, "FRA", lcObs_fr)
	ENDIF 
	
	IF lnVavaluo>0 AND LEN(ALLTRIM(lcNcatastro))>0
		LNSEQ_INMUEBLE_PREDIAL = LNSEQ_INMUEBLE_PREDIAL + 1
		INSERT INTO INMUEBLE_PREDIAL VALUES (lcCodInmueble, "INM","N",lcNcatastro,2018,lnVavaluo,LNSEQ_INMUEBLE_PREDIAL)
	ENDIF 
	
	IF lnPVavaluo>0 AND LEN(ALLTRIM(lcPNcatastro))>0
		LNSEQ_INMUEBLE_PREDIAL = LNSEQ_INMUEBLE_PREDIAL + 1
		INSERT INTO INMUEBLE_PREDIAL VALUES (lcCodInmueble, "PAR","N",lcPNcatastro,2018,lnPVavaluo,LNSEQ_INMUEBLE_PREDIAL)
	ENDIF 
	
	IF LEN(ALLTRIM(lcNro_matricula))>0 AND LEN(ALLTRIM(lcNro_escritura)) >0
		LNSEQ_INMUEBLE_MATRICULA = LNSEQ_INMUEBLE_MATRICULA + 1 
		INSERT INTO INMUEBLE_MATRICULA VALUES (LNSEQ_INMUEBLE_MATRICULA, lcCodInmueble, "INM", lcNro_matricula, lcNro_escritura, {123}},"")
	ENDIF 
	
	IF LEN(ALLTRIM(lcPNro_matricula))>0 AND LEN(ALLTRIM(lcPNro_escritura)) >0
		LNSEQ_INMUEBLE_MATRICULA = LNSEQ_INMUEBLE_MATRICULA + 1 
		INSERT INTO INMUEBLE_MATRICULA VALUES (LNSEQ_INMUEBLE_MATRICULA, lcCodInmueble, "PAR", lcPNro_matricula, lcPNro_escritura, {123}},"")
	ENDIF 

	**inmueble_propietario

	SELECT * FROM INMPRO WHERE IDINMUEBLE = INMUEBLES.IDINMUEBLE INTO CURSOR CPROPS
	
	SELECT CPROPS
	GO TOP 
	SCAN 
		SET EXACT ON 
		IF SEEK(CPROPS.IDPROPIETARIO,'PROPIETARIOS',"IDPROPIETA")
			IF propietarios.pagpredial 
				UPDATE INMUEBLE_PREDIAL SET PAGA_PREDIAL = "S" WHERE ALLTRIM(COD_INMUEBLE)==lcCodInmueble
			ENDIF 
			
			IF SEEK(ALLTRIM(PROPIETARIOS.CEDULA),'CLIENTES',"COD_CLI")
				N = N + 1
				
				DO CASE 
					CASE PROPIETARIOS.TIPO_PAGO = 1 AND PROPIETARIOS.FORMA_PAGO = 1 AND PROPIETARIOS.FORMA_ENTREGA <> 2 AND LEN(ALLTRIM(PROPIETARIOS.CEDULA_BEN))>0 AND LEN(ALLTRIM(PROPIETARIOS.BENEFICIARIO))>0 
						lcNitBen = ALLTRIM(PROPIETARIOS.CEDULA_BEN)
						lcNro_cuenta = ""
						lcCod_banco = ""
					CASE PROPIETARIOS.TIPO_PAGO = 1 AND PROPIETARIOS.FORMA_PAGO = 2 AND LEN(ALLTRIM(PROPIETARIOS.NITCUENTA))>0 AND LEN(ALLTRIM(PROPIETARIOS.TITULAR_CUENTA))>0 
						lcNitBen = ALLTRIM(PROPIETARIOS.NITCUENTA)
						lcNro_cuenta = ALLTRIM(PROPIETARIOS.CUENTA)
						lcCod_banco = ALLTRIM(PROPIETARIOS.IDBANCO)
					CASE PROPIETARIOS.TIPO_PAGO = 1 AND PROPIETARIOS.FORMA_PAGO = 1 AND PROPIETARIOS.FORMA_ENTREGA = 2 AND LEN(ALLTRIM(PROPIETARIOS.NITCUENTA))>0 AND LEN(ALLTRIM(PROPIETARIOS.TITULAR_CUENTA))>0 
						lcNitBen = ALLTRIM(PROPIETARIOS.NITCUENTA) 
						lcNro_cuenta = ALLTRIM(PROPIETARIOS.CUENTA)
						lcCod_banco = ALLTRIM(PROPIETARIOS.IDBANCO)
					
					CASE PROPIETARIOS.TIPO_PAGO = 2	
						DO CASE 
							CASE INMUEBLES.FORMA_PAGO = 1 AND INMUEBLES.FORMA_ENT <> 2 AND LEN(ALLTRIM(INMUEBLES.CEDULA_BEN))>0 AND LEN(ALLTRIM(INMUEBLES.BENEFICIARIO))>0 
								lcNitBen = ALLTRIM(INMUEBLES.CEDULA_BEN)
								lcNro_cuenta = ""
								lcCod_banco = ""
							CASE INMUEBLES.FORMA_PAGO = 2 AND LEN(ALLTRIM(INMUEBLES.NITCUENTA))>0 AND LEN(ALLTRIM(INMUEBLES.TITULAR_CUENTA))>0 
								lcNitBen = ALLTRIM(INMUEBLES.NITCUENTA)
								lcNro_cuenta = ALLTRIM(INMUEBLES.CUENTA)
								lcCod_banco = ALLTRIM(INMUEBLES.IDBANCO)
							CASE INMUEBLES.FORMA_PAGO = 1 AND INMUEBLES.FORMA_ENT = 2 AND LEN(ALLTRIM(INMUEBLES.NITCUENTA))>0 AND LEN(ALLTRIM(INMUEBLES.TITULAR_CUENTA))>0 
								lcNitBen = ALLTRIM(INMUEBLES.NITCUENTA)
								lcNro_cuenta = ALLTRIM(INMUEBLES.CUENTA)
								lcCod_banco = ALLTRIM(INMUEBLES.IDBANCO)
							OTHERWISE 
								lcNitBen = ALLTRIM(CLIENTES.COD_CLIENTE)
								lcNro_cuenta = ""
								lcCod_banco = ""
						ENDCASE  	
					OTHERWISE 
						lcNitBen = ALLTRIM(CLIENTES.COD_CLIENTE)
						lcNro_cuenta = ""
						lcCod_banco = ""
				ENDCASE
				
				SET EXACT ON 
				IF !SEEK(lcNitBen,"CLIENTES","COD_CLI")
					INSERT INTO CNITS_ERROR VALUES(INMUEBLES.IDINMUEBLE,ALLTRIM(lcNitBen),; 
					ALLTRIM(PROPIETARIOS.NOMBRE)+" "+ALLTRIM(PROPIETARIOS.APELLIDO),"BEN")	
				ENDIF 
				
				SET EXACT OFF	
				INSERT INTO INMUEBLE_PROPIETARIO VALUES(N, lcCodInmueble, ALLTRIM(CLIENTES.COD_CLIENTE), lcNitBen, ALLTRIM(CLIENTES.COD_CLIENTE),;
				CPROPS.PARTICIPACION, lcNro_cuenta,"68001",lcCod_banco,ALLTRIM(STR(PROPIETARIOS.FORMA_PAGO)),;
				ALLTRIM(STR(PROPIETARIOS.FORMA_ENT)),ALLTRIM(STR(PROPIETARIOS.TCUENTA)))
				
				IF PROPIETARIOS.FORMA_PAGO = 4 AND PROPIETARIOS.TIPO_PAGO<=2
					UPDATE INMUEBLE SET BLOQUEAR_PAGO = "S" WHERE ALLTRIM(COD_INMUEBLE)==ALLTRIM(lcCodInmueble)
				ENDIF 
						
			ELSE
				INSERT INTO CNITS_ERROR VALUES(INMUEBLES.IDINMUEBLE,ALLTRIM(PROPIETARIOS.CEDULA),; 
				ALLTRIM(PROPIETARIOS.NOMBRE)+" "+ALLTRIM(PROPIETARIOS.APELLIDO),"PRO")	
			ENDIF 
		ENDIF 
		SET EXACT OFF
	ENDSCAN 
	
ENDSCAN 

ENDPROC
PROCEDURE migrarmov


SELECT RC
GO TOP 
SCAN 
	lniddoc = VAL(ALLTRIM(STR(YEAR(RC.FECHA)))+ALLTRIM(STR(RC.IDDOC)))
	INSERT INTO COMPROBANTE VALUES (lniddoc, "CI", VAL(RC.NUMERO), RC.FECHA, IIF(RC.ESTADO=2,"S","N"),IIF(RC.ESTADO=2,"S","N"),"")
ENDSCAN 

SELECT CE
GO TOP 
SCAN 
	lniddoc = VAL(ALLTRIM(STR(YEAR(CE.FECHA)))+ALLTRIM(STR(CE.IDDOC)))
	INSERT INTO COMPROBANTE VALUES (lniddoc, IIF(CE.FPAGO=1,"EC","EE"), VAL(CE.NUMERO), CE.FECHA, IIF(CE.ESTADO=2,"S","N"),IIF(CE.ESTADO=2,"S","N"),"")
ENDSCAN 

SELECT NC
GO TOP 
SCAN 
	lniddoc = VAL(ALLTRIM(STR(YEAR(NC.FECHA)))+ALLTRIM(STR(NC.IDDOC)))
	INSERT INTO COMPROBANTE VALUES (lniddoc, IIF(ALLTRIM(NC.TIPO)=="N" AND VAL(SUBSTR(NC.NUMERO,4)) = 1,"C",IIF(ALLTRIM(NC.TIPO)=="NC","NH","NN")),; 
	VAL(ALLTRIM(STR(MONTH(NC.FECHA)))+IIF(ALLTRIM(NC.TIPO)=="N",PADL(ALLTRIM(STR(VAL(SUBSTR(NC.NUMERO,4)))),5,"0"),;
	PADL(ALLTRIM(STR(VAL(SUBSTR(NC.NUMERO,6)))),5,"0"))), NC.FECHA, IIF(NC.ESTADO=2,"S","N"),IIF(NC.ESTADO=2,"S","N"),"")
ENDSCAN 


lnSecMov = 0
SELECT MOV 
GO TOP 
SCAN 
	lniddoc = VAL(ALLTRIM(STR(YEAR(MOV.FECHA)))+ALLTRIM(STR(MOV.IDDOC)))
	
	lnCodigoContrato = 0
	SET EXACT ON 
	IF ALLTRIM(mov.codigo)=='13050501'
		lcCad = PADL(ALLTRIM(STR(MOV.IDINM)),6,"0")+PADL(ALLTRIM(MOV.NIT),20,"0")	
		IF SEEK(lcCad,"CONTRATO","KEY1")
			lnCodigoContrato = CONTRATO.SEQ_CONTRATO
		ENDIF 
	ENDIF 
	SET EXACT OFF 
	
	lnSecMov = lnSecMov + 1
	SELECT COMPROBANTE_DETALLE
	APPEND BLANK 
	REPLACE;
	SEQ_COMPROBANTE_DETALLE WITH lnSecMov,;
	SEQ_COMPROBANTE WITH lniddoc,;
	SEQ_COMPROBANTE_ANULA WITH 0,; &&??
	DETALLE_REGISTRO WITH ALLTRIM(MOV.DETALLE),;
	COD_CLIENTE WITH ALLTRIM(MOV.NIT),;
	COD_CUENTA WITH ALLTRIM(MOV.CODIGO),;
	COD_CONCEPTO WITH MOV.IDCONCEPTO,;
	VLR_DEBE WITH MOV.VALOR_DB,;
	VLR_HABER WITH MOV.VALOR_CR,;
	COD_TIPO_SOPORTE WITH "",; &&??
	NRO_DOC_SOPORTE WITH IIF(!ALLTRIM(MOV.IDCONCEPTO)=="45" AND !LEFT(ALLTRIM(MOV.DOC_REF),1)='O',ALLTRIM(MOV.DOC_REF),""),; &&??
	FECHA_DOC_SOPORTE WITH MOV.FECHA,;
	COD_TIPO_INGRESO WITH "",; &&??
	NRO_DOC_PAGO WITH "",;&&??
	FECHA_DOC_PAGO WITH {123}},;&&??
	MES WITH MONTH(MOV.FECHA),;
	ANO WITH YEAR(MOV.FECHA),;
	COMPROBANTE_CIERRE WITH IIF(MOV.DECIERRE,"S","N"),;
	APLICA_IVA WITH "N",;&&??
	APLICA_RFTE WITH "N",;&&??
	SEQ_CONTRATO WITH lnCodigoContrato ,;
	COD_INMUEBLE WITH ALLTRIM(STR(MOV.IDINM)),;
	COD_SUCURSAL WITH "",;&&??
	NRO_CHEQUE WITH IIF(ALLTRIM(MOV.IDCONCEPTO)=="45",VAL(MOV.DOC_REF),0),;
	NRO_FACTURA_VARIOS WITH IIF(!ALLTRIM(MOV.IDCONCEPTO)=="45" AND LEFT(ALLTRIM(MOV.DOC_REF),1)='O',ALLTRIM(MOV.DOC_REF),""),;
	CDEBE WITH MOV.VALOR_DB,;
	CHABER WITH MOV.VALOR_CR,;
	COD_CENTRO_COSTO WITH MOV.IDCCOSTO,;
	VLR_BASE WITH MOV.BASE IN COMPROBANTE_DETALLE
	
	SET EXACT ON 
	IF MOV.FUENTE = 2 &&SI ES COMPROBANTE DE EGRESO 
		IF SEEK(ALLTRIM(MOV.NDOCUMENTO),"CE","NUMERO")
			IF COMPROBANTE_DETALLE.NRO_CHEQUE=0 AND CE.FPAGO=1
				REPLACE COMPROBANTE_DETALLE.NRO_CHEQUE WITH VAL(CE.NCHEQUE)
				REPLACE COMPROBANTE_DETALLE.COD_BANCO WITH ALLTRIM(CE.BANCO)
			ENDIF 
		ENDIF 
	ENDIF 
	
	IF SEEK(ALLTRIM(MOV.CODIGO),"MAYOR","CODAUX")
		REPLACE COMPROBANTE_DETALLE.COD_CUENTA_NIIF WITH ALLTRIM(MAYOR.CODIGO_NIIF)
	ENDIF 
	SET EXACT OFF 	
	
	SELECT MOV 	
ENDSCAN 

********************************************************************************************************************************

SELECT RC_2018
GO TOP 
SCAN 
	lniddoc = VAL(ALLTRIM(STR(YEAR(RC_2018.FECHA)))+ALLTRIM(STR(RC_2018.IDDOC)))
	INSERT INTO COMPROBANTE VALUES (lniddoc, "CI", VAL(RC_2018.NUMERO), RC_2018.FECHA, IIF(RC_2018.ESTADO=2,"S","N"),IIF(RC_2018.ESTADO=2,"S","N"),"")
ENDSCAN 

SELECT CE_2018
GO TOP 
SCAN 
	lniddoc = VAL(ALLTRIM(STR(YEAR(CE_2018.FECHA)))+ALLTRIM(STR(CE_2018.IDDOC)))
	INSERT INTO COMPROBANTE VALUES (lniddoc, IIF(CE_2018.FPAGO=1,"EC","EE"), VAL(CE_2018.NUMERO), CE_2018.FECHA, IIF(CE_2018.ESTADO=2,"S","N"),IIF(CE_2018.ESTADO=2,"S","N"),"")
ENDSCAN 

SELECT NC_2018
GO TOP 
SCAN 
	lniddoc = VAL(ALLTRIM(STR(YEAR(NC_2018.FECHA)))+ALLTRIM(STR(NC_2018.IDDOC)))
	INSERT INTO COMPROBANTE VALUES (lniddoc, IIF(ALLTRIM(NC_2018.TIPO)=="N" AND VAL(SUBSTR(NC_2018.NUMERO,4)) = 1,"C",IIF(ALLTRIM(NC_2018.TIPO)=="NC_2018","NH","NN")),; 
	VAL(ALLTRIM(STR(MONTH(NC_2018.FECHA)))+IIF(ALLTRIM(NC_2018.TIPO)=="N",PADL(ALLTRIM(STR(VAL(SUBSTR(NC_2018.NUMERO,4)))),5,"0"),;
	PADL(ALLTRIM(STR(VAL(SUBSTR(NC_2018.NUMERO,6)))),5,"0"))), NC_2018.FECHA, IIF(NC_2018.ESTADO=2,"S","N"),IIF(NC_2018.ESTADO=2,"S","N"),"")
ENDSCAN 


lnSecMov = 0
SELECT MOV_2018 
GO TOP 
SCAN 
	lniddoc = VAL(ALLTRIM(STR(YEAR(MOV_2018.FECHA)))+ALLTRIM(STR(MOV_2018.IDDOC)))
	
	lnCodigoContrato = 0
	SET EXACT ON 
	IF ALLTRIM(MOV_2018.codigo)=='13050501'
		lcCad = PADL(ALLTRIM(STR(MOV_2018.IDINM)),6,"0")+PADL(ALLTRIM(MOV_2018.NIT),20,"0")	
		IF SEEK(lcCad,"CONTRATO","KEY1")
			lnCodigoContrato = CONTRATO.SEQ_CONTRATO
		ENDIF 
	ENDIF 
	SET EXACT OFF 
	
	lnSecMov = lnSecMov + 1
	SELECT COMPROBANTE_DETALLE
	APPEND BLANK 
	REPLACE;
	SEQ_COMPROBANTE_DETALLE WITH lnSecMov,;
	SEQ_COMPROBANTE WITH lniddoc,;
	SEQ_COMPROBANTE_ANULA WITH 0,; &&??
	DETALLE_REGISTRO WITH ALLTRIM(MOV_2018.DETALLE),;
	COD_CLIENTE WITH ALLTRIM(MOV_2018.NIT),;
	COD_CUENTA WITH ALLTRIM(MOV_2018.CODIGO),;
	COD_CONCEPTO WITH MOV_2018.IDCONCEPTO,;
	VLR_DEBE WITH MOV_2018.VALOR_DB,;
	VLR_HABER WITH MOV_2018.VALOR_CR,;
	COD_TIPO_SOPORTE WITH "",; &&??
	NRO_DOC_SOPORTE WITH IIF(!ALLTRIM(MOV_2018.IDCONCEPTO)=="45" AND !LEFT(ALLTRIM(MOV_2018.DOC_REF),1)='O',ALLTRIM(MOV_2018.DOC_REF),""),; &&??
	FECHA_DOC_SOPORTE WITH MOV_2018.FECHA,;
	COD_TIPO_INGRESO WITH "",; &&??
	NRO_DOC_PAGO WITH "",;&&??
	FECHA_DOC_PAGO WITH {123}},;&&??
	MES WITH MONTH(MOV_2018.FECHA),;
	ANO WITH YEAR(MOV_2018.FECHA),;
	COMPROBANTE_CIERRE WITH IIF(MOV_2018.DECIERRE,"S","N"),;
	APLICA_IVA WITH "N",;&&??
	APLICA_RFTE WITH "N",;&&??
	SEQ_CONTRATO WITH lnCodigoContrato ,;
	COD_INMUEBLE WITH ALLTRIM(STR(MOV_2018.IDINM)),;
	COD_SUCURSAL WITH "",;&&??
	NRO_CHEQUE WITH IIF(ALLTRIM(MOV_2018.IDCONCEPTO)=="45",VAL(MOV_2018.DOC_REF),0),;
	NRO_FACTURA_VARIOS WITH IIF(!ALLTRIM(MOV_2018.IDCONCEPTO)=="45" AND LEFT(ALLTRIM(MOV_2018.DOC_REF),1)='O',ALLTRIM(MOV_2018.DOC_REF),""),;
	CDEBE WITH MOV_2018.VALOR_DB,;
	CHABER WITH MOV_2018.VALOR_CR,;
	COD_CENTRO_COSTO WITH MOV_2018.IDCCOSTO,;
	VLR_BASE WITH MOV_2018.BASE IN COMPROBANTE_DETALLE
	
	SET EXACT ON 
	IF MOV_2018.FUENTE = 2 &&SI ES COMPROBANTE DE EGRESO 
		IF SEEK(ALLTRIM(MOV_2018.NDOCUMENTO),"CE","NUMERO")
			IF COMPROBANTE_DETALLE.NRO_CHEQUE=0 AND CE.FPAGO=1
				REPLACE COMPROBANTE_DETALLE.NRO_CHEQUE WITH VAL(CE.NCHEQUE)
				REPLACE COMPROBANTE_DETALLE.COD_BANCO WITH ALLTRIM(CE.BANCO)
			ENDIF 
		ENDIF 
	ENDIF 
	
	IF SEEK(ALLTRIM(MOV_2018.CODIGO),"MAYOR","CODAUX")
		REPLACE COMPROBANTE_DETALLE.COD_CUENTA_NIIF WITH ALLTRIM(MAYOR.CODIGO_NIIF)
	ENDIF 
	SET EXACT OFF 	
	
	SELECT MOV_2018 	
ENDSCAN 

********************************************************************************************************************************

SELECT MAYOR 
GO TOP 
SCAN FOR TIPO = 2 AND !NITS
	IF MAYOR.SALI>0
		INSERT INTO CSALDOS_CUENTAS VALUES (ALLTRIM(MAYOR.CODIGO),"","",0,MAYOR.SALI)
	ENDIF 	
ENDSCAN 

SELECT MAYORINM 
GO TOP 
SCAN FOR IDINM > 0 AND (ALLTRIM(CODIGO) == '28150501' OR ALLTRIM(CODIGO) == '13050501')
	IF MAYORINM.SALI>0
		IF ALLTRIM(CODIGO)=='13050501'
			SET EXACT ON 
			lckey = PADL(ALLTRIM(STR(MAYORINM.IDINM)),6,"0")+PADL(ALLTRIM(MAYORINM.NIT),20,"0") 
			IF SEEK(lckey,"CONTRATO","key1")
				INSERT INTO CSALDOS_CUENTAS VALUES (ALLTRIM(MAYORINM.CODIGO),ALLTRIM(MAYORINM.NIT),ALLTRIM(STR(MAYORINM.IDINM)),CONTRATO.SEQ_CONTRATO,MAYORINM.SALI)
			ELSE 
				INSERT INTO CSALDOS_CUENTAS VALUES (ALLTRIM(MAYORINM.CODIGO),ALLTRIM(MAYORINM.NIT),ALLTRIM(STR(MAYORINM.IDINM)),0,MAYORINM.SALI)	
			ENDIF 
			SET EXACT OFF 
		ELSE 
			INSERT INTO CSALDOS_CUENTAS VALUES (ALLTRIM(MAYORINM.CODIGO),ALLTRIM(MAYORINM.NIT),ALLTRIM(STR(MAYORINM.IDINM)),0,MAYORINM.SALI)
		ENDIF 	
	ENDIF 	
ENDSCAN 

SELECT MAYORNIT
GO TOP 
SCAN FOR LEN(ALLTRIM(NIT)) > 0 AND !INLIST(ALLTRIM(CODIGO),'28150501','13050501')
	IF MAYORNIT.SALI>0
		INSERT INTO CSALDOS_CUENTAS VALUES (ALLTRIM(MAYORNIT.CODIGO),ALLTRIM(MAYORNIT.NIT),"",0,MAYORNIT.SALI)
	ENDIF 	
ENDSCAN 



ENDPROC
PROCEDURE migrarnits

*Arrendatario,1,Propietario,2,Tercero,3,
*Arrendatario y Propietario,4,Arrendatario y Tercero,5,
*Propietario y Tercero,6,Arrendatario Propietario y Tercero,7,Empleado,8


SET DELETED OFF 

SELECT NITS 
GO TOP 
SCAN 
	lcCadena = 'NO GR'
	lcCadena2 = 'NIT ER'

	IF ATC(lcCadena,ALLTRIM(NITS.NOMBRE))=0 AND ATC(lcCadena,ALLTRIM(NITS.APELLIDO))=0 AND  ATC("-",ALLTRIM(NITS.NIT))=0; 
	AND ATC(" ",ALLTRIM(NITS.NIT))=0 AND ATC(lcCadena2,ALLTRIM(NITS.NOMBRE))=0 AND ATC(lcCadena2,ALLTRIM(NITS.APELLIDO))=0
	
	
		lcNit = ALLTRIM(NITS.NIT)
		lcTipo_doc = NITS.TIPODOC
		lcPrimer_nombre = ALLTRIM(NITS.NOMBRE1)
		lcSegundo_nombre = ALLTRIM(NITS.NOMBRE2)
		lcPrimer_apellido = ALLTRIM(NITS.APELLIDO1)
		lcSegundo_apellido = ALLTRIM(NITS.APELLIDO2)
		lcRazon_social = ALLTRIM(NITS.RAZONSOCIAL)
		lcSexo = "M"
		
		DO CASE 
			CASE NITS.TRIBUTARIO = 1
				lnTipo_cliente = "SL"
			CASE NITS.GRANCON 
				lnTipo_cliente = "GC"	
			CASE NITS.EMPRESA 
				lnTipo_cliente = "PJ"		
			CASE !NITS.EMPRESA 
				lnTipo_cliente = "PN"	
			OTHERWISE 
				lnTipo_cliente = "PN"			
		ENDCASE 
		
		SET EXACT ON 
		IF !SEEK(lcNit,'CLIENTES',"COD_CLI")

			thisform.nombresnits(lcTipo_doc,ALLTRIM(nits.nombre),ALLTRIM(nits.apellido),ALLTRIM(NITS.RAZONSOCIAL),1)
			
			lcTelefono = ''
			ldFecha_nacimiento = {123}}
			lcEmail = ''
			lcTipo_Cor = ''
			lcVivo = 'S'
			DO CASE 
				CASE INLIST(NITS.TIPO,2,4,6,7)
					IF SEEK(lcNit,'PROPIETARIOS','CEDULA')
						lcVivo = IIF(PROPIETARIOS.ESTVIDA = 2,"N","S")
						ldFecha_nacimiento = IIF(YEAR(PROPIETARIOS.FECNAC)>1900,PROPIETARIOS.FECNAC,{123}})
						lcEmail = ALLTRIM(PROPIETARIOS.MAIL)
						
						thisform.Telefonosjson(ALLTRIM(PROPIETARIOS.TEL_RES), ALLTRIM(PROPIETARIOS.TEL_OF),ALLTRIM(PROPIETARIOS.CELULAR))
			 					
						FOR I=1 TO 4	
							lcTipo_direccion = ''
							DO CASE 
								CASE I = 1
									lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_RES)
									lcTipo_direccion = 'DIR_CLIENTE'
								CASE I = 2
									lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_OF)	
									lcTipo_direccion = 'DIR_TRABAJO'
								CASE I = 3
									lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_RESCON)	
									lcTipo_direccion = 'DIR_CONTADOR'
								CASE I = 4
									lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_RESAPO)	
									lcTipo_direccion = 'DIR_APODERADO'
							ENDCASE
													
							IF LEN(ALLTRIM(lcCadena_Direccion))>0 AND (LEN(alltrim(lcPrimer_nombre))>0 OR LEN(alltrim(lcRazon_social))>0)		
								thisform.direcciones_fjson(lcCadena_Direccion, lcTipo_direccion)
							ENDIF
							
							DO CASE 
								CASE I = 1
									lcCadena_Dir_res = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
									IF LEN(ALLTRIM(lcCadena_Dir_res))=0
										lcCadena_Dir_res = lcCadena_atipico
									ENDIF
								CASE I = 2
									lcCadena_Dir_of = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
									IF LEN(ALLTRIM(lcCadena_Dir_of))=0
										lcCadena_Dir_of =lcCadena_atipico
									ENDIF
								CASE I = 3
									lcCadena_Dir_rescon = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
									IF LEN(ALLTRIM(lcCadena_Dir_rescon))=0
										lcCadena_Dir_rescon =lcCadena_atipico
									ENDIF
								CASE I = 4
									lcCadena_Dir_resapo = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
									IF LEN(ALLTRIM(lcCadena_Dir_resapo))=0
										lcCadena_Dir_resapo =lcCadena_atipico
									ENDIF
							ENDCASE
						NEXT  
					
						**REGIMEN 
						*lnRegimen = IIF(PROPIETARIOS.REGCOMUN,1,PROPIETARIOS.REGIMEN)
						DO CASE 
							CASE PROPIETARIOS.TRIBUTARIO = 1
								lnRegimen = "SA"	
							CASE PROPIETARIOS.REGCOMUN 
								lnRegimen = "RC"		
							CASE PROPIETARIOS.REGIMEN = 1
								lnRegimen = "RC"		
							CASE PROPIETARIOS.REGIMEN = 2
								lnRegimen = "RS"		
							CASE PROPIETARIOS.REGIMEN = 3	
								lnRegimen = "SR"
						ENDCASE 
						lcRteica = IIF(PROPIETARIOS.RET_ICA,"S","N")
						lcAutoret = IIF(PROPIETARIOS.AUTORET,"S","N")
						lcReteiva = IIF(PROPIETARIOS.RET_IVA,"S","N")
						lcObservaciones1 = STRTRAN(ALLTRIM(PROPIETARIOS.OBSERVACIONES),chr(13)+chr(10),"/")
						lcobservaciones2 = STRTRAN(lcobservaciones1,",","/")
						lcobservaciones3 = STRTRAN(lcobservaciones2,"'","/")
						lcobservaciones4 = STRTRAN(lcobservaciones3,"|","/")
						lcObservaciones = ALLTRIM(lcobservaciones4)
						lcDeclara_renta = IIF(PROPIETARIOS.TRIBUTARIO = 2,"S","N")
						lcBloqueado = IIF(PROPIETARIOS.FORMA_PAGO = 4 AND PROPIETARIOS.TIPO_PAGO <3,"S","N")
						
						IF PROPIETARIOS.ENVIO_CORREO=1
							lcDir_cor = lcCadena_Dir_res
							lnIdBarrio_cor = ALLTRIM(STR(PROPIETARIOS.IDBARRIO))
						ELSE 
							IF PROPIETARIOS.ENVIO_CORREO=2
								lcDir_cor = lcCadena_Dir_of
								lnIdBarrio_cor = ALLTRIM(STR(PROPIETARIOS.IDBARRIO_OF))
							ELSE 
								lcDir_cor = lcCadena_Dir_res	
								lnIdBarrio_cor = ALLTRIM(STR(PROPIETARIOS.IDBARRIO))
							ENDIF 
						ENDIF 
						
						*Tipo de envio de correspondencia (EMA-email, FIS-fsico, EMF-email/fsico)
						IF PROPIETARIOS.ENVIO_CORREO = 4
							lcTipo_Cor = "EMA"
						ELSE
							lcTipo_Cor = "FIS"
						ENDIF 
						
						lnidCiudad_res = PROPIETARIOS.IDCIUDAD_RES
						lnidCiudad_of = PROPIETARIOS.IDCIUDAD_OF
						
						lnIdBarrio_res = ALLTRIM(STR(PROPIETARIOS.IDBARRIO))
						lnIdBarrio_of = ALLTRIM(STR(PROPIETARIOS.IDBARRIO_OF))
						
					ENDIF
						
				CASE INLIST(NITS.TIPO,1,5)
					
					IF SEEK(lcNit,'ARRENDATARIOS','NIT')
						ldFecha_nacimiento = IIF(YEAR(ARRENDATARIOS.FECNAC)>1900,ARRENDATARIOS.FECNAC,{123}})
						lcEmail = ALLTRIM(ARRENDATARIOS.EMAIL)
						
						thisform.Telefonosjson(ALLTRIM(ARRENDATARIOS.TEL_RES), ALLTRIM(ARRENDATARIOS.TEL_EMP), ALLTRIM(ARRENDATARIOS.CELULAR))
			 					
						FOR I=1 TO 3
							lcTipo_direccion = ''	
							DO CASE 
								CASE I = 1
									lcCadena_Direccion = ALLTRIM(ARRENDATARIOS.DIR_RES)
									lcTipo_direccion = "DIR_CLIENTE"
								CASE I = 2
									lcCadena_Direccion = ALLTRIM(ARRENDATARIOS.DIR_EMP)	
									lcTipo_direccion = 'DIR_TRABAJO'
								CASE I = 3
									lcCadena_Direccion = ALLTRIM(ARRENDATARIOS.DIR_OTR)	
									lcTipo_direccion = 'DIR_OTRO'
							ENDCASE
							
							lcCadena_atipico = ""
							lcViaPPal=""
							lcEjevial1=""
							lcEjevial2=""
							lcEjevial3=""
							lcCompl1=""
							lcCompl2=""
							lcCompl3=""
							lcCompl4=""
							lcCompl5="" 
							lcCompl6="" 
							lcCompl7="" 
							lcCompl8="" 
							lnViaPPal = 0
							lnCompl1 = 0
							lnCompl3 = 0
							lnCompl5 = 0
							lcCadena_fjson = "" 								
							IF LEN(ALLTRIM(lcCadena_Direccion))>0 AND (LEN(alltrim(lcPrimer_nombre))>0 OR LEN(alltrim(lcRazon_social))>0)		
								thisform.direcciones_fjson(lcCadena_Direccion, lcTipo_direccion)
							ENDIF
							
							DO CASE 
								CASE I = 1
									lcCadena_Dir_res = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
									IF LEN(ALLTRIM(lcCadena_Dir_res))=0
										lcCadena_Dir_res=lcCadena_atipico
									ENDIF
								CASE I = 2
									lcCadena_Dir_of = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
									IF LEN(ALLTRIM(lcCadena_Dir_of))=0
										lcCadena_Dir_of =lcCadena_atipico
									ENDIF
								CASE I = 3
									lcCadena_Dir_rescon = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
									IF LEN(ALLTRIM(lcCadena_Dir_rescon))=0
										lcCadena_Dir_rescon =lcCadena_atipico
									ENDIF
							ENDCASE
						NEXT  
					
						**REGIMEN 
						*lnRegimen = ARRENDATARIOS.REGIMEN
						DO CASE 
							CASE ARRENDATARIOS.TRIBUTARIO = 1
								lnRegimen = "SA"	
							CASE ARRENDATARIOS.REGIMEN = 1
								lnRegimen = "RC"		
							CASE ARRENDATARIOS.REGIMEN = 2
								lnRegimen = "RS"		
							CASE ARRENDATARIOS.REGIMEN = 3	
								lnRegimen = "SR"
						ENDCASE
						lcRteica = IIF(ARRENDATARIOS.RET_ICA,"S","N")
						lcAutoret = IIF(ARRENDATARIOS.AUTORET,"S","N")
						lcReteiva = IIF(ARRENDATARIOS.RET_IVA,"S","N")
						lcObservaciones1 = STRTRAN(ALLTRIM(ARRENDATARIOS.OBSERVACIONES),chr(13)+chr(10),"/")
						lcobservaciones2 = STRTRAN(lcobservaciones1,",","/")
						lcobservaciones3 = STRTRAN(lcobservaciones2,"'","/")
						lcobservaciones4 = STRTRAN(lcobservaciones3,"|","/")
						lcObservaciones = ALLTRIM(lcobservaciones4)
						lcDeclara_renta = IIF(ARRENDATARIOS.TRIBUTARIO = 2,"S","N")
						lcBloqueado = "N"
						
						IF ARRENDATARIOS.ENVIO_CORREO=1
							lcDir_cor = lcCadena_Dir_res
							lnIdBarrio_cor = ALLTRIM(STR(ARRENDATARIOS.IDBARRIO_R))
						ELSE 
							IF ARRENDATARIOS.ENVIO_CORREO=2
								lcDir_cor = lcCadena_Dir_of
								lnIdBarrio_cor = ALLTRIM(STR(ARRENDATARIOS.IDBARRIO_E))
							ELSE 
								lcDir_cor = lcCadena_Dir_res	
								lnIdBarrio_cor = ALLTRIM(STR(ARRENDATARIOS.IDBARRIO_R))
							ENDIF 
						ENDIF 
						
						*Tipo de envio de correspondencia (EMA-email, FIS-fsico, EMF-email/fsico)
						IF ARRENDATARIOS.ENVIO_CORREO = 4
							lcTipo_Cor = "EMA"
						ELSE
							lcTipo_Cor = "FIS"
						ENDIF 
												
						lnidCiudad_res = ARRENDATARIOS.IDCIUDAD_R
						lnidCiudad_of = PROPIETARIOS.IDCIUDAD_OF
						
						lnIdBarrio_res = ALLTRIM(STR(ARRENDATARIOS.IDBARRIO_R))
						lnIdBarrio_of = ALLTRIM(STR(ARRENDATARIOS.IDBARRIO_E))
						
					ENDIF 
				
				OTHERWISE 
					**TERCEROS 
					lcEmail = ALLTRIM(NITS.EMAIL)
					
					thisform.Telefonosjson(ALLTRIM(NITS.TELEFONO), "", ALLTRIM(NITS.CELULAR))
		 					
					lcCadena_Direccion = ALLTRIM(NITS.DIRECCION)
					lcTipo_direccion = 'DIR_CLIENTE'
					
					lcCadena_atipico = ""
					lcViaPPal=""
					lcEjevial1=""
					lcEjevial2=""
					lcEjevial3=""
					lcCompl1=""
					lcCompl2=""
					lcCompl3=""
					lcCompl4=""
					lcCompl5="" 
					lcCompl6="" 
					lcCompl7="" 
					lcCompl8="" 
					lnViaPPal = 0
					lnCompl1 = 0
					lnCompl3 = 0
					lnCompl5 = 0
					lcCadena_fjson = "" 					
					IF LEN(ALLTRIM(lcCadena_Direccion))>0 AND (LEN(alltrim(lcPrimer_nombre))>0 OR LEN(alltrim(lcRazon_social))>0)		
						thisform.direcciones_fjson(lcCadena_Direccion, lcTipo_direccion)
					ENDIF
					
					lcCadena_Dir_res = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
					IF LEN(ALLTRIM(lcCadena_Dir_res))=0
						lcCadena_Dir_res=lcCadena_atipico
					ENDIF  
					
					*Tipo de envio de correspondencia (EMA-email, FIS-fsico, EMF-email/fsico)
					IF LEN(ALLTRIM(NITS.EMAIL))>0
						lcTipo_Cor = "EMF"
					ELSE
						lcTipo_Cor = "FIS"
					ENDIF 
					
					**REGIMEN 
					DO CASE 
						CASE NITS.TRIBUTARIO = 1
							lnRegimen = "SA"
						CASE NITS.REGIMEN = 1
							lnRegimen = "RC"
						CASE NITS.REGIMEN = 2
							lnRegimen = "RS"	
						CASE NITS.REGIMEN = 3
							lnRegimen = "SR"
						OTHERWISE 
							lnRegimen = "SR"	
					ENDCASE 
								
					lcRteica = IIF(NITS.RET_ICA,"S","N")
					lcAutoret = IIF(NITS.AUTORET,"S","N")
					lcReteiva = "N"
					lcObservaciones1 = STRTRAN(ALLTRIM(NITS.OBSERVACIONES),chr(13)+chr(10),"/")
					lcobservaciones2 = STRTRAN(lcobservaciones1,",","/")
					lcobservaciones3 = STRTRAN(lcobservaciones2,"'","/")
					lcobservaciones4 = STRTRAN(lcobservaciones3,"|","/")
					lcObservaciones = ALLTRIM(lcobservaciones4)
					lcDeclara_renta = IIF(NITS.TRIBUTARIO = 2,"S","N")
					lcBloqueado = "N"
					
					lcDir_cor = lcCadena_Dir_res
					lnIdBarrio_cor = "0"
					
					lnidCiudad_res = NITS.IDCIUDAD
					lnidCiudad_of = PROPIETARIOS.IDCIUDAD_OF
					
					lnIdBarrio_res = "0"
					lnIdBarrio_of = "0"
			ENDCASE
			
			lcCod_ciudad = '68001'	
			IF SEEK(lnidCiudad_res,"CIUDADES","IDCIUDAD")
				lcCiudad = ALLTRIM(CIUDADES.CIUDAD)
				IF SEEK(lcCiudad,"CIUDAD","CIUDAD")
					lcCod_ciudad = ALLTRIM(CIUDAD.COD_CIUDAD)
				ENDIF 
			ENDIF 
			
			lcCod_ciudadOF = '68001'	
			IF SEEK(lnidCiudad_of,"CIUDADES","IDCIUDAD")
				lcCiudad = ALLTRIM(CIUDADES.CIUDAD)
				IF SEEK(lcCiudad,"CIUDAD","CIUDAD")
					lcCod_ciudadOF = ALLTRIM(CIUDAD.COD_CIUDAD)
				ENDIF 
			ENDIF
						
			IF SEEK(lnIdBarrio_res,"BARRIO",'CODIGO')
				IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
					REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
				ENDIF
			ENDIF 
			
			IF SEEK(lnIdBarrio_of,"BARRIO",'CODIGO')
				IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
					REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
				ENDIF
			ENDIF 
			
			lcDv = ""
			IF ALLTRIM(lcTipo_doc)=="31"
				lcDv = thisform.digito_ver(lcNit) 
			ENDIF 
			
			IF  LEN(alltrim(lcPrimer_nombre))>0 OR LEN(alltrim(lcRazon_social))>0											
				SELECT CLIENTES 
				APPEND BLANK
				REPLACE;
				COD_CLIENTE WITH lcNit,;
				COD_CIUDAD_DOCUMENTO WITH lcCod_ciudad,; 				
				PRIMER_NOMBRE WITH IIF(LEN(ALLTRIM(lcPrimer_nombre))>0,lcPrimer_nombre,lcRazon_social) ,;
				SEGUNDO_NOMBRE WITH lcSegundo_nombre,;
				PRIMER_APELLIDO WITH lcPrimer_apellido,;
				SEGUNDO_APELLIDO WITH lcSegundo_apellido,;
				COD_TIPO_REGIMEN WITH ALLTRIM(lnRegimen),;	
	 			COD_TIPO_CLIENTE WITH ALLTRIM(lnTipo_cliente),;
	 			COD_TIPO_DOCUMENTO WITH lcTipo_doc,;
	 			SEQ_PROFESION WITH "1",;
	 			FECHA_NACIMIENTO WITH ldFecha_nacimiento,;
				SEXO WITH lcSexo,;	
				DIR_CLIENTE WITH lcCadena_Dir_res,; 
				DIR_TRABAJO WITH lcCadena_Dir_of,;
				TEL_CLIENTE WITH lcTelefono ,;
				COD_CIUDAD_CLIENTE WITH lcCod_ciudad,;
				EMAIL WITH lcEmail,; 
	 			RETIENE_SOBRE_ICA WITH lcRteica,;	
	 			RESPONSABLE_IVA WITH IIF(lnRegimen="RC","S","N"),;
				AGENTE_RETENEDOR WITH IIF(NITS.RETENCION,"S","N"),; 
		 		RETIENE_SOBRE_IVA WITH lcReteiva,;
	 			IMPUESTO_INDUSTRIA WITH "N",;
	 			OBS_CLIENTE WITH lcObservaciones,;
	 			COD_CREE WITH "";		
	 			DECLARA_RENTA WITH lcDeclara_renta,;
	 			DV_CLIENTE WITH lcDv,;
	 			DIRECCION_DIAN WITH lcCadena_Dir_res,;
	 			AUTORETENEDOR WITH lcAutoret,;
	 			NO_IVA_ARRIENDO WITH "N",;
	 			COD_CIUDAD_DIAN WITH lcCod_ciudad,;
	 			DIR_ENVIO_CORRESPONDENCIA WITH lcDir_cor,;
	 			TIPO_ENVIO_CORRESPONDENCIA WITH lcTipo_Cor,;
	 			BLOQUEAR_PAGO WITH lcBloqueado,;
	 			COD_BARRIO_CLIENTE WITH lnIdBarrio_res,;	
				COD_BARRIO_DIAN WITH lnIdBarrio_res,;	
				COD_BARRIO_CORRESPONDENCIA WITH lnIdBarrio_cor,;	
				VIVO WITH lcVivo,; 
				COD_BARRIO_DIR_TRABAJO WITH lnIdBarrio_OF,;
				COD_CIUDAD_DIR_TRABAJO WITH lcCod_ciudadOF; &&OJO CON ESTE
	 			IN CLIENTES
 			ENDIF 	
		ENDIF 
		SET EXACT OFF
	ENDIF 	
ENDSCAN 

SELECT FIADORES
GO TOP
SCAN 
	IF NITS.EMPRESA 
		lnTipo_cliente = "PJ"		
	ELSE 
		lnTipo_cliente = "PN"	
	ENDIF 

	SET EXACT ON 
	IF !SEEK(lcNit,'CLIENTES',"COD_CLI")
		
		IF ALLTRIM(FIADORES.NIT)=='2046115' OR ALLTRIM(FIADORES.NIT)=="2081002" OR ALLTRIM(FIADORES.NIT)=="2022005"; 
		OR ALLTRIM(lcNit)=="2035892" OR ALLTRIM(lcNit)=="108651"
			*SET STEP ON 
		ENDIF 

		lcTipo_doc = ""
		lcSexo = "M"
		lcPrimer_nombre = ""
		lcSegundo_nombre = ""
		lcPrimer_apellido = ""
		lcSegundo_apellido = ""
		lcRazon_social  = ""
		thisform.nombresnits(lcTipo_doc,ALLTRIM(fiadores.nombre),ALLTRIM(fiadores.apellido),"",2)	
			
		lcTelefono = ''
		ldFecha_nacimiento = {123}}
		lcEmail = ALLTRIM(FIADORES.EMAIL)
		
		*Tipo de envio de correspondencia (EMA-email, FIS-fsico, EMF-email/fsico)
		IF LEN(ALLTRIM(FIADORES.EMAIL))>0
			lcTipo_Cor = "EMF"
		ELSE
			lcTipo_Cor = "FIS"
		ENDIF 
		
		thisform.Telefonosjson(ALLTRIM(FIADORES.TEL_RES), ALLTRIM(FIADORES.TEL_EMP),ALLTRIM(FIADORES.CELULAR))
	 					
		FOR I=1 TO 2	
			DO CASE 
				CASE I = 1
					lcCadena_Direccion = ALLTRIM(FIADORES.DIR_RES)
					lcTipo_direccion = "DIR_CLIENTE"
				CASE I = 2
					lcCadena_Direccion = ALLTRIM(FIADORES.DIR_EMP)	
					lcTipo_direccion = "DIR_TRABAJO"
			ENDCASE
			 		
			lcCadena_atipico = ""
			lcViaPPal=""
			lcEjevial1=""
			lcEjevial2=""
			lcEjevial3=""
			lcCompl1=""
			lcCompl2=""
			lcCompl3=""
			lcCompl4=""
			lcCompl5="" 
			lcCompl6="" 
			lcCompl7="" 
			lcCompl8="" 
			lnViaPPal = 0
			lnCompl1 = 0
			lnCompl3 = 0
			lnCompl5 = 0
			lcCadena_fjson = "" 		
			IF LEN(ALLTRIM(lcCadena_Direccion))>0
				thisform.direcciones_fjson(lcCadena_Direccion, lcTipo_direccion)
			ENDIF
			
			DO CASE 
				CASE I = 1
					lcCadena_Dir_res = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6+" "+lcCadena_atipico
				CASE I = 2
					lcCadena_Dir_of = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6+" "+lcCadena_atipico
			ENDCASE
		NEXT  

		**REGIMEN 
		lnRegimen = "SR"
		lcRteica = "N"
		lcAutoret = "N"
		lcReteiva = "N"
		lcObservaciones1 = STRTRAN(ALLTRIM(FIADORES.OBSERVACIONES),chr(13)+chr(10),"/")
		lcobservaciones2 = STRTRAN(lcobservaciones1,",","/")
		lcobservaciones3 = STRTRAN(lcobservaciones2,"'","/")
		lcobservaciones4 = STRTRAN(lcobservaciones3,"|","/")
		lcObservaciones = ALLTRIM(lcobservaciones4)
		lcDeclara_renta = "N"
		lcBloqueado = "N"
		
		IF FIADORES.ENVIO_CORREO=1
			lcDir_cor = lcCadena_Dir_res
			lnIdBarrio_cor = "0"
		ELSE 
			IF FIADORES.ENVIO_CORREO=2
				lcDir_cor = lcCadena_Dir_of
				lnIdBarrio_cor = "0"
			ELSE 
				lcDir_cor = lcCadena_Dir_res	
				lnIdBarrio_cor = "0"
			ENDIF 
		ENDIF 
		
		lnidCiudad_res = FIADORES.IDCIUDAD_RES
		lnidCiudad_of = FIADORES.IDCIUDAD_EMP
		
		lnIdBarrio_res = "0"
		lnIdBarrio_of = "0"
		
		lcCod_ciudad = '68001'	
		IF SEEK(lnidCiudad_res,"CIUDADES","IDCIUDAD")
			lcCiudad = ALLTRIM(CIUDADES.CIUDAD)
			IF SEEK(lcCiudad,"CIUDAD","CIUDAD")
				lcCod_ciudad = ALLTRIM(CIUDAD.COD_CIUDAD)
			ENDIF 
		ENDIF 
		
		lcCod_ciudadOF = '68001'	
		IF SEEK(lnidCiudad_of,"CIUDADES","IDCIUDAD")
			lcCiudad = ALLTRIM(CIUDADES.CIUDAD)
			IF SEEK(lcCiudad,"CIUDAD","CIUDAD")
				lcCod_ciudadOF = ALLTRIM(CIUDAD.COD_CIUDAD)
			ENDIF 
		ENDIF
		
		IF SEEK(lnIdBarrio_res,"BARRIO",'CODIGO')
			IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
				REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
			ENDIF
		ENDIF 
		
		IF SEEK(lnIdBarrio_of,"BARRIO",'CODIGO')
			IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
				REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
			ENDIF
		ENDIF 
		
		lcDv = ""
		IF ALLTRIM(lcTipo_doc)=="31"
			lcDv = thisform.digito_ver(lcNit) 
		ENDIF 
		 											
		SELECT CLIENTES 
		APPEND BLANK
		REPLACE;
		COD_CLIENTE WITH lcNit,;
		PRIMER_NOMBRE WITH IIF(LEN(ALLTRIM(lcPrimer_nombre))>0,lcPrimer_nombre,lcRazon_social) ,;
		SEGUNDO_NOMBRE WITH lcSegundo_nombre,;
		PRIMER_APELLIDO WITH lcPrimer_apellido,;
		SEGUNDO_APELLIDO WITH lcSegundo_apellido,;
		FECHA_NACIMIENTO WITH ldFecha_nacimiento,;
		DIR_CLIENTE WITH lcCadena_Dir_res,; 
		DIR_TRABAJO WITH lcCadena_Dir_of,;
		TEL_CLIENTE WITH lcTelefono ,;
		EMAIL WITH lcEmail,; 
 		COD_TIPO_REGIMEN WITH ALLTRIM(lnRegimen),;	
 		COD_TIPO_CLIENTE WITH ALLTRIM(lnTipo_cliente),;
 		COD_TIPO_DOCUMENTO WITH lcTipo_doc,;
 		RETIENE_SOBRE_ICA WITH lcRteica,;	
 		RETIENE_SOBRE_IVA WITH lcReteiva,;
 		OBS_CLIENTE WITH lcObservaciones,;
 		DECLARA_RENTA WITH lcDeclara_renta,;
 		DIRECCION_DIAN WITH lcCadena_Dir_res,;
 		AUTORETENEDOR WITH lcAutoret,;
 		DIR_ENVIO_CORRESPONDENCIA WITH lcDir_cor,;
 		BLOQUEAR_PAGO WITH lcBloqueado,;
 		COD_CIUDAD_CLIENTE WITH lcCod_ciudad,;
 		COD_CIUDAD_DIAN WITH lcCod_ciudad,;
		COD_BARRIO_CLIENTE WITH lnIdBarrio_res,;	
		COD_BARRIO_DIAN WITH lnIdBarrio_res,;	
		COD_BARRIO_CORRESPONDENCIA WITH lnIdBarrio_cor,;	
		COD_BARRIO_DIR_TRABAJO WITH lnIdBarrio_OF,;
		DV_CLIENTE WITH lcDv,;
		TIPO_ENVIO_CORRESPONDENCIA WITH lcTipo_Cor;		
		SEQ_PROFESION WITH "1",;
		SEXO WITH lcSexo,;	
		COD_CIUDAD_DOCUMENTO WITH lcCod_ciudad,; 
		RESPONSABLE_IVA WITH IIF(lnRegimen="RC","S","N"),;
 		NO_IVA_ARRIENDO WITH "N",;
		IMPUESTO_INDUSTRIA WITH "N",;
		COD_CREE WITH "",;
		COD_CIUDAD_DIR_TRABAJO WITH lcCod_ciudadOF,; 
		VIVO WITH lcVivo,; 
		AGENTE_RETENEDOR WITH "N"; 
 		IN CLIENTES
	ENDIF
	SET EXACT OFF
ENDSCAN 

SELECT XPROMOTOR
GO TOP 
SCAN 
	lcNit = ALLTRIM(XPROMOTOR.CEDULA)
	lnTipo_cliente = "PN"
	lcTipo_doc = "13"
	
	SET EXACT ON 
	IF !SEEK(ALLTRIM(XPROMOTOR.CEDULA),"CLIENTES","COD_CLI")
		
		lcTipo_doc = ""
		lcSexo = "M"
		lcPrimer_nombre = ""
		lcSegundo_nombre = ""
		lcPrimer_apellido = ""
		lcSegundo_apellido = ""
		lcRazon_social  = ""
		thisform.nombresnits(lcTipo_doc,ALLTRIM(xpromotor.nombre),ALLTRIM(xpromotor.apellido),"",3)	
			
		lcTelefono = ''
		ldFecha_nacimiento = {123}}
		lcEmail = ALLTRIM(xpromotor.EMAIL)
		
		*Tipo de envio de correspondencia (EMA-email, FIS-fsico, EMF-email/fsico)
		lcTipo_Cor = "FIS"
				
		thisform.Telefonosjson(ALLTRIM(XPROMOTOR.TELFONO),"", ALLTRIM(XPROMOTOR.CELULAR))
	 					
		lcCadena_Direccion = ALLTRIM(XPROMOTOR.DIRECCION)
		lcTipo_direccion = "DIR_CLIENTE"
		
		lcCadena_atipico = ""
		lcViaPPal=""
		lcEjevial1=""
		lcEjevial2=""
		lcEjevial3=""
		lcCompl1=""
		lcCompl2=""
		lcCompl3=""
		lcCompl4=""
		lcCompl5="" 
		lcCompl6="" 
		lcCompl7="" 
		lcCompl8="" 
		lnViaPPal = 0
		lnCompl1 = 0
		lnCompl3 = 0
		lnCompl5 = 0
		lcCadena_fjson = "" 
								
		IF LEN(ALLTRIM(lcCadena_Direccion))>0
			thisform.direcciones_fjson(lcCadena_Direccion, lcTipo_direccion)
		ENDIF
		
		lcCadena_Dir_res = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6+" "+lcCadena_atipico
  		lcCadena_Dir_of = ""

		**REGIMEN 
		lnRegimen = "SR"
		lcRteica = "N"
		lcAutoret = "N"
		lcReteiva = "N"
		lcObservaciones = ""
		lcDeclara_renta = "N"
		lcBloqueado = "N"
		lcVivo = "S"
		
		lcDir_cor = lcCadena_Dir_res
		lnIdBarrio_cor = "0"
			
		lnidCiudad_res = 0

		lnIdBarrio_res = "0"
		lnIdBarrio_of = "0"
		
		lcCod_ciudad = '68001'	
		IF SEEK(lnidCiudad_res,"CIUDADES","IDCIUDAD")
			lcCiudad = ALLTRIM(CIUDADES.CIUDAD)
			IF SEEK(lcCiudad,"CIUDAD","CIUDAD")
				lcCod_ciudad = ALLTRIM(CIUDAD.COD_CIUDAD)
			ENDIF 
		ENDIF 
		
		IF SEEK(lnIdBarrio_res,"BARRIO",'CODIGO')
			IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
				REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
			ENDIF
		ENDIF 
		
		IF SEEK(lnIdBarrio_of,"BARRIO",'CODIGO')
			IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
				REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
			ENDIF
		ENDIF 
		
		lcDv = ""
		IF ALLTRIM(lcTipo_doc)=="31"
			lcDv = thisform.digito_ver(lcNit) 
		ENDIF 
		 											
		SELECT CLIENTES 
		APPEND BLANK
		REPLACE;
		COD_CLIENTE WITH lcNit,;
		PRIMER_NOMBRE WITH IIF(LEN(ALLTRIM(lcPrimer_nombre))>0,lcPrimer_nombre,lcRazon_social) ,;
		SEGUNDO_NOMBRE WITH lcSegundo_nombre,;
		PRIMER_APELLIDO WITH lcPrimer_apellido,;
		SEGUNDO_APELLIDO WITH lcSegundo_apellido,;
		FECHA_NACIMIENTO WITH ldFecha_nacimiento,;
		DIR_CLIENTE WITH lcCadena_Dir_res,; 
		DIR_TRABAJO WITH lcCadena_Dir_of,;
		TEL_CLIENTE WITH lcTelefono ,;
		EMAIL WITH lcEmail,; 
 		COD_TIPO_REGIMEN WITH ALLTRIM(lnRegimen),;	
 		COD_TIPO_CLIENTE WITH ALLTRIM(lnTipo_cliente),;
 		COD_TIPO_DOCUMENTO WITH lcTipo_doc,;
 		RETIENE_SOBRE_ICA WITH lcRteica,;	
 		RETIENE_SOBRE_IVA WITH lcReteiva,;
 		OBS_CLIENTE WITH lcObservaciones,;
 		DECLARA_RENTA WITH lcDeclara_renta,;
 		DIRECCION_DIAN WITH lcCadena_Dir_res,;
 		AUTORETENEDOR WITH lcAutoret,;
 		DIR_ENVIO_CORRESPONDENCIA WITH lcDir_cor,;
 		BLOQUEAR_PAGO WITH lcBloqueado,;
 		COD_CIUDAD_CLIENTE WITH lcCod_ciudad,;
 		COD_CIUDAD_DIAN WITH lcCod_ciudad,;
		COD_BARRIO_CLIENTE WITH lnIdBarrio_res,;	
		COD_BARRIO_DIAN WITH lnIdBarrio_res,;	
		COD_BARRIO_CORRESPONDENCIA WITH lnIdBarrio_cor,;	
		COD_BARRIO_DIR_TRABAJO WITH lnIdBarrio_OF,;
		DV_CLIENTE WITH lcDv,;
		TIPO_ENVIO_CORRESPONDENCIA WITH lcTipo_Cor;		
		SEQ_PROFESION WITH "1",;
		SEXO WITH lcSexo,;	
		COD_CIUDAD_DOCUMENTO WITH lcCod_ciudad,; 
		RESPONSABLE_IVA WITH IIF(lnRegimen="RC","S","N"),;
 		NO_IVA_ARRIENDO WITH "N",;
		IMPUESTO_INDUSTRIA WITH "N",;
		COD_CREE WITH "",;
		COD_CIUDAD_DIR_TRABAJO WITH lcCod_ciudad,; 
		VIVO WITH lcVivo,; 
		AGENTE_RETENEDOR WITH "N"; 
 		IN CLIENTES		
	ENDIF 
	SET EXACT OFF 
ENDSCAN 

SELECT XABOGADOS
GO TOP 
SCAN 
	lcNit = ALLTRIM(XABOGADOS.CEDULA)
	lnTipo_cliente = "PN"
	lcTipo_doc = "13"
	
	SET EXACT ON 
	IF !SEEK(ALLTRIM(XABOGADOS.CEDULA),"CLIENTES","COD_CLI")
		
		lcTipo_doc = "13"
		lcSexo = "M"
		lcPrimer_nombre = ""
		lcSegundo_nombre = ""
		lcPrimer_apellido = ""
		lcSegundo_apellido = ""
		lcRazon_social  = ""
		thisform.nombrescompletos(ALLTRIM(xabogados.nombre),1)	
			
		lcTelefono = ''
		ldFecha_nacimiento = {123}}
		lcEmail = ALLTRIM(XABOGADOS.EMAIL)
		
		*Tipo de envio de correspondencia (EMA-email, FIS-fsico, EMF-email/fsico)
		lcTipo_Cor = "FIS"
				
		thisform.Telefonosjson(ALLTRIM(XABOGADOS.TELEFONO),"", ALLTRIM(XABOGADOS.CELULAR))
	 					
		lcCadena_Direccion = ALLTRIM(XABOGADOS.DIRECCION)
		lcTipo_direccion = "DIR_CLIENTE"
		
		lcCadena_atipico = ""
		lcViaPPal=""
		lcEjevial1=""
		lcEjevial2=""
		lcEjevial3=""
		lcCompl1=""
		lcCompl2=""
		lcCompl3=""
		lcCompl4=""
		lcCompl5="" 
		lcCompl6="" 
		lcCompl7="" 
		lcCompl8="" 
		lnViaPPal = 0
		lnCompl1 = 0
		lnCompl3 = 0
		lnCompl5 = 0
		lcCadena_fjson = "" 		
		IF LEN(ALLTRIM(lcCadena_Direccion))>0
			thisform.direcciones_fjson(lcCadena_Direccion, lcTipo_direccion)
		ENDIF
		
		lcCadena_Dir_res = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6+" "+lcCadena_atipico
  		lcCadena_Dir_of = ""

		**REGIMEN 
		lnRegimen = "SR"
		lcRteica = "N"
		lcAutoret = "N"
		lcReteiva = "N"
		lcObservaciones = ""
		lcDeclara_renta = "N"
		lcBloqueado = "N"
		lcVivo = "S"
		lcDir_cor = lcCadena_Dir_res
		lnIdBarrio_cor = "0"
			
		lnidCiudad_res = 0

		lnIdBarrio_res = "0"
		lnIdBarrio_of = "0"
		
		lcCod_ciudad = '68001'	
		IF SEEK(lnidCiudad_res,"CIUDADES","IDCIUDAD")
			lcCiudad = ALLTRIM(CIUDADES.CIUDAD)
			IF SEEK(lcCiudad,"CIUDAD","CIUDAD")
				lcCod_ciudad = ALLTRIM(CIUDAD.COD_CIUDAD)
			ENDIF 
		ENDIF 
		
		IF SEEK(lnIdBarrio_res,"BARRIO",'CODIGO')
			IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
				REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
			ENDIF
		ENDIF 
		
		IF SEEK(lnIdBarrio_of,"BARRIO",'CODIGO')
			IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
				REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
			ENDIF
		ENDIF 
		
		lcDv = ""
		IF ALLTRIM(lcTipo_doc)=="31"
			lcDv = thisform.digito_ver(lcNit) 
		ENDIF 
		 											
		SELECT CLIENTES 
		APPEND BLANK
		REPLACE;
		COD_CLIENTE WITH lcNit,;
		PRIMER_NOMBRE WITH IIF(LEN(ALLTRIM(lcPrimer_nombre))>0,lcPrimer_nombre,lcRazon_social) ,;
		SEGUNDO_NOMBRE WITH lcSegundo_nombre,;
		PRIMER_APELLIDO WITH lcPrimer_apellido,;
		SEGUNDO_APELLIDO WITH lcSegundo_apellido,;
		FECHA_NACIMIENTO WITH ldFecha_nacimiento,;
		DIR_CLIENTE WITH lcCadena_Dir_res,; 
		DIR_TRABAJO WITH lcCadena_Dir_of,;
		TEL_CLIENTE WITH lcTelefono ,;
		EMAIL WITH lcEmail,; 
 		COD_TIPO_REGIMEN WITH ALLTRIM(lnRegimen),;	
 		COD_TIPO_CLIENTE WITH ALLTRIM(lnTipo_cliente),;
 		COD_TIPO_DOCUMENTO WITH lcTipo_doc,;
 		RETIENE_SOBRE_ICA WITH lcRteica,;	
 		RETIENE_SOBRE_IVA WITH lcReteiva,;
 		OBS_CLIENTE WITH lcObservaciones,;
 		DECLARA_RENTA WITH lcDeclara_renta,;
 		DIRECCION_DIAN WITH lcCadena_Dir_res,;
 		AUTORETENEDOR WITH lcAutoret,;
 		DIR_ENVIO_CORRESPONDENCIA WITH lcDir_cor,;
 		BLOQUEAR_PAGO WITH lcBloqueado,;
 		COD_CIUDAD_CLIENTE WITH lcCod_ciudad,;
 		COD_CIUDAD_DIAN WITH lcCod_ciudad,;
		COD_BARRIO_CLIENTE WITH lnIdBarrio_res,;	
		COD_BARRIO_DIAN WITH lnIdBarrio_res,;	
		COD_BARRIO_CORRESPONDENCIA WITH lnIdBarrio_cor,;	
		COD_BARRIO_DIR_TRABAJO WITH lnIdBarrio_OF,;
		DV_CLIENTE WITH lcDv,;
		TIPO_ENVIO_CORRESPONDENCIA WITH lcTipo_Cor;		
		SEQ_PROFESION WITH "1",;
		SEXO WITH lcSexo,;	
		COD_CIUDAD_DOCUMENTO WITH lcCod_ciudad,; 
		RESPONSABLE_IVA WITH IIF(lnRegimen="RC","S","N"),;
 		NO_IVA_ARRIENDO WITH "N",;
		IMPUESTO_INDUSTRIA WITH "N",;
		COD_CREE WITH "",;
		COD_CIUDAD_DIR_TRABAJO WITH lcCod_ciudad,; 
		VIVO WITH lcVivo,; 
		AGENTE_RETENEDOR WITH "N"; 	
 		IN CLIENTES		
	ENDIF 
	SET EXACT OFF 
ENDSCAN 

*NIT,01,CEDULA DE CIUDADANIA,02,TARJETA DE IDENTIDAD,03,CEDULA DE EXTRANJERIA,04,PASAPORTE,05,TARJETA SEGURO SOCIAL,06,NIT MENOR,07
*11.Registro civil,11,12. Tarjeta de Identidad,12,13. Cdula de Ciudadania,13,21. Tarjeta de Extranjera,21,22. Cdula de Extranjera,22,31. Nit,31,41. Pasaporte,41
SELECT PROPIETARIOS 
GO TOP 
SCAN FOR PROPIETARIOS.TIPO_PAGO = 1
	*lnTipo_cliente = "PN"
	
	DO CASE 
		CASE PROPIETARIOS.TRIBUTARIO  = 1
			lnTipo_cliente = "SL"
		CASE NITS.EMPRESA 
			lnTipo_cliente = "PJ"		
		CASE !NITS.EMPRESA 
			lnTipo_cliente = "PN"	
		OTHERWISE 
			lnTipo_cliente = "PN"			
	ENDCASE
	
	lcTipo_doc = "13"
	DO CASE 
		CASE PROPIETARIOS.FORMA_PAGO = 1 AND PROPIETARIOS.FORMA_ENTREGA <> 2 AND LEN(ALLTRIM(PROPIETARIOS.CEDULA_BEN))>0 AND LEN(ALLTRIM(PROPIETARIOS.BENEFICIARIO))>0 
			lcNit = ALLTRIM(PROPIETARIOS.CEDULA_BEN)
			lcNombre_ben = ALLTRIM(PROPIETARIOS.BENEFICIARIO)
		CASE PROPIETARIOS.FORMA_PAGO = 2 AND LEN(ALLTRIM(PROPIETARIOS.NITCUENTA))>0 AND LEN(ALLTRIM(PROPIETARIOS.TITULAR_CUENTA))>0 
			lcNit = ALLTRIM(PROPIETARIOS.NITCUENTA)
			lcNombre_ben = ALLTRIM(PROPIETARIOS.TITULAR_CUENTA)
			DO CASE 
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="01"	
					lcTipo_doc = "31"
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="02"	
					lcTipo_doc = "13"
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="03"	
					lcTipo_doc = "12"
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="04"	
					lcTipo_doc = "22"	
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="05"	
					lcTipo_doc = "41"
				OTHERWISE 
					lcTipo_doc = "13"		
			ENDCASE 
		CASE PROPIETARIOS.FORMA_PAGO = 1 AND PROPIETARIOS.FORMA_ENTREGA = 2 AND LEN(ALLTRIM(PROPIETARIOS.NITCUENTA))>0 AND LEN(ALLTRIM(PROPIETARIOS.TITULAR_CUENTA))>0 
			lcNit = ALLTRIM(PROPIETARIOS.NITCUENTA)
			lcNombre_ben = ALLTRIM(PROPIETARIOS.TITULAR_CUENTA)
			DO CASE 
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="01"	
					lcTipo_doc = "31"
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="02"	
					lcTipo_doc = "13"
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="03"	
					lcTipo_doc = "12"
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="04"	
					lcTipo_doc = "22"	
				CASE ALLTRIM(PROPIETARIOS.TIDENTIDAD)=="05"	
					lcTipo_doc = "41"
				OTHERWISE 
					lcTipo_doc = "13"		
			ENDCASE 

		OTHERWISE 
			lcNit = "804009532"
	ENDCASE  
	
	SET EXACT ON 
	IF !SEEK(ALLTRIM(lcNit),"CLIENTES","COD_CLI")
		
		lcTipo_doc = "13"
		lcSexo = "M"
		lcPrimer_nombre = ""
		lcSegundo_nombre = ""
		lcPrimer_apellido = ""
		lcSegundo_apellido = ""
		lcRazon_social  = ""
		thisform.nombrescompletos(lcNombre_ben,2)	
			
		lcEmail = ALLTRIM(PROPIETARIOS.MAIL)
						
		thisform.Telefonosjson(ALLTRIM(PROPIETARIOS.TEL_RES), ALLTRIM(PROPIETARIOS.TEL_OF),ALLTRIM(PROPIETARIOS.CELULAR))
 					
		FOR I=1 TO 4	
			lcTipo_direccion = ''
			DO CASE 
				CASE I = 1
					lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_RES)
					lcTipo_direccion = 'DIR_CLIENTE'
				CASE I = 2
					lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_OF)	
					lcTipo_direccion = 'DIR_TRABAJO'
				CASE I = 3
					lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_RESCON)	
					lcTipo_direccion = 'DIR_CONTADOR'
				CASE I = 4
					lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_RESAPO)	
					lcTipo_direccion = 'DIR_APODERADO'
			ENDCASE
			
			lcCadena_atipico = ""
			lcViaPPal=""
			lcEjevial1=""
			lcEjevial2=""
			lcEjevial3=""
			lcCompl1=""
			lcCompl2=""
			lcCompl3=""
			lcCompl4=""
			lcCompl5="" 
			lcCompl6="" 
			lcCompl7="" 
			lcCompl8="" 
			lnViaPPal = 0
			lnCompl1 = 0
			lnCompl3 = 0
			lnCompl5 = 0
			lcCadena_fjson = "" 			
			IF LEN(ALLTRIM(lcCadena_Direccion))>0 AND (LEN(alltrim(lcPrimer_nombre))>0 OR LEN(alltrim(lcRazon_social))>0)		
				thisform.direcciones_fjson(lcCadena_Direccion, lcTipo_direccion)
			ENDIF
			
			DO CASE 
				CASE I = 1
					lcCadena_Dir_res = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
					IF LEN(ALLTRIM(lcCadena_Dir_res))=0
						lcCadena_Dir_res =lcCadena_atipico
					ENDIF
				CASE I = 2
					lcCadena_Dir_of = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
					IF LEN(ALLTRIM(lcCadena_Dir_of))=0
						lcCadena_Dir_of =lcCadena_atipico
					ENDIF
				CASE I = 3
					lcCadena_Dir_rescon = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
					IF LEN(ALLTRIM(lcCadena_Dir_rescon))=0
						lcCadena_Dir_rescon =lcCadena_atipico
					ENDIF
				CASE I = 4
					lcCadena_Dir_resapo = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
					IF LEN(ALLTRIM(lcCadena_Dir_resapo))=0
						lcCadena_Dir_resapo =lcCadena_atipico
					ENDIF
			ENDCASE
		NEXT  

		**REGIMEN 
		lnRegimen = "SR"
		lcRteica = "N"
		lcAutoret = "N"
		lcReteiva = "N"
		lcObservaciones = ""
		lcDeclara_renta = "N"
		lcBloqueado = "N"
		lcVivo = "S"
		lcDir_cor = lcCadena_Dir_res
		lnIdBarrio_cor = "0"
			
		lnidCiudad_res = 0

		lnIdBarrio_res = "0"
		lnIdBarrio_of = "0"
		
		lcCod_ciudad = '68001'	
		IF SEEK(lnidCiudad_res,"CIUDADES","IDCIUDAD")
			lcCiudad = ALLTRIM(CIUDADES.CIUDAD)
			IF SEEK(lcCiudad,"CIUDAD","CIUDAD")
				lcCod_ciudad = ALLTRIM(CIUDAD.COD_CIUDAD)
			ENDIF 
		ENDIF 
		
		IF SEEK(lnIdBarrio_res,"BARRIO",'CODIGO')
			IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
				REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
			ENDIF
		ENDIF 
		
		IF SEEK(lnIdBarrio_of,"BARRIO",'CODIGO')
			IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
				REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
			ENDIF
		ENDIF 
		
		lcDv = ""
		IF ALLTRIM(lcTipo_doc)=="31"
			lcDv = thisform.digito_ver(lcNit) 
		ENDIF 
		 											
		SELECT CLIENTES 
		APPEND BLANK
		REPLACE;
		COD_CLIENTE WITH lcNit,;
		PRIMER_NOMBRE WITH IIF(LEN(ALLTRIM(lcPrimer_nombre))>0,lcPrimer_nombre,lcRazon_social) ,;
		SEGUNDO_NOMBRE WITH lcSegundo_nombre,;
		PRIMER_APELLIDO WITH lcPrimer_apellido,;
		SEGUNDO_APELLIDO WITH lcSegundo_apellido,;
		FECHA_NACIMIENTO WITH ldFecha_nacimiento,;
		DIR_CLIENTE WITH lcCadena_Dir_res,; 
		DIR_TRABAJO WITH lcCadena_Dir_of,;
		TEL_CLIENTE WITH lcTelefono ,;
		EMAIL WITH lcEmail,; 
 		COD_TIPO_REGIMEN WITH ALLTRIM(lnRegimen),;	
 		COD_TIPO_CLIENTE WITH ALLTRIM(lnTipo_cliente),;
 		COD_TIPO_DOCUMENTO WITH lcTipo_doc,;
 		RETIENE_SOBRE_ICA WITH lcRteica,;	
 		RETIENE_SOBRE_IVA WITH lcReteiva,;
 		OBS_CLIENTE WITH lcObservaciones,;
 		DECLARA_RENTA WITH lcDeclara_renta,;
 		DIRECCION_DIAN WITH lcCadena_Dir_res,;
 		AUTORETENEDOR WITH lcAutoret,;
 		DIR_ENVIO_CORRESPONDENCIA WITH lcDir_cor,;
 		BLOQUEAR_PAGO WITH lcBloqueado,;
 		COD_CIUDAD_CLIENTE WITH lcCod_ciudad,;
 		COD_CIUDAD_DIAN WITH lcCod_ciudad,;
		COD_BARRIO_CLIENTE WITH lnIdBarrio_res,;	
		COD_BARRIO_DIAN WITH lnIdBarrio_res,;	
		COD_BARRIO_CORRESPONDENCIA WITH lnIdBarrio_cor,;	
		COD_BARRIO_DIR_TRABAJO WITH lnIdBarrio_OF,;
		DV_CLIENTE WITH lcDv,;
		TIPO_ENVIO_CORRESPONDENCIA WITH lcTipo_Cor;		
		SEQ_PROFESION WITH "1",;
		SEXO WITH lcSexo,;	
		COD_CIUDAD_DOCUMENTO WITH lcCod_ciudad,; 
		RESPONSABLE_IVA WITH IIF(lnRegimen="RC","S","N"),;
 		NO_IVA_ARRIENDO WITH "N",;
		IMPUESTO_INDUSTRIA WITH "N",;
		COD_CREE WITH "",;
		COD_CIUDAD_DIR_TRABAJO WITH lcCod_ciudad,; 
		VIVO WITH lcVivo,; 
		AGENTE_RETENEDOR WITH "N";
		IN CLIENTES		
	ENDIF 
	SET EXACT OFF 	
ENDSCAN 

SELECT PROPIETARIOS 
GO TOP 
SCAN FOR PROPIETARIOS.TIPO_PAGO = 2
	DO CASE 
		CASE PROPIETARIOS.TRIBUTARIO  = 1
			lnTipo_cliente = "SL"
		CASE NITS.EMPRESA 
			lnTipo_cliente = "PJ"		
		CASE !NITS.EMPRESA 
			lnTipo_cliente = "PN"	
		OTHERWISE 
			lnTipo_cliente = "PN"			
	ENDCASE
	lcTipo_doc = "13"
	
	SELECT * FROM INMPRO WHERE IDPROPIETARIO = PROPIETARIOS.IDPROPIETARIO INTO CURSOR CINM
	
	SELECT CINM
	GO TOP 
	SCAN 
		SET EXACT ON 
		IF SEEK(CINM.IDINMUEBLE,"INMUEBLES","IDINMUEBLE")
			DO CASE 
				CASE INMUEBLES.FORMA_PAGO = 1 AND INMUEBLES.FORMA_ENT <> 2 AND LEN(ALLTRIM(INMUEBLES.CEDULA_BEN))>0 AND LEN(ALLTRIM(INMUEBLES.BENEFICIARIO))>0 
					lcNit = ALLTRIM(INMUEBLES.CEDULA_BEN)
					lcNombre_ben = ALLTRIM(INMUEBLES.BENEFICIARIO)
				CASE INMUEBLES.FORMA_PAGO = 2 AND LEN(ALLTRIM(INMUEBLES.NITCUENTA))>0 AND LEN(ALLTRIM(INMUEBLES.TITULAR_CUENTA))>0 
					lcNit = ALLTRIM(INMUEBLES.NITCUENTA)
					lcNombre_ben = ALLTRIM(INMUEBLES.TITULAR_CUENTA)
					DO CASE 
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="01"	
							lcTipo_doc = "31"
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="02"	
							lcTipo_doc = "13"
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="03"	
							lcTipo_doc = "12"
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="04"	
							lcTipo_doc = "22"	
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="05"	
							lcTipo_doc = "41"
						OTHERWISE 
							lcTipo_doc = "13"		
					ENDCASE 
				CASE INMUEBLES.FORMA_PAGO = 1 AND INMUEBLES.FORMA_ENT = 2 AND LEN(ALLTRIM(INMUEBLES.NITCUENTA))>0 AND LEN(ALLTRIM(INMUEBLES.TITULAR_CUENTA))>0 
					lcNit = ALLTRIM(INMUEBLES.NITCUENTA)
					lcNombre_ben = ALLTRIM(INMUEBLES.TITULAR_CUENTA)
					DO CASE 
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="01"	
							lcTipo_doc = "31"
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="02"	
							lcTipo_doc = "13"
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="03"	
							lcTipo_doc = "12"
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="04"	
							lcTipo_doc = "22"	
						CASE ALLTRIM(INMUEBLES.TIDENTIDAD)=="05"	
							lcTipo_doc = "41"
						OTHERWISE 
							lcTipo_doc = "13"		
					ENDCASE 

				OTHERWISE 
					lcNit = "804009532"
			ENDCASE  
			
			IF !SEEK(ALLTRIM(lcNit),"CLIENTES","COD_CLI")
				lcVivo = "S"
				lcTipo_doc = "13"
				lcSexo = "M"
				lcPrimer_nombre = ""
				lcSegundo_nombre = ""
				lcPrimer_apellido = ""
				lcSegundo_apellido = ""
				lcRazon_social  = ""
				thisform.nombrescompletos(lcNombre_ben,2)	
					
				lcEmail = ALLTRIM(PROPIETARIOS.MAIL)
								
				thisform.Telefonosjson(ALLTRIM(PROPIETARIOS.TEL_RES), ALLTRIM(PROPIETARIOS.TEL_OF),ALLTRIM(PROPIETARIOS.CELULAR))
		 					
				FOR I=1 TO 4	
					lcTipo_direccion = ''
					DO CASE 
						CASE I = 1
							lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_RES)
							lcTipo_direccion = 'DIR_CLIENTE'
						CASE I = 2
							lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_OF)	
							lcTipo_direccion = 'DIR_TRABAJO'
						CASE I = 3
							lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_RESCON)	
							lcTipo_direccion = 'DIR_CONTADOR'
						CASE I = 4
							lcCadena_Direccion = ALLTRIM(PROPIETARIOS.DIR_RESAPO)	
							lcTipo_direccion = 'DIR_APODERADO'
					ENDCASE
					
					lcCadena_atipico = ""
					lcViaPPal=""
					lcEjevial1=""
					lcEjevial2=""
					lcEjevial3=""
					lcCompl1=""
					lcCompl2=""
					lcCompl3=""
					lcCompl4=""
					lcCompl5="" 
					lcCompl6="" 
					lcCompl7="" 
					lcCompl8="" 
					lnViaPPal = 0
					lnCompl1 = 0
					lnCompl3 = 0
					lnCompl5 = 0
					lcCadena_fjson = "" 				
					IF LEN(ALLTRIM(lcCadena_Direccion))>0 AND (LEN(alltrim(lcPrimer_nombre))>0 OR LEN(alltrim(lcRazon_social))>0)		
						thisform.direcciones_fjson(lcCadena_Direccion, lcTipo_direccion)
					ENDIF
					
					DO CASE 
						CASE I = 1
							lcCadena_Dir_res = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
							IF LEN(ALLTRIM(lcCadena_Dir_res))=0
								lcCadena_Dir_res =lcCadena_atipico
							ENDIF
						CASE I = 2
							lcCadena_Dir_of = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
							IF LEN(ALLTRIM(lcCadena_Dir_of))=0
								lcCadena_Dir_of =lcCadena_atipico
							ENDIF
						CASE I = 3
							lcCadena_Dir_rescon = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
							IF LEN(ALLTRIM(lcCadena_Dir_rescon))=0
								lcCadena_Dir_rescon =lcCadena_atipico
							ENDIF
						CASE I = 4
							lcCadena_Dir_resapo = lcViaPPal+" "+lcEjevial1+" "+lcEjevial2+" "+lcEjevial3+" "+lcCompl1+" "+lcCompl2+" "+lcCompl3+" "+lcCompl4+" "+lcCompl6
							IF LEN(ALLTRIM(lcCadena_Dir_resapo))=0
								lcCadena_Dir_resapo =lcCadena_atipico
							ENDIF
					ENDCASE
				NEXT  

				**REGIMEN 
				lnRegimen = "SR"
				lcRteica = "N"
				lcAutoret = "N"
				lcReteiva = "N"
				lcObservaciones = ""
				lcDeclara_renta = "N"
				lcBloqueado = "N"
				
				lcDir_cor = lcCadena_Dir_res
				lnIdBarrio_cor = "0"
					
				lnidCiudad_res = 0

				lnIdBarrio_res = "0"
				lnIdBarrio_of = "0"
				
				lcCod_ciudad = '68001'	
				IF SEEK(lnidCiudad_res,"CIUDADES","IDCIUDAD")
					lcCiudad = ALLTRIM(CIUDADES.CIUDAD)
					IF SEEK(lcCiudad,"CIUDAD","CIUDAD")
						lcCod_ciudad = ALLTRIM(CIUDAD.COD_CIUDAD)
					ENDIF 
				ENDIF 
				
				IF SEEK(lnIdBarrio_res,"BARRIO",'CODIGO')
					IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
						REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
					ENDIF
				ENDIF 
				
				IF SEEK(lnIdBarrio_of,"BARRIO",'CODIGO')
					IF LEN(ALLTRIM(BARRIO.COD_CIUDAD))=0
						REPLACE BARRIO.COD_CIUDAD WITH lcCod_ciudad 
					ENDIF
				ENDIF 
				
				lcDv = ""
				IF ALLTRIM(lcTipo_doc)=="31"
					lcDv = thisform.digito_ver(lcNit) 
				ENDIF 
				 											
				SELECT CLIENTES 
				APPEND BLANK
				REPLACE;
				COD_CLIENTE WITH lcNit,;
				PRIMER_NOMBRE WITH IIF(LEN(ALLTRIM(lcPrimer_nombre))>0,lcPrimer_nombre,lcRazon_social) ,;
				SEGUNDO_NOMBRE WITH lcSegundo_nombre,;
				PRIMER_APELLIDO WITH lcPrimer_apellido,;
				SEGUNDO_APELLIDO WITH lcSegundo_apellido,;
				FECHA_NACIMIENTO WITH ldFecha_nacimiento,;
				DIR_CLIENTE WITH lcCadena_Dir_res,; 
				DIR_TRABAJO WITH lcCadena_Dir_of,;
				TEL_CLIENTE WITH lcTelefono ,;
				EMAIL WITH lcEmail,; 
		 		COD_TIPO_REGIMEN WITH ALLTRIM(lnRegimen),;	
		 		COD_TIPO_CLIENTE WITH ALLTRIM(lnTipo_cliente),;
		 		COD_TIPO_DOCUMENTO WITH lcTipo_doc,;
		 		RETIENE_SOBRE_ICA WITH lcRteica,;	
		 		RETIENE_SOBRE_IVA WITH lcReteiva,;
		 		OBS_CLIENTE WITH lcObservaciones,;
		 		DECLARA_RENTA WITH lcDeclara_renta,;
		 		DIRECCION_DIAN WITH lcCadena_Dir_res,;
		 		AUTORETENEDOR WITH lcAutoret,;
		 		DIR_ENVIO_CORRESPONDENCIA WITH lcDir_cor,;
		 		BLOQUEAR_PAGO WITH lcBloqueado,;
		 		COD_CIUDAD_CLIENTE WITH lcCod_ciudad,;
		 		COD_CIUDAD_DIAN WITH lcCod_ciudad,;
				COD_BARRIO_CLIENTE WITH lnIdBarrio_res,;	
				COD_BARRIO_DIAN WITH lnIdBarrio_res,;	
				COD_BARRIO_CORRESPONDENCIA WITH lnIdBarrio_cor,;	
				COD_BARRIO_DIR_TRABAJO WITH lnIdBarrio_OF,;
				DV_CLIENTE WITH lcDv,;
				TIPO_ENVIO_CORRESPONDENCIA WITH lcTipo_Cor;		
				SEQ_PROFESION WITH "1",;
				SEXO WITH lcSexo,;	
				COD_CIUDAD_DOCUMENTO WITH lcCod_ciudad,; 
				RESPONSABLE_IVA WITH IIF(lnRegimen="RC","S","N"),;
		 		NO_IVA_ARRIENDO WITH "N",;
				IMPUESTO_INDUSTRIA WITH "N",;
				COD_CREE WITH "",;
				COD_CIUDAD_DIR_TRABAJO WITH lcCod_ciudad,; 
				VIVO WITH "S",; 
				AGENTE_RETENEDOR WITH "N"; 
		 		IN CLIENTES		
			ENDIF 
			SET EXACT OFF 			
		ENDIF 
	ENDSCAN 
ENDSCAN 


*SET STEP ON 



*!*	CREATE CURSOR CLIENTES(;
*!*	 c(5),;********
*!*	 c(3),; *********	
*!*	 c(1),;	*************
*!*	PROFESION c(50),;*******************	
*!*	c(4),;	*******************
*!*	HOBBIES c(250),;*******************	
*!*	COD_ESTADO_CIVIL c(3),;	***********************
*!*	COD_TITULO c(3),;******************	
*!*	PORC_RETEICA y,; ?????	

	







*!*	COPY TO F:/CLIENTES.XLS TYPE XL5

*!*	SELECT cliente_direccion 
*!*	GO TOP 
*!*	 

*!*	COPY TO F:/cliente_direccion.XLS TYPE XL5

*!*	MESSAGEBOX("OK")
ENDPROC
PROCEDURE nombrescompletos
LPARAMETERS tcNombre, tnTipo 

if tnTipo = 1
	lnNroCadApe = OCCURS(" ",ALLTRIM(tcNombre))
	DO case
		CASE lnNroCadApe=1
			lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,1,AT(" ",ALLTRIM(tcNombre))))
			lcSegundo_nombre = ""
			lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,AT(" ",ALLTRIM(tcNombre))))
			lcSegundo_apellido = ""
		CASE lnNroCadApe=2
			lnPos1 = AT(" ",ALLTRIM(tcNombre),1)
			lnPos2 = AT(" ",ALLTRIM(tcNombre),2)
				
			lcPrimer_nombre= ALLTRIM(SUBSTR(tcNombre,1,lnPos1))
			lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos1+1,lnPos2-lnPos1))
			lcSegundo_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos2+1))	
			lcSegundo_nombre = ""
		CASE lnNroCadApe=3
			lnPos1 = AT(" ",ALLTRIM(tcNombre),1)
			lnPos2 = AT(" ",ALLTRIM(tcNombre),2)
			lnPos3 = AT(" ",ALLTRIM(tcNombre),3)
				
			lcPrimer_nombre= ALLTRIM(SUBSTR(tcNombre,1,lnPos1))
			lcSegundo_nombre = ALLTRIM(SUBSTR(tcNombre,lnPos1+1,lnPos2-lnPos1))
			lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos2+1,lnPos3-lnPos2))	
			lcSegundo_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos3+1))	
		OTHERWISE 
			lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,1,AT(" ",ALLTRIM(tcNombre))))
			lcSegundo_nombre = ""
			lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,AT(" ",ALLTRIM(tcNombre))))
			lcSegundo_apellido = ""
	ENDCASE 
ELSE 
	lnNroCadApe = OCCURS(" ",ALLTRIM(tcNombre))
	DO case
		CASE lnNroCadApe=1
			lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,1,AT(" ",ALLTRIM(tcNombre))))
			lcSegundo_nombre = ""
			lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,AT(" ",ALLTRIM(tcNombre))))
			lcSegundo_apellido = ""
		CASE lnNroCadApe=2
			lnPos1 = AT(" ",ALLTRIM(tcNombre),1)
			lnPos2 = AT(" ",ALLTRIM(tcNombre),2)
				
			lcPrimer_apellido= ALLTRIM(SUBSTR(tcNombre,1,lnPos1))
			lcSegundo_nombre = ""
			lcSegundo_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos1+1,lnPos2-lnPos1))
			lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,lnPos2+1))	
		CASE lnNroCadApe=3
			lnPos1 = AT(" ",ALLTRIM(tcNombre),1)
			lnPos2 = AT(" ",ALLTRIM(tcNombre),2)
			lnPos3 = AT(" ",ALLTRIM(tcNombre),3)
				
			lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,1,lnPos1))
			lcSegundo_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos1+1,lnPos2-lnPos1))
			lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,lnPos2+1,lnPos3-lnPos2))	
			lcSegundo_nombre = ALLTRIM(SUBSTR(tcNombre,lnPos3+1))	
		OTHERWISE 
			lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,1,AT(" ",ALLTRIM(tcNombre))))
			lcSegundo_nombre = ""
			lcPrimer_nombre  = ALLTRIM(SUBSTR(tcNombre,AT(" ",ALLTRIM(tcNombre))))
			lcSegundo_apellido = ""
	ENDCASE 
ENDIF 	
ENDPROC
PROCEDURE nombresnits
LPARAMETERS tcTipo_doc, tcNombre, tcApellido, tcRazon_soc, tnTipo

thisform.tipodoc(tcTipo_doc,tnTipo) 
	
IF ALLTRIM(lcTipo_doc) = "31" 
		lcRazon_social = ALLTRIM(tcRazon_soc)
		lcPrimer_nombre = ""
		lcPrimer_apellido = ""
		lcSegundo_nombre = ""
		lcSegundo_apellido =  "" 

		IF LEN(ALLTRIM(lcRazon_social))=0
			IF LEN(ALLTRIM(tcApellido))>0
				lcRazon_social = ALLTRIM(tcApellido)+" "+ALLTRIM(tcNombre)
			ELSE 
				lcRazon_social = ALLTRIM(tcNombre)
			ENDIF 	
		ENDIF 
ELSE
	IF LEN(ALLTRIM(tcNombre))>0 AND LEN(ALLTRIM(tcApellido))>0
		
		lnNroCadApe = OCCURS(" ",ALLTRIM(tcApellido))
		DO case
			CASE lnNroCadApe=1
				lcPrimer_apellido = ALLTRIM(SUBSTR(tcApellido,1,AT(" ",ALLTRIM(tcApellido))))
				lcSegundo_apellido = ALLTRIM(SUBSTR(tcApellido,AT(" ",ALLTRIM(tcApellido))))
			CASE lnNroCadApe=2
				IF  ATC(" DE ",ALLTRIM(tcApellido))>0
					lcPrimer_apellido = ALLTRIM(SUBSTR(tcApellido,1,AT(" ",ALLTRIM(tcApellido))))
					lcSegundo_apellido = ALLTRIM(SUBSTR(tcApellido,AT(" ",ALLTRIM(tcApellido))))
				ELSE 
					lnPos1 = AT(" ",ALLTRIM(tcApellido),1)
					lnPos2 = AT(" ",ALLTRIM(tcApellido),2)
					
					lcPrimer_apellido = ALLTRIM(SUBSTR(tcApellido,1,lnPos1))
					lcSegundo_apellido = ALLTRIM(SUBSTR(tcApellido,lnPos1+1,lnPos2-lnPos1))
					lcPrimer_nombre = ALLTRIM(SUBSTR(tcApellido,lnPos2+1))	
				ENDIF 
			CASE lnNroCadApe=0 
				lcPrimer_apellido = ALLTRIM(tcApellido)
				lcSegundo_apellido = ""
			OTHERWISE 
				lcPrimer_apellido = ALLTRIM(SUBSTR(tcApellido,1,AT(" ",ALLTRIM(tcApellido))))
				lcSegundo_apellido = ALLTRIM(SUBSTR(tcApellido,AT(" ",ALLTRIM(tcApellido))))
		ENDCASE 
							
		lnNroCadNom = OCCURS(" ",ALLTRIM(tcNombre))
		IF lnNroCadNom >0
			DO CASE
				CASE (ALLTRIM(tcNombre)=="DE JESUS" OR ALLTRIM(tcNombre)=="DE JES" OR ALLTRIM(tcNombre)=="DE JESU"; 
					OR ALLTRIM(tcNombre)=="DE DIOS" OR ALLTRIM(tcNombre)=="DE FATIMA" OR ALLTRIM(tcNombre)=="DEL CARMEN";
					OR ALLTRIM(tcNombre)=="DE LA CRUZ" OR ALLTRIM(tcNombre)=="DE LA CONCE" OR ALLTRIM(tcNombre)=="DE LA CONCEP";
					OR ALLTRIM(tcNombre)=="DE PAULA" OR ALLTRIM(tcNombre)=="DE LOS ANGE" OR ALLTRIM(tcNombre)=="DE LOS ANGELES";
					OR ALLTRIM(tcNombre)=="DE LOS ANGEL" OR ALLTRIM(tcNombre)=="DE LAS MECEDES" OR ALLTRIM(tcNombre)=="DE MARIA";
					OR ALLTRIM(tcNombre)=="DE LA TRINIDAD" OR ALLTRIM(tcNombre)=="DE LINA") AND LEN(ALLTRIM(lcPrimer_nombre))>0
					
					lcPrimer_nombre = lcSegundo_apellido 
				 	lcSegundo_nombre = ALLTRIM(tcNombre)
					lcSegundo_apellido = ""
					
				CASE ALLTRIM(tcNombre)=="DE"
					lcPrimer_nombre = ALLTRIM(tcNombre)+" "+lcPrimer_apellido 
					lcSegundo_nombre = lcSegundo_apellido
					lcSegundo_apellido = ""
					
				CASE RIGHT(ALLTRIM(tcNombre),6)=="VDA DE"
					lcPrimer_nombre = lcSegundo_apellido 
					lcSegundo_apellido = "VDA DE"+" "+lcPrimer_apellido
					lcPrimer_apellido = SUBSTR(ALLTRIM(tcNombre),1,LEN(ALLTRIM(tcNombre))-6)
					lcSegundo_nombre = ""	
					
				CASE RIGHT(ALLTRIM(tcNombre),2)=="DE"
					lcPrimer_nombre = lcSegundo_apellido 
					lcSegundo_apellido = "DE"+" "+lcPrimer_apellido
					lcPrimer_apellido = SUBSTR(ALLTRIM(tcNombre),1,LEN(ALLTRIM(tcNombre))-2)
					lcSegundo_nombre = ""	
									
				OTHERWISE  
	 				IF ALLTRIM(lcPrimer_nombre)=="DE"
												
						lnNroCadNom = OCCURS(" ",ALLTRIM(tcNombre))
						DO case
							CASE lnNroCadNom=1
								lcSegundo_apellido = ALLTRIM(lcSegundo_apellido)+" "+ALLTRIM(lcPrimer_nombre)+" "+ALLTRIM(SUBSTR(tcNombre,1,AT(" ",ALLTRIM(tcNombre))))
								lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,AT(" ",ALLTRIM(tcNombre))))
							CASE lnNroCadNom=2
								lnPos1 = AT(" ",ALLTRIM(tcNombre),1)
								lnPos2 = AT(" ",ALLTRIM(tcNombre),2)
								
								lcSegundo_apellido = ALLTRIM(lcSegundo_apellido)+" "+ALLTRIM(lcPrimer_nombre)+" "+ALLTRIM(SUBSTR(tcNombre,1,lnPos1))
								lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,lnPos1+1,lnPos2-lnPos1))
								lcSegundo_nombre = ALLTRIM(SUBSTR(tcNombre,lnPos2+1))	
							CASE lnNroCadNom=0 
								IF ALLTRIM(tcNombre)=="JESUS" OR ALLTRIM(tcNombre)=="DIOS" 
									lcSegundo_nombre = ALLTRIM(lcPrimer_nombre)+' '+ALLTRIM(tcNombre)
									lcPrimer_nombre = lcSegundo_apellido
									lcSegundo_apellido = ""
								ELSE	
									lcPrimer_nombre = ALLTRIM(tcApellido)
									lcSegundo_nombre = ""
								ENDIF 	
						ENDCASE 
					ELSE 	
		 				lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,1,AT(" ",ALLTRIM(tcNombre))))
						lcSegundo_nombre = ALLTRIM(SUBSTR(tcNombre,AT(" ",ALLTRIM(tcNombre))))
					ENDIF 	
			ENDCASE 		
		ELSE 
			DO case
				case ALLTRIM(tcNombre)=="DE"
					lcPrimer_apellido = ALLTRIM(tcNombre)+" "+lcPrimer_apellido 
					lcPrimer_nombre = lcSegundo_apellido 
					lcSegundo_apellido = ""
				CASE (ALLTRIM(tcNombre)=="JESUS" OR ALLTRIM(tcNombre)=="DIOS") AND ALLTRIM(lcPrimer_nombre)=="DE"  
					lcSegundo_nombre = ALLTRIM(lcPrimer_nombre)+' '+ALLTRIM(tcNombre)	
					lcPrimer_nombre = lcSegundo_apellido
					lcSegundo_apellido = ""
					
				******************************************************************************************	
			OTHERWISE 
				lcSegundo_nombre = IIF(LEN(ALLTRIM(lcPrimer_nombre))>0,ALLTRIM(tcNombre),"")
				lcPrimer_nombre = IIF(LEN(ALLTRIM(lcPrimer_nombre))>0,lcPrimer_nombre ,ALLTRIM(tcNombre))
				*lcSegundo_nombre = ""
			ENDCASE 	
		ENDIF 

		lcRazon_social = ""
	ELSE 
		IF LEN(ALLTRIM(tcNombre))>0 
			lnNroCad = OCCURS(" ",ALLTRIM(tcNombre))
			DO CASE 
				case lnNroCad = 3
					lnPos1 = AT(" ",ALLTRIM(tcNombre),1)
					lnPos2 = AT(" ",ALLTRIM(tcNombre),2)
					lnPos3 = AT(" ",ALLTRIM(tcNombre),3)
					
					lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,1,lnPos1))
					lcSegundo_nombre = ALLTRIM(SUBSTR(tcNombre,lnPos1+1,lnPos2-lnPos1))
					lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos2+1,lnPos3-lnPos2))
					lcSegundo_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos3+1))
					
				case lnNroCad = 2
					lnPos1 = AT(" ",ALLTRIM(tcNombre),1)
					lnPos2 = AT(" ",ALLTRIM(tcNombre),2)
					
					lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,1,lnPos1))
					lcSegundo_nombre = ""
					lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos1+1,lnPos2-lnPos1))
					lcSegundo_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos2+1))
				case lnNroCad = 1
					lnPos1 = AT(" ",ALLTRIM(tcNombre),1)
					
					lcPrimer_nombre = ALLTRIM(SUBSTR(tcNombre,1,lnPos1))
					lcSegundo_nombre = ""
					lcPrimer_apellido = ALLTRIM(SUBSTR(tcNombre,lnPos1+1))
					lcSegundo_apellido = ""
				OTHERWISE 
					lcPrimer_nombre = ALLTRIM(tcNombre)
			ENDCASE 	
		ELSE 
			lnNroCad = OCCURS(" ",ALLTRIM(tcApellido))
			DO CASE 
				case lnNroCad = 3
					lnPos1 = AT(" ",ALLTRIM(tcApellido),1)
					lnPos2 = AT(" ",ALLTRIM(tcApellido),2)
					lnPos3 = AT(" ",ALLTRIM(tcApellido),3)
					
					lcPrimer_nombre = ALLTRIM(SUBSTR(tcApellido,1,lnPos1))
					lcSegundo_nombre = ALLTRIM(SUBSTR(tcApellido,lnPos1+1,lnPos2-lnPos1))
					lcPrimer_apellido = ALLTRIM(SUBSTR(tcApellido,lnPos2+1,lnPos3-lnPos2))
					lcSegundo_apellido = ALLTRIM(SUBSTR(tcApellido,lnPos3+1))
					
				case lnNroCad = 2
					lnPos1 = AT(" ",ALLTRIM(tcApellido),1)
					lnPos2 = AT(" ",ALLTRIM(tcApellido),2)
					
					lcPrimer_nombre = ALLTRIM(SUBSTR(tcApellido,1,lnPos1))
					lcSegundo_nombre = ""
					lcPrimer_apellido = ALLTRIM(SUBSTR(tcApellido,lnPos1+1,lnPos2-lnPos1))
					lcSegundo_apellido = ALLTRIM(SUBSTR(tcApellido,lnPos2+1))
				case lnNroCad = 1
					lnPos1 = AT(" ",ALLTRIM(tcApellido),1)
					
					lcPrimer_nombre = ALLTRIM(SUBSTR(tcApellido,1,lnPos1))
					lcSegundo_nombre = ""
					lcPrimer_apellido = ALLTRIM(SUBSTR(tcApellido,lnPos1+1))
					lcSegundo_apellido = ""
				OTHERWISE 
					lcPrimer_nombre = ALLTRIM(tcApellido)
			ENDCASE 
		ENDIF 
	ENDIF 	
	lcRazon_social = ""
ENDIF  

IF ALLTRIM(lcPrimer_nombre) == ALLTRIM(lcSegundo_nombre)
	lcSegundo_nombre = ""
ENDIF 

IF !lcTipo_doc =="31"
	IF RIGHT(ALLTRIM(LOWER(lcPrimer_nombre)),1)=="O"
		lcSexo = "M"
	ELSE 
		SET EXACT ON 
		IF SEEK(LOWER(lcPrimer_nombre),"NOMBRES","NFEM")
			lcSexo = "F"
		ELSE 
			IF SEEK(LOWER(lcSegundo_nombre),"NOMBRES","NFEM")
				lcSexo = "F"
			ELSE 	
				IF SEEK(LOWER(lcPrimer_nombre),"NOMBRES","NMAS")
					lcSexo = "M"
				ELSE 
					IF SEEK(LOWER(lcSegundo_nombre),"NOMBRES","NMAS")
						lcSexo = "M"
					ENDIF 
				ENDIF 
			ENDIF 		
		ENDIF 
		SET EXACT OFF 	
	ENDIF 
ENDIF 




ENDPROC
PROCEDURE parqueadero
 LPARAMETERS lnidinmueble
 DO CASE
    CASE thisform.buscar_detalle(lnidinmueble, 20, 1)<>0
          RETURN "1"
      
    CASE thisform.buscar_detalle(lnidinmueble, 21, 1)<>0
          RETURN "2"
      
    CASE thisform.buscar_detalle(lnidinmueble, 25, 1)<>0
          RETURN "3"
    
    CASE thisform.buscar_detalle(lnidinmueble, 27, 1)<>0
          RETURN "4"
    
    CASE thisform.buscar_detalle(lnidinmueble, 93, 1)<>0
          RETURN "5"
          
    OTHERWISE
          RETURN "0"
       
 ENDCASE
ENDPROC
PROCEDURE piso
LPARAMETERS tnIdinmueble 

 DO CASE
    CASE thisform.buscar_detalle(tnIdinmueble , 29, 1)<>0
        RETURN ' 1'
    CASE thisform.buscar_detalle(tnIdinmueble , 30, 1)<>0
        RETURN ' 2'
    CASE thisform.buscar_detalle(tnIdinmueble , 31, 1)<>0
          RETURN ' 3'
    CASE thisform.buscar_detalle(tnIdinmueble , 32, 1)<>0
          RETURN ' 4'
    CASE thisform.buscar_detalle(tnIdinmueble , 33, 1)<>0
          RETURN ' 5'
    CASE thisform.buscar_detalle(tnIdinmueble , 34, 1)<>0
          RETURN ' 6'
     CASE thisform.buscar_detalle(tnIdinmueble , 35, 1)<>0
          RETURN ' 7'
    CASE thisform.buscar_detalle(tnIdinmueble , 69, 1)<>0
          RETURN ' 8'
    CASE thisform.buscar_detalle(tnIdinmueble , 87, 1)<>0
          RETURN '9'
    CASE thisform.buscar_detalle(tnIdinmueble , 92, 1)<>0
          RETURN '10'
    OTHERWISE
          RETURN ' 0'
 ENDCASE

ENDPROC
PROCEDURE telefonos
LPARAMETERS tcTel_Res, tctel_of, tcCelular 

lcTelefono = ""
IF LEN(ALLTRIM(tcTel_Res))=7 OR (LEN(ALLTRIM(tcTel_Res))>7 AND ATC(' ',ALLTRIM(tcTel_Res))<=0)&&SOLO HAY UN TELEFONO FIJO
	IF ATC('-',ALLTRIM(tcTel_Res),1)=4
		lcTelefono = "movil:"+ALLTRIM(tcTel_Res)+":casa"
	ELSE
		IF ATC('-',ALLTRIM(tcTel_Res),1)<=0
			lcTelefono = IIF(LEN(ALLTRIM(tcTel_Res))>0,IIF(ATC("-",ALLTRIM(tcTel_Res))>0,"movil:","fijo:")+ALLTRIM(tcTel_Res)+":casa","")
		ELSE 
			lcTel = SUBSTR(ALLTRIM(tcTel_Res),1,ATC('-',ALLTRIM(tcTel_Res),1)-1)
			lcTelefono = "fijo:"+ALLTRIM(lcTel)
			lcTel = SUBSTR(ALLTRIM(tcTel_Res),ATC('-',ALLTRIM(tcTel_Res),1)+1)
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+ALLTRIM(lcTel)+":casa"
		ENDIF 	
	ENDIF
ELSE
	IF LEN(ALLTRIM(tcTel_Res))>0 
		lnNroChar = LEN(ALLTRIM(tcTel_Res))
		lnNrodig = 0
		lnPosichar = 0
		FOR x = 1 TO lnNroChar
			lcchar = SUBSTR(ALLTRIM(tcTel_Res),x,1)
			IF ISDIGIT(lcchar)
				lnNrodig = lnNrodig+1
			ELSE 
				IF ISALPHA(lcchar) AND lnPosichar = 0
					lnPosichar = x
				ENDIF 	
			ENDIF 
		NEXT 
		lnNroesp = OCCURS(' ',ALLTRIM(tcTel_Res))
		IF lnNrodig+lnNroesp = lnNroChar
			lnNroTel = OCCURS(' ',ALLTRIM(tcTel_Res))+1
			FOR i = 1 TO lnNroTel
				lnPtel = ATC(' ',ALLTRIM(tcTel_Res),i)
				lcTel = SUBSTR(ALLTRIM(tcTel_Res),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
				lnPos = lnPtel+1
				lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":casa","")
			NEXT 
		ELSE 
			lnNrocel = OCCURS('-',ALLTRIM(tcTel_Res))
			IF lnNrodig+lnNrocel+lnNroesp = lnNroChar
				lnNroTel = OCCURS(' ',ALLTRIM(tcTel_Res))+1
				IF lnNroTel>0
					FOR i = 1 TO lnNroTel
						lnPtel = ATC(' ',ALLTRIM(tcTel_Res),i)
						lcTel = SUBSTR(ALLTRIM(tcTel_Res),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+IIF(ATC("-",lcTel)>0,"movil:"+lcTel,"fijo:"+lcTel)+IIF(i=lnNroTel,":casa","")
						lnPos = lnPtel+1
					NEXT 
				ELSE 
					IF OCCURS('-',ALLTRIM(tcTel_Res))=1 &&solo hay un celular 
						IF ATC('-',ALLTRIM(tcTel_Res),1)=4
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"movil:"+ALLTRIM(tcTel_Res)+":casa "
						ELSE
							lcTel = SUBSTR(ALLTRIM(tcTel_Res),1,ATC('-',ALLTRIM(tcTel_Res),1)-1)
							lcTelefono = "fijo:"+ALLTRIM(lcTel)
							lcTel = SUBSTR(ALLTRIM(tcTel_Res),ATC('-',ALLTRIM(tcTel_Res),1)+1)
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+ALLTRIM(lcTel)+":casa "
						ENDIF 	
					ELSE &&solo hay un internacional
						lcTelefono = "fijo:"+ALLTRIM(tcTel_Res)+":casa "
					ENDIF 	
				ENDIF 	
			ELSE 
					
				lnNrocel = OCCURS('/',ALLTRIM(tcTel_Res))+1
				IF lnNrodig+lnNrocel = lnNroChar
					lnNroTel = OCCURS('/',ALLTRIM(tcTel_Res))+1
					FOR i = 1 TO lnNroTel
						lnPtel = ATC('/',ALLTRIM(tcTel_Res),i)
						lcTel = SUBSTR(ALLTRIM(tcTel_Res),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						lnPos = lnPtel+1
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":casa","")
					NEXT 
				ELSE	
					**cuando hay letras 
					lcTel = SUBSTR(ALLTRIM(tcTel_Res),1,lnPosichar-1)
					lcCad = SUBSTR(ALLTRIM(tcTel_Res),lnPosichar)
					lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+IIF(ATC("-",lcTel)>0,"movil:","fijo:")+lcTel+":casa "+lccad 
				ENDIF 
			ENDIF 
		ENDIF 	
	ENDIF 
ENDIF 	
	
**telefono de oficina 
IF LEN(ALLTRIM(tctel_of))=7 OR (LEN(ALLTRIM(tctel_of))>7 AND ATC(' ',ALLTRIM(tctel_of))<=0)&&SOLO HAY UN TELEFONO FIJO
	IF ATC('-',ALLTRIM(tctel_of),1)=4
		lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"movil:"+ALLTRIM(tctel_of)+":oficina"
	ELSE
		IF ATC('-',ALLTRIM(tctel_of),1)<=0
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+IIF(LEN(ALLTRIM(tctel_of))>0,IIF(ATC("-",ALLTRIM(tctel_of))>0,"movil:","fijo:")+ALLTRIM(tctel_of)+":oficina","")
		ELSE 
			lcTel = SUBSTR(ALLTRIM(tctel_of),1,ATC('-',ALLTRIM(tctel_of),1)-1)
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"fijo:"+ALLTRIM(lcTel)
			lcTel = SUBSTR(ALLTRIM(tctel_of),ATC('-',ALLTRIM(tctel_of),1)+1)
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"fijo:"+ALLTRIM(lcTel)+":oficina"
		ENDIF 	
	ENDIF
ELSE
	IF LEN(ALLTRIM(tctel_of))>0 
		lnNroChar = LEN(ALLTRIM(tctel_of))
		lnNrodig = 0
		lnPosichar = 0
		FOR x = 1 TO lnNroChar
			lcchar = SUBSTR(ALLTRIM(tctel_of),x,1)
			IF ISDIGIT(lcchar)
				lnNrodig = lnNrodig+1
			ELSE 
				IF ISALPHA(lcchar) AND lnPosichar = 0
					lnPosichar = x
				ENDIF 	
			ENDIF 
		NEXT 
		lnNroesp = OCCURS(' ',ALLTRIM(tctel_of))
		IF lnNrodig+lnNroesp = lnNroChar
			lnNroTel = OCCURS(' ',ALLTRIM(tctel_of))+1
			FOR i = 1 TO lnNroTel
				lnPtel = ATC(' ',ALLTRIM(tctel_of),i)
				lcTel = SUBSTR(ALLTRIM(tctel_of),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
				lnPos = lnPtel+1
				lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":oficina","")
			NEXT 
		ELSE 
			lnNrocel = OCCURS('-',ALLTRIM(tctel_of))
			IF lnNrodig+lnNrocel+lnNroesp = lnNroChar
				lnNroTel = OCCURS(' ',ALLTRIM(tctel_of))+1
				IF lnNroTel>0
					FOR i = 1 TO lnNroTel
						lnPtel = ATC(' ',ALLTRIM(tctel_of),i)
						lcTel = SUBSTR(ALLTRIM(tctel_of),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+IIF(ATC("-",lcTel)>0,"movil:"+lcTel,"fijo:"+lcTel)+IIF(i=lnNroTel,":oficina","")
						lnPos = lnPtel+1
					NEXT 
				ELSE 
					IF OCCURS('-',ALLTRIM(tctel_of))=1 &&solo hay un celular 
						IF ATC('-',ALLTRIM(tctel_of),1)=4
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"movil:"+ALLTRIM(tctel_of)+":oficina "
						ELSE
							lcTel = SUBSTR(ALLTRIM(tctel_of),1,ATC('-',ALLTRIM(tctel_of),1)-1)
							lcTelefono = "fijo:"+ALLTRIM(lcTel)
							lcTel = SUBSTR(ALLTRIM(tctel_of),ATC('-',ALLTRIM(tctel_of),1)+1)
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"fijo:"+ALLTRIM(lcTel)+":oficina "
						ENDIF 	
					ELSE &&solo hay un internacional
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"fijo:"+ALLTRIM(tctel_of)+":oficina "
					ENDIF 	
				ENDIF 	
			ELSE 
					
				lnNrocel = OCCURS('/',ALLTRIM(tctel_of))+1
				IF lnNrodig+lnNrocel = lnNroChar
					lnNroTel = OCCURS('/',ALLTRIM(tctel_of))+1
					FOR i = 1 TO lnNroTel
						lnPtel = ATC('/',ALLTRIM(tctel_of),i)
						lcTel = SUBSTR(ALLTRIM(tctel_of),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						lnPos = lnPtel+1
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":oficina","")
					NEXT 
				ELSE	
					**cuando hay letras 
					lcTel = SUBSTR(ALLTRIM(tctel_of),1,lnPosichar-1)
					lcCad = SUBSTR(ALLTRIM(tctel_of),lnPosichar)
					lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+IIF(ATC("-",lcTel)>0,"movil:","fijo:")+lcTel+":oficina "+lccad 
 					ENDIF 
			ENDIF 
		ENDIF 	
	ENDIF 
ENDIF 	

***celular 
IF LEN(ALLTRIM(tcCelular))=7 OR (LEN(ALLTRIM(tcCelular))>7 AND ATC(' ',ALLTRIM(tcCelular))<=0)&&SOLO HAY UN TELEFONO FIJO
	IF ATC('-',ALLTRIM(tcCelular),1)=4
		lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"movil:"+ALLTRIM(tcCelular)+":casa"
	ELSE
		IF ATC('-',ALLTRIM(tcCelular),1)<=0
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+IIF(LEN(ALLTRIM(tcCelular))>0,IIF(ATC("-",ALLTRIM(tcCelular))>0,"movil:","fijo:")+ALLTRIM(tcCelular)+":casa","")
		ELSE 
			lcTel = SUBSTR(ALLTRIM(tcCelular),1,ATC('-',ALLTRIM(tcCelular),1)-1)
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"fijo:"+ALLTRIM(lcTel)
			lcTel = SUBSTR(ALLTRIM(tcCelular),ATC('-',ALLTRIM(tcCelular),1)+1)
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+ALLTRIM(lcTel)+":casa"
		ENDIF 	
	ENDIF
ELSE
	IF LEN(ALLTRIM(tcCelular))>0 
		lnNroChar = LEN(ALLTRIM(tcCelular))
		lnNrodig = 0
		lnPosichar = 0
		FOR x = 1 TO lnNroChar
			lcchar = SUBSTR(ALLTRIM(tcCelular),x,1)
			IF ISDIGIT(lcchar)
				lnNrodig = lnNrodig+1
			ELSE 
				IF ISALPHA(lcchar) AND lnPosichar = 0
					lnPosichar = x
				ENDIF 	
			ENDIF 
		NEXT 
		lnNroesp = OCCURS(' ',ALLTRIM(tcCelular))
		IF lnNrodig+lnNroesp = lnNroChar
			lnNroTel = OCCURS(' ',ALLTRIM(tcCelular))+1
			FOR i = 1 TO lnNroTel
				lnPtel = ATC(' ',ALLTRIM(tcCelular),i)
				lcTel = SUBSTR(ALLTRIM(tcCelular),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
				lnPos = lnPtel+1
				lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":casa","")
			NEXT 
		ELSE 
			lnNrocel = OCCURS('-',ALLTRIM(tcCelular))
			IF lnNrodig+lnNrocel+lnNroesp = lnNroChar
				lnNroTel = OCCURS(' ',ALLTRIM(tcCelular))+1
				IF lnNroTel>0
					FOR i = 1 TO lnNroTel
						lnPtel = ATC(' ',ALLTRIM(tcCelular),i)
						lcTel = SUBSTR(ALLTRIM(tcCelular),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+IIF(ATC("-",lcTel)>0,"movil:"+lcTel,"fijo:"+lcTel)+IIF(i=lnNroTel,":casa","")
						lnPos = lnPtel+1
					NEXT 
				ELSE 
					IF OCCURS('-',ALLTRIM(tcCelular))=1 &&solo hay un celular 
						IF ATC('-',ALLTRIM(tcCelular),1)=4
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"movil:"+ALLTRIM(tcCelular)+":casa "
						ELSE
							lcTel = SUBSTR(ALLTRIM(tcCelular),1,ATC('-',ALLTRIM(tcCelular),1)-1)
							lcTelefono = "fijo:"+ALLTRIM(lcTel)
							lcTel = SUBSTR(ALLTRIM(tcCelular),ATC('-',ALLTRIM(tcCelular),1)+1)
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+ALLTRIM(lcTel)+":casa "
						ENDIF 	
					ELSE &&solo hay un internacional
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"fijo:"+ALLTRIM(tcCelular)+":casa "
					ENDIF 	
				ENDIF 	
			ELSE 
					
				lnNrocel = OCCURS('/',ALLTRIM(tcCelular))+1
				IF lnNrodig+lnNrocel = lnNroChar
					lnNroTel = OCCURS('/',ALLTRIM(tcCelular))+1
					FOR i = 1 TO lnNroTel
						lnPtel = ATC('/',ALLTRIM(tcCelular),i)
						lcTel = SUBSTR(ALLTRIM(tcCelular),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						lnPos = lnPtel+1
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":casa","")
					NEXT 
				ELSE	
					**cuando hay letras 
					lcTel = SUBSTR(ALLTRIM(tcCelular),1,lnPosichar-1)
					lcCad = SUBSTR(ALLTRIM(tcCelular),lnPosichar)
					lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+IIF(ATC("-",lcTel)>0,"movil:","fijo:")+lcTel+":casa "+lccad 
 					ENDIF 
			ENDIF 
		ENDIF 	
	ENDIF 
ENDIF 	
ENDPROC
PROCEDURE telefonosjson
LPARAMETERS tcTel_Res, tctel_of, tcCelular 

lcTelefono = '['
IF LEN(ALLTRIM(tcTel_Res))=7 OR (LEN(ALLTRIM(tcTel_Res))>7 AND ATC(' ',ALLTRIM(tcTel_Res))<=0)&&SOLO HAY UN TELEFONO FIJO
	IF ATC('-',ALLTRIM(tcTel_Res),1)=4
		lcTelefono = lcTelefono+'{123}"id":"TE1","value":"'+ALLTRIM(tcTel_Res)+'","obs":"CASA"}'
	ELSE
		IF ATC('-',ALLTRIM(tcTel_Res),1)<=0
			lcTelefono = lcTelefono+'{123}"id":"'+IIF(ATC("-",ALLTRIM(tcTel_Res))>0,'TE2','TE1')+'","value":"'+ALLTRIM(tcTel_Res)+'","obs":"CASA"}'
		ELSE 
			lcTel = SUBSTR(ALLTRIM(tcTel_Res),1,ATC('-',ALLTRIM(tcTel_Res),1)-1)
			*lcTelefono = "fijo:"+ALLTRIM(lcTel)
			lcTelefono = lcTelefono+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
			
			lcTel = SUBSTR(ALLTRIM(tcTel_Res),ATC('-',ALLTRIM(tcTel_Res),1)+1)
			*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+ALLTRIM(lcTel)+":casa"
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
		ENDIF 	
	ENDIF
ELSE
	IF LEN(ALLTRIM(tcTel_Res))>0 
		lnNroChar = LEN(ALLTRIM(tcTel_Res))
		lnNrodig = 0
		lnPosichar = 0
		FOR x = 1 TO lnNroChar
			lcchar = SUBSTR(ALLTRIM(tcTel_Res),x,1)
			IF ISDIGIT(lcchar)
				lnNrodig = lnNrodig+1
			ELSE 
				IF ISALPHA(lcchar) AND lnPosichar = 0
					lnPosichar = x
				ENDIF 	
			ENDIF 
		NEXT 
		lnNroesp = OCCURS(' ',ALLTRIM(tcTel_Res))
		IF lnNrodig+lnNroesp = lnNroChar
			lnNroTel = OCCURS(' ',ALLTRIM(tcTel_Res))+1
			FOR i = 1 TO lnNroTel
				lnPtel = ATC(' ',ALLTRIM(tcTel_Res),i)
				lcTel = SUBSTR(ALLTRIM(tcTel_Res),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
				lnPos = lnPtel+1
				*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":casa","")
				lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
			NEXT 
		ELSE 
			lnNrocel = OCCURS('-',ALLTRIM(tcTel_Res))
			IF lnNrodig+lnNrocel+lnNroesp = lnNroChar
				lnNroTel = OCCURS(' ',ALLTRIM(tcTel_Res))+1
				IF lnNroTel>0
					FOR i = 1 TO lnNroTel
						lnPtel = ATC(' ',ALLTRIM(tcTel_Res),i)
						lcTel = SUBSTR(ALLTRIM(tcTel_Res),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+IIF(ATC("-",lcTel)>0,"movil:"+lcTel,"fijo:"+lcTel)+IIF(i=lnNroTel,":casa","")
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"'+IIF(ATC("-",ALLTRIM(lcTel))>0,'TE2','TE1')+'","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
						lnPos = lnPtel+1
					NEXT 
				ELSE 
					IF OCCURS('-',ALLTRIM(tcTel_Res))=1 &&solo hay un celular 
						IF ATC('-',ALLTRIM(tcTel_Res),1)=4
							*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"movil:"+ALLTRIM(tcTel_Res)+":casa "
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE2","value":"'+ALLTRIM(tcTel_Res)+'","obs":"CASA"}'
						ELSE
							lcTel = SUBSTR(ALLTRIM(tcTel_Res),1,ATC('-',ALLTRIM(tcTel_Res),1)-1)
							*lcTelefono = "fijo:"+ALLTRIM(lcTel)
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
							
							lcTel = SUBSTR(ALLTRIM(tcTel_Res),ATC('-',ALLTRIM(tcTel_Res),1)+1)
							*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+ALLTRIM(lcTel)+":casa "
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
						ENDIF 	
					ELSE &&solo hay un internacional
						*lcTelefono = "fijo:"+ALLTRIM(tcTel_Res)+":casa "
						lcTelefono = lcTelefono+'{123}"id":"TE3","value":"'+ALLTRIM(tcTel_Res)+'","obs":"CASA"}'
					ENDIF 	
				ENDIF 	
			ELSE 
				lnNrocel = OCCURS('/',ALLTRIM(tcTel_Res))+1
				IF lnNrodig+lnNrocel = lnNroChar
					lnNroTel = OCCURS('/',ALLTRIM(tcTel_Res))+1
					FOR i = 1 TO lnNroTel
						lnPtel = ATC('/',ALLTRIM(tcTel_Res),i)
						lcTel = SUBSTR(ALLTRIM(tcTel_Res),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						lnPos = lnPtel+1
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":casa","")
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
					NEXT 
				ELSE	
					**cuando hay letras 
					lcTel = SUBSTR(ALLTRIM(tcTel_Res),1,lnPosichar-1)
					lcCad = SUBSTR(ALLTRIM(tcTel_Res),lnPosichar)
					IF !ALLTRIM(lcCad)=="NO TIENE"
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+IIF(ATC("-",lcTel)>0,"movil:","fijo:")+lcTel+":casa "+lccad 
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"'+IIF(ATC("-",ALLTRIM(lcTel))>0,'TE2','TE1')+'","value":"'+ALLTRIM(lcTel)+'","obs":"CASA '+lccad+'"}'
					ENDIF 	
				ENDIF 
			ENDIF 
		ENDIF 	
	ENDIF 
ENDIF 	
	
**telefono de oficina 
IF LEN(ALLTRIM(tctel_of))=7 OR (LEN(ALLTRIM(tctel_of))>7 AND ATC(' ',ALLTRIM(tctel_of))<=0)&&SOLO HAY UN TELEFONO FIJO
	IF ATC('-',ALLTRIM(tctel_of),1)=4
		*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"movil:"+ALLTRIM(tctel_of)+":oficina"
		lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE2","value":"'+ALLTRIM(tctel_of)+'","obs":"OFICINA"}'
	ELSE
		IF ATC('-',ALLTRIM(tctel_of),1)<=0
			*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+IIF(LEN(ALLTRIM(tctel_of))>0,IIF(ATC("-",ALLTRIM(tctel_of))>0,"movil:","fijo:")+ALLTRIM(tctel_of)+":oficina","")
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"'+IIF(ATC("-",ALLTRIM(tctel_of))>0,'TE2','TE1')+'","value":"'+ALLTRIM(tctel_of)+'","obs":"OFICINA"}'
		ELSE 
			lcTel = SUBSTR(ALLTRIM(tctel_of),1,ATC('-',ALLTRIM(tctel_of),1)-1)
			*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"fijo:"+ALLTRIM(lcTel)
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"OFICINA"}'
			
			lcTel = SUBSTR(ALLTRIM(tctel_of),ATC('-',ALLTRIM(tctel_of),1)+1)
			*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"fijo:"+ALLTRIM(lcTel)+":oficina"
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"OFICINA"}'
		ENDIF 	
	ENDIF
ELSE
	IF LEN(ALLTRIM(tctel_of))>0 
		lnNroChar = LEN(ALLTRIM(tctel_of))
		lnNrodig = 0
		lnPosichar = 0
		FOR x = 1 TO lnNroChar
			lcchar = SUBSTR(ALLTRIM(tctel_of),x,1)
			IF ISDIGIT(lcchar)
				lnNrodig = lnNrodig+1
			ELSE 
				IF ISALPHA(lcchar) AND lnPosichar = 0
					lnPosichar = x
				ENDIF 	
			ENDIF 
		NEXT 
		lnNroesp = OCCURS(' ',ALLTRIM(tctel_of))
		IF lnNrodig+lnNroesp = lnNroChar
			lnNroTel = OCCURS(' ',ALLTRIM(tctel_of))+1
			FOR i = 1 TO lnNroTel
				lnPtel = ATC(' ',ALLTRIM(tctel_of),i)
				lcTel = SUBSTR(ALLTRIM(tctel_of),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
				lnPos = lnPtel+1
				*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":oficina","")
				lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"OFICINA"}'
			NEXT 
		ELSE 
			lnNrocel = OCCURS('-',ALLTRIM(tctel_of))
			IF lnNrodig+lnNrocel+lnNroesp = lnNroChar
				lnNroTel = OCCURS(' ',ALLTRIM(tctel_of))+1
				IF lnNroTel>0
					FOR i = 1 TO lnNroTel
						lnPtel = ATC(' ',ALLTRIM(tctel_of),i)
						lcTel = SUBSTR(ALLTRIM(tctel_of),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+IIF(ATC("-",lcTel)>0,"movil:"+lcTel,"fijo:"+lcTel)+IIF(i=lnNroTel,":oficina","")
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"'+IIF(ATC("-",ALLTRIM(lcTel))>0,'TE2','TE1')+'","value":"'+ALLTRIM(lcTel)+'","obs":"OFICINA"}'
						lnPos = lnPtel+1
					NEXT 
				ELSE 
					IF OCCURS('-',ALLTRIM(tctel_of))=1 &&solo hay un celular 
						IF ATC('-',ALLTRIM(tctel_of),1)=4
							*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"movil:"+ALLTRIM(tctel_of)+":oficina "
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE2","value":"'+ALLTRIM(tctel_of)+'","obs":"OFICINA"}'
						ELSE
							lcTel = SUBSTR(ALLTRIM(tctel_of),1,ATC('-',ALLTRIM(tctel_of),1)-1)
							*lcTelefono = "fijo:"+ALLTRIM(lcTel)
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"OFICINA"}'
							
							lcTel = SUBSTR(ALLTRIM(tctel_of),ATC('-',ALLTRIM(tctel_of),1)+1)
							*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"fijo:"+ALLTRIM(lcTel)+":oficina "
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"OFICINA"}'
						ENDIF 	
					ELSE &&solo hay un internacional
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"fijo:"+ALLTRIM(tctel_of)+":oficina "
						lcTelefono = lcTelefono+'{123}"id":"TE3","value":"'+ALLTRIM(tctel_of)+'","obs":"OFICINA"}'
					ENDIF 	
				ENDIF 	
			ELSE 
				lnNrocel = OCCURS('/',ALLTRIM(tctel_of))+1
				IF lnNrodig+lnNrocel = lnNroChar
					lnNroTel = OCCURS('/',ALLTRIM(tctel_of))+1
					FOR i = 1 TO lnNroTel
						lnPtel = ATC('/',ALLTRIM(tctel_of),i)
						lcTel = SUBSTR(ALLTRIM(tctel_of),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						lnPos = lnPtel+1
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":oficina","")
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"OFICINA"}'
					NEXT 
				ELSE	
					**cuando hay letras 
					lcTel = SUBSTR(ALLTRIM(tctel_of),1,lnPosichar-1)
					lcCad = SUBSTR(ALLTRIM(tctel_of),lnPosichar)
					IF !ALLTRIM(lcCad)=="NO TIENE"
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':oficina,','')+IIF(ATC("-",lcTel)>0,"movil:","fijo:")+lcTel+":oficina "+lccad 
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"'+IIF(ATC("-",ALLTRIM(lcTel))>0,'TE2','TE1')+'","value":"'+ALLTRIM(lcTel)+'","obs":"OFICINA '+lccad+'"}'
					ENDIF 	
 				ENDIF 
			ENDIF 
		ENDIF 	
	ENDIF 
ENDIF 	

***celular 
IF LEN(ALLTRIM(tcCelular))=7 OR (LEN(ALLTRIM(tcCelular))>7 AND ATC(' ',ALLTRIM(tcCelular))<=0)&&SOLO HAY UN TELEFONO FIJO
	IF ATC('-',ALLTRIM(tcCelular),1)=4
		*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"movil:"+ALLTRIM(tcCelular)+":casa"
		lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE2","value":"'+ALLTRIM(tcCelular)+'","obs":"CASA"}'
	ELSE
		IF ATC('-',ALLTRIM(tcCelular),1)<=0
			*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+IIF(LEN(ALLTRIM(tcCelular))>0,IIF(ATC("-",ALLTRIM(tcCelular))>0,"movil:","fijo:")+ALLTRIM(tcCelular)+":casa","")
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"'+IIF(ATC("-",ALLTRIM(tcCelular))>0,'TE2','TE1')+'","value":"'+ALLTRIM(tcCelular)+'","obs":"CASA"}'
		ELSE 
			lcTel = SUBSTR(ALLTRIM(tcCelular),1,ATC('-',ALLTRIM(tcCelular),1)-1)
			*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"fijo:"+ALLTRIM(lcTel)
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE2","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
			
			lcTel = SUBSTR(ALLTRIM(tcCelular),ATC('-',ALLTRIM(tcCelular),1)+1)
			*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+ALLTRIM(lcTel)+":casa"
			lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE2","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
		ENDIF 	
	ENDIF
ELSE
	IF LEN(ALLTRIM(tcCelular))>0 
		lnNroChar = LEN(ALLTRIM(tcCelular))
		lnNrodig = 0
		lnPosichar = 0
		FOR x = 1 TO lnNroChar
			lcchar = SUBSTR(ALLTRIM(tcCelular),x,1)
			IF ISDIGIT(lcchar)
				lnNrodig = lnNrodig+1
			ELSE 
				IF ISALPHA(lcchar) AND lnPosichar = 0
					lnPosichar = x
				ENDIF 	
			ENDIF 
		NEXT 
		lnNroesp = OCCURS(' ',ALLTRIM(tcCelular))
		IF lnNrodig+lnNroesp = lnNroChar
			lnNroTel = OCCURS(' ',ALLTRIM(tcCelular))+1
			FOR i = 1 TO lnNroTel
				lnPtel = ATC(' ',ALLTRIM(tcCelular),i)
				lcTel = SUBSTR(ALLTRIM(tcCelular),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
				lnPos = lnPtel+1
				*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":casa","")
				lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
			NEXT 
		ELSE 
			lnNrocel = OCCURS('-',ALLTRIM(tcCelular))
			IF lnNrodig+lnNrocel+lnNroesp = lnNroChar
				lnNroTel = OCCURS(' ',ALLTRIM(tcCelular))+1
				IF lnNroTel>0
					FOR i = 1 TO lnNroTel
						lnPtel = ATC(' ',ALLTRIM(tcCelular),i)
						lcTel = SUBSTR(ALLTRIM(tcCelular),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+IIF(ATC("-",lcTel)>0,"movil:"+lcTel,"fijo:"+lcTel)+IIF(i=lnNroTel,":casa","")
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"'+IIF(ATC("-",ALLTRIM(lcTel))>0,'TE2','TE1')+'","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
						lnPos = lnPtel+1
					NEXT 
				ELSE 
					IF OCCURS('-',ALLTRIM(tcCelular))=1 &&solo hay un celular 
						IF ATC('-',ALLTRIM(tcCelular),1)=4
							*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"movil:"+ALLTRIM(tcCelular)+":casa "
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE2","value":"'+ALLTRIM(tctel_of)+'","obs":"CASA"}'
						ELSE
							lcTel = SUBSTR(ALLTRIM(tcCelular),1,ATC('-',ALLTRIM(tcCelular),1)-1)
							*lcTelefono = "fijo:"+ALLTRIM(lcTel)
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
							
							lcTel = SUBSTR(ALLTRIM(tcCelular),ATC('-',ALLTRIM(tcCelular),1)+1)
							*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+ALLTRIM(lcTel)+":casa "
							lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
						ENDIF 	
					ELSE &&solo hay un internacional
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+',','')+"fijo:"+ALLTRIM(tcCelular)+":casa "
						lcTelefono = lcTelefono+'{123}"id":"TE3","value":"'+ALLTRIM(tctel_of)+'","obs":"CASA"}'
					ENDIF 	
				ENDIF 	
			ELSE 
					
				lnNrocel = OCCURS('/',ALLTRIM(tcCelular))+1
				IF lnNrodig+lnNrocel = lnNroChar
					lnNroTel = OCCURS('/',ALLTRIM(tcCelular))+1
					FOR i = 1 TO lnNroTel
						lnPtel = ATC('/',ALLTRIM(tcCelular),i)
						lcTel = SUBSTR(ALLTRIM(tcCelular),IIF(i=1,1,lnPos),IIF(lnPtel=0,100,lnPtel))
						lnPos = lnPtel+1
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+"fijo:"+lcTel+IIF(i=lnNroTel,":casa","")
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"TE1","value":"'+ALLTRIM(lcTel)+'","obs":"CASA"}'
					NEXT 
				ELSE	
					**cuando hay letras 
					lcTel = SUBSTR(ALLTRIM(tcCelular),1,lnPosichar-1)
					lcCad = SUBSTR(ALLTRIM(tcCelular),lnPosichar)
					IF !ALLTRIM(lcCad)=="NO TIENE"
						*lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>0,lcTelefono+':casa,','')+IIF(ATC("-",lcTel)>0,"movil:","fijo:")+lcTel+":casa "+lccad 
						lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+',',lcTelefono)+'{123}"id":"'+IIF(ATC("-",ALLTRIM(lcTel))>0,'TE2','TE1')+'","value":"'+ALLTRIM(lcTel)+'","obs":"CASA '+lccad+'"}'
					ENDIF 	
 				ENDIF 
			ENDIF 
		ENDIF 	
	ENDIF 
ENDIF 	

lcTelefono = IIF(LEN(ALLTRIM(lcTelefono))>1,lcTelefono+']',"")



ENDPROC
PROCEDURE tipodoc
LPARAMETERS tcTipo_doc, tnTipo

***validacion tipo de documento	

IF LEN(ALLTRIM(tcTipo_doc))=0	
	DO CASE 
 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 10 
 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
 				
 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
 					lcTipo_doc ='31'
 				ELSE  
	 				lcCadAnio = SUBSTR(lcNit,1,2)
	 				lcCadMes = SUBSTR(lcNit,3,2)
	 				lcCadDia = SUBSTR(lcNit,5,2)
	 				
	 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
	 					lcTipo_doc ='12'
	 				else
	 					lcTipo_doc ='31'
	 				ENDIF 	
 				ENDIF 
 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 9 
 				lcTipo_doc ='31'
 			
 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 10 
 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
 				
 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
 					lcTipo_doc ='31'
 				ELSE  
	 				lcCadAnio = SUBSTR(lcNit,1,2)
	 				lcCadMes = SUBSTR(lcNit,3,2)
	 				lcCadDia = SUBSTR(lcNit,5,2)
	 				
	 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
	 					lcTipo_doc ='12'
	 				else
	 					lcTipo_doc ='31'
	 				ENDIF 	
 				ENDIF 
 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 9 
 				IF LEFT(lcNit,2)= '91'
 					lcTipo_doc ='13'
 				ELSE 
	 				lcTipo_doc ='31'
	 			ENDIF 	
 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))< 9 
 				lcTipo_doc ='13'
 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 10 
 				lcTipo_doc ='13'
 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 9 
 				IF LEN(ALLTRIM(NITS.APELLIDO)) > 0 
 					lcTipo_doc = '13'
 				ENDIF 
 			CASE VAL(LEFT(lcNit,1))= 8 AND LEN(ALLTRIM(lcNit))< 9 
 				IF tnTipo = 1
	 				IF LEN(ALLTRIM(NITS.APELLIDO)) > 0 
	 					lcTipo_doc = '13'
	 				ENDIF
	 			ELSE 
	 				IF LEN(ALLTRIM(FIADORES.APELLIDO)) > 0 
	 					lcTipo_doc = '13'
	 				ENDIF
	 			ENDIF 	
 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))<= 8
 				IF tnTipo = 1
	 				IF LEN(ALLTRIM(NITS.APELLIDO)) > 0 
	 					lcTipo_doc = '13'
	 				ENDIF
	 			ELSE
	 				IF LEN(ALLTRIM(FIADORES.APELLIDO)) > 0 
	 					lcTipo_doc = '13'
	 				ENDIF
	 			ENDIF 	
 		ENDCASE 			
ELSE 
	IF tnTipo = 1
		DO CASE 
			CASE LEN(ALLTRIM(NITS.NOMBRE))>0 AND LEN(ALLTRIM(NITS.APELLIDO))>0 AND ALLTRIM(tcTipo_doc)=='31'
				DO CASE 
		 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 10 
		 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
		 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
		 				
		 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
		 					lcTipo_doc ='31'
		 				ELSE  
			 				lcCadAnio = SUBSTR(lcNit,1,2)
			 				lcCadMes = SUBSTR(lcNit,3,2)
			 				lcCadDia = SUBSTR(lcNit,5,2)
			 				
			 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
			 					lcTipo_doc ='12'
			 				else
			 					lcTipo_doc ='31'
			 				ENDIF
			 			ENDIF 	 	
		 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 9 
		 				lcTipo_doc ='31'
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 10 
		 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
		 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),9))
		 				
		 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
		 					lcTipo_doc ='31'
		 				ELSE  
			 				lcCadAnio = SUBSTR(lcNit,1,2)
			 				lcCadMes = SUBSTR(lcNit,3,2)
			 				lcCadDia = SUBSTR(lcNit,5,2)
			 				
			 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
			 					lcTipo_doc ='12'
			 				else
			 					lcTipo_doc ='31'
			 				ENDIF 	
			 			ENDIF 	
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 9 
		 				IF LEFT(lcNit,2)= '91'
		 					lcTipo_doc ='13'
		 				ELSE 
			 				lcTipo_doc ='31'
			 			ENDIF 	
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))< 9 
		 				lcTipo_doc ='13'
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 10 
		 				lcTipo_doc ='13'
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 9 
		 				IF LEN(ALLTRIM(NITS.NOMBRE)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF 
		 			CASE VAL(LEFT(lcNit,1))= 8 AND LEN(ALLTRIM(lcNit))< 9 
		 				IF LEN(ALLTRIM(NITS.NOMBRE)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))<= 8
		 				IF LEN(ALLTRIM(NITS.NOMBRE)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF
		 		ENDCASE
		
			CASE LEN(ALLTRIM(NITS.NOMBRE))>0 AND LEN(ALLTRIM(NITS.APELLIDO))=0 AND !ALLTRIM(tcTipo_doc)=='31'
				DO CASE 
		 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 10 
		 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
		 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
		 				
		 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
		 					lcTipo_doc ='31'
		 				ELSE  
			 				lcCadAnio = SUBSTR(lcNit,1,2)
			 				lcCadMes = SUBSTR(lcNit,3,2)
			 				lcCadDia = SUBSTR(lcNit,5,2)
			 				
			 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
			 					lcTipo_doc ='12'
			 				else
			 					lcTipo_doc ='31'
			 				ENDIF 	
			 			ENDIF 	
		 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 9 
		 				lcTipo_doc ='31'
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 10 
		 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
		 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
		 				
		 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
		 					lcTipo_doc ='31'
		 				ELSE  
			 				lcCadAnio = SUBSTR(lcNit,1,2)
			 				lcCadMes = SUBSTR(lcNit,3,2)
			 				lcCadDia = SUBSTR(lcNit,5,2)
			 				
			 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
			 					lcTipo_doc ='12'
			 				else
			 					lcTipo_doc ='31'
			 				ENDIF 	
			 			ENDIF 	
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 9 
		 				IF LEFT(lcNit,2)= '91'
		 					lcTipo_doc ='13'
		 				ELSE 
			 				lcTipo_doc ='31'
			 			ENDIF 	
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))< 9 
		 				lcTipo_doc ='13'
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 10 
		 				lcTipo_doc ='13'
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 9 
		 				IF LEN(ALLTRIM(NITS.NOMBRE)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF 
		 			CASE VAL(LEFT(lcNit,1))= 8 AND LEN(ALLTRIM(lcNit))< 9 
		 				IF LEN(ALLTRIM(NITS.NOMBRE)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))<= 8
		 				IF LEN(ALLTRIM(NITS.NOMBRE)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF
		 		ENDCASE
			CASE LEN(ALLTRIM(NITS.NOMBRE))>0 AND LEN(ALLTRIM(NITS.APELLIDO))>0 AND ALLTRIM(tcTipo_doc)=='13'
				DO CASE 
		 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 10 
		 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
		 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
		 				
		 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
		 					lcTipo_doc ='31'
		 				ELSE  
		 					lcCadAnio = SUBSTR(lcNit,1,2)
			 				lcCadMes = SUBSTR(lcNit,3,2)
			 				lcCadDia = SUBSTR(lcNit,5,2)
			 				
			 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
			 					lcTipo_doc ='12'
			 				else
			 					lcTipo_doc ='31'
			 				ENDIF 	
			 			ENDIF 	
		 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 9 
		 				lcTipo_doc ='31'
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 10 
		 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
		 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
		 				
		 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
		 					lcTipo_doc ='31'
		 				ELSE  
			 				lcCadAnio = SUBSTR(lcNit,1,2)
			 				lcCadMes = SUBSTR(lcNit,3,2)
			 				lcCadDia = SUBSTR(lcNit,5,2)
			 				
			 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
			 					lcTipo_doc ='12'
			 				else
			 					lcTipo_doc ='31'
			 				ENDIF 
			 			ENDIF 		
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 9 
		 				IF LEFT(lcNit,2)= '91'
		 					lcTipo_doc ='13'
		 				ELSE 
			 				lcTipo_doc ='31'
			 			ENDIF 	
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))< 9 
		 				lcTipo_doc ='13'
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 10 
		 				lcTipo_doc ='13'
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 9 
		 				IF LEN(ALLTRIM(NITS.NOMBRE)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF 
		 			CASE VAL(LEFT(lcNit,1))= 8 AND LEN(ALLTRIM(lcNit))< 9 
		 				IF LEN(ALLTRIM(NITS.NOMBRE)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))<= 8
		 				IF LEN(ALLTRIM(NITS.NOMBRE)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF
		 		ENDCASE
		ENDCASE 
	ELSE
		IF LEN(ALLTRIM(FIADORES.NOMBRE))>0 AND LEN(ALLTRIM(FIADORES.APELLIDO))>0 AND ALLTRIM(tcTipo_doc)=='31'
			DO CASE 
	 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 10 
	 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
	 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
	 				
	 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
	 					lcTipo_doc ='31'
	 				ELSE  
		 				lcCadAnio = SUBSTR(lcNit,1,2)
		 				lcCadMes = SUBSTR(lcNit,3,2)
		 				lcCadDia = SUBSTR(lcNit,5,2)
		 				
		 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
		 					lcTipo_doc ='12'
		 				else
		 					lcTipo_doc ='31'
		 				ENDIF 	
		 			ENDIF 	
	 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 9 
	 				lcTipo_doc ='31'
	 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 10 
	 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
	 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
	 				
	 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
	 					lcTipo_doc ='31'
	 				ELSE  
		 				lcCadAnio = SUBSTR(lcNit,1,2)
		 				lcCadMes = SUBSTR(lcNit,3,2)
		 				lcCadDia = SUBSTR(lcNit,5,2)
		 				
		 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
		 					lcTipo_doc ='12'
		 				else
		 					lcTipo_doc ='31'
		 				ENDIF 
		 			ENDIF 		
	 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 9 
	 				IF LEFT(lcNit,2)= '91'
	 					lcTipo_doc ='13'
	 				ELSE 
		 				lcTipo_doc ='31'
		 			ENDIF 	
	 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))< 9 
	 				lcTipo_doc ='13'
	 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 10 
	 				lcTipo_doc ='13'
	 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 9 
	 				IF LEN(ALLTRIM(FIADORES.APELLIDO)) > 0 
	 					lcTipo_doc = '13'
	 				ENDIF 
	 			CASE VAL(LEFT(lcNit,1))= 8 AND LEN(ALLTRIM(lcNit))< 9 
	 				IF LEN(ALLTRIM(FIADORES.APELLIDO)) > 0 
	 					lcTipo_doc = '13'
	 				ENDIF
	 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))<= 8
	 				IF LEN(ALLTRIM(FIADORES.APELLIDO)) > 0 
	 					lcTipo_doc = '13'
	 				ENDIF
	 		ENDCASE
		ELSE
			IF LEN(ALLTRIM(FIADORES.NOMBRE))>0 AND LEN(ALLTRIM(FIADORES.APELLIDO))=0 AND !ALLTRIM(tcTipo_doc)=='31'
				DO CASE 
		 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 10 
		 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
		 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
		 				
		 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
		 					lcTipo_doc ='31'
		 				ELSE  
			 				lcCadAnio = SUBSTR(lcNit,1,2)
			 				lcCadMes = SUBSTR(lcNit,3,2)
			 				lcCadDia = SUBSTR(lcNit,5,2)
			 				
			 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
			 					lcTipo_doc ='12'
			 				else
			 					lcTipo_doc ='31'
			 				ENDIF 	
			 			ENDIF 	
		 			CASE LEFT(lcNit,1)= '8' AND LEN(ALLTRIM(lcNit))= 9 
		 				lcTipo_doc ='31'
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 10 
		 				lcDv = RIGHT(ALLTRIM(lcNit),1)
 				
		 				lcDigito_ver = thisform.digito_ver(SUBSTR(ALLTRIM(lcNit),1,9))
		 				
		 				IF ALLTRIM(lcDv)==ALLTRIM(lcDigito_ver) 
		 					lcTipo_doc ='31'
		 				ELSE  
			 				lcCadAnio = SUBSTR(lcNit,1,2)
			 				lcCadMes = SUBSTR(lcNit,3,2)
			 				lcCadDia = SUBSTR(lcNit,5,2)
			 				
			 				IF BETWEEN(VAL(lcCadAnio),80,99) AND BETWEEN(VAL(lcCadMes),1,12) AND BETWEEN(VAL(lcCadDia),1,31)
			 					lcTipo_doc ='12'
			 				else
			 					lcTipo_doc ='31'
			 				ENDIF 
			 			ENDIF 		
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))= 9 
		 				IF LEFT(lcNit,2)= '91'
		 					lcTipo_doc ='13'
		 				ELSE 
			 				lcTipo_doc ='31'
			 			ENDIF 	
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))< 9 
		 				lcTipo_doc ='13'
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 10 
		 				lcTipo_doc ='13'
		 			CASE VAL(LEFT(lcNit,1))< 8 AND LEN(ALLTRIM(lcNit))= 9 
		 				IF LEN(ALLTRIM(FIADORES.APELLIDO)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF 
		 			CASE VAL(LEFT(lcNit,1))= 8 AND LEN(ALLTRIM(lcNit))< 9 
		 				IF LEN(ALLTRIM(FIADORES.APELLIDO)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF
		 			CASE LEFT(lcNit,1)= '9' AND LEN(ALLTRIM(lcNit))<= 8
		 				IF LEN(ALLTRIM(FIADORES.APELLIDO)) > 0 
		 					lcTipo_doc = '13'
		 				ENDIF
		 		ENDCASE
			ENDIF 
		ENDIF
	ENDIF 	
ENDIF

**DEFINICION DE GENERO
IF !lcTipo_doc =="31"
	IF BETWEEN(VAL(lcNit),20000000,70000000)
		IF BETWEEN(VAL(lcNit),13000000,14000000)
			lcSexo = "M"
		ELSE 
			lcSexo = "F"
		ENDIF 	
	ENDIF 
ELSE 
	lcSexo = "E"	
ENDIF 

ENDPROC
PROCEDURE via_ppal
LPARAMETERS lcCadena_Direccion

DO CASE 
	CASE LEFT(lcCadena_Direccion,13)="ANILLO BALCON"
		*lcViaPPal = "ANILLO DEL BALCON DEL TEJAR"
		lcViaPPal = "AVIAL"
		lnViaPPal = 3
		thisform.eje_vial(lcCadena_Direccion,"ANILLO BALCON") 
		
		IF ATC("TEJAR",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 
		
	CASE LEFT(lcCadena_Direccion,11)="ANILLO VIAL"
		*lcViaPPal = "ANILLO VIAL"
		lcViaPPal = "AVIAL"
		lnViaPPal = 4
		
		lcCadena_Direccion = STRTRAN(lcCadena_Direccion,"FLO-GIRON","FLO/GIRON")
		
		thisform.eje_vial(lcCadena_Direccion,"ANILLO VIAL") 
		
	CASE LEFT(lcCadena_Direccion,9)="AUT A PTA"
		*lcViaPPal = "AUTOPISTA  A PIEDECUESTA"
		lcViaPPal = "AUT"
		lnViaPPal = 5
	
	CASE LEFT(lcCadena_Direccion,15)="AUT A P/TA KM 7"
		*lcViaPPal = "AUTOPISTA  A PIEDECUESTA KM 7 VIA MANTILLA 200"
		lcViaPPal = "AUT"
		lnViaPPal = 100
		thisform.eje_vial(lcCadena_Direccion,"AUT A P/TA KM 7") 
		
		IF ATC("MANTILLA",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 
			
	CASE LEFT(lcCadena_Direccion,20)="AUT B/MANGA F/BLANCA"
		*lcViaPPal = "BUCARAMANGA/FLORIDABLANCA"
		lcViaPPal = "AUT"
		lnViaPPal = 6
		
		thisform.eje_vial(lcCadena_Direccion,"AUT B/MANGA F/BLANCA") 
		
	CASE LEFT(lcCadena_Direccion,12)="AUT F/BLANCA"
		*lcViaPPal = "AUTOPISTA FLORIDA"
		lcViaPPal = "AUT"
		lnViaPPal = 7
		
		thisform.eje_vial(lcCadena_Direccion,"AUT F/BLANCA") 
	
	CASE LEFT(lcCadena_Direccion,11)="AUTP F/BLCA"
		*lcViaPPal = "AUTOPISTA FLORIDA"
		lcViaPPal = "AUT"
		lnViaPPal = 7
		
		thisform.eje_vial(lcCadena_Direccion,"AUTP F/BLCA") 
			
	CASE LEFT(lcCadena_Direccion,11)="AUT FLORIDA"
		*lcViaPPal = "AUTOPISTA FLORIDA"
		lcViaPPal = "AUT"
		lnViaPPal = 7					 
		
		thisform.eje_vial(lcCadena_Direccion,"AUT FLORIDA") 
		
	CASE LEFT(lcCadena_Direccion,12)="AUTOP F/BLCA"
		*lcViaPPal = "AUTOPISTA FLORIDA"
		lcViaPPal = "AUT"
		lnViaPPal = 7
		
		thisform.eje_vial(lcCadena_Direccion,"AUTOP F/BLCA") 
	
	CASE LEFT(lcCadena_Direccion,18)= "AVN BELLAVISTA"
		*lcViaPPal = "AV. BELLAVISTA"
		lcViaPPal = "AV"
		lnViaPPal = 14
		thisform.eje_vial(lcCadena_Direccion,"AVN BELLAVISTA") 
		
		IF ATC("BELLAVISTA",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 	
		
	CASE LEFT(lcCadena_Direccion,10)="AV BUCAROS"
		*lcViaPPal = "AV. LOS BUCAROS"
		lcViaPPal = "AV"
		lnViaPPal = 23
		thisform.eje_vial(lcCadena_Direccion,"AV BUCAROS")
		
	CASE LEFT(lcCadena_Direccion,20)="AV GONZALEZ VALENCIA"
		*lcViaPPal = "AV. GONZALEZ VALENCIA"
		lcViaPPal = "AV"
		lnViaPPal = 19
		thisform.eje_vial(lcCadena_Direccion,"AV GONZALEZ VALENCIA")
		
	CASE LEFT(lcCadena_Direccion,10)="AVN Q/SECA"
		*lcViaPPal = "AV. QUEBRADA SECA"
		lcViaPPal = "AV"
		lnViaPPal = 26	
		thisform.eje_vial(lcCadena_Direccion,"AVN Q/SECA")
		
	CASE LEFT(lcCadena_Direccion,9)="AV Q/SECA"
		*lcViaPPal = "AV. QUEBRADA SECA"
		lcViaPPal = "AV"
		lnViaPPal = 26
		
		thisform.eje_vial(lcCadena_Direccion,"AV Q/SECA")
	
	CASE LEFT(lcCadena_Direccion,16)="AV QUEBRADA SECA"
		*lcViaPPal = "AV. QUEBRADA SECA"
		lcViaPPal = "AV"
		lnViaPPal = 26
		
		thisform.eje_vial(lcCadena_Direccion,"AV QUEBRADA SECA")
			
	CASE LEFT(lcCadena_Direccion,4)="AVDA"
		lcViaPPal = "AV"
		lnViaPPal = 11
		thisform.eje_vial(lcCadena_Direccion,"AVDA")
		
	CASE LEFT(lcCadena_Direccion,7)="AVENIDA"
		lcViaPPal = "AV"
		lnViaPPal = 11
		thisform.eje_vial(lcCadena_Direccion,"AVENIDA")
		
	CASE LEFT(lcCadena_Direccion,20)="AVN BALCON DEL TEJAR"
		*lcViaPPal = "AV. EL TEJAR"
		lcViaPPal = "AV"
		lnViaPPal = 18	
		thisform.eje_vial(lcCadena_Direccion,"AVN BALCON DEL TEJAR")
			
	CASE LEFT(lcCadena_Direccion,12)="AVN EL TEJAR"
		*lcViaPPal = "AV. EL TEJAR"
		lcViaPPal = "AV"
		lnViaPPal = 18	
		thisform.eje_vial(lcCadena_Direccion,"AVN EL TEJAR")
		
	CASE LEFT(lcCadena_Direccion,20)="AVN G/ZALEZ VALENCIA"
		*lcViaPPal = "AV. GONZALEZ VALENCIA"
		lcViaPPal = "AV"
		lnViaPPal = 19
		thisform.eje_vial(lcCadena_Direccion,"AVN G/ZALEZ VALENCIA")
		
	CASE LEFT(lcCadena_Direccion,21)="AVN GONZALEZ VALENCIA"
		*lcViaPPal = "AV. GONZALEZ VALENCIA"
		lcViaPPal = "AV"
		lnViaPPal = 19	
		thisform.eje_vial(lcCadena_Direccion,"AVN GONZALEZ VALENCIA")
		
	CASE LEFT(lcCadena_Direccion,14)="AVN GUAYACANES"
		*lcViaPPal = "AV. GUAYACANES"
		lcViaPPal = "AV"
		lnViaPPal = 20
		thisform.eje_vial(lcCadena_Direccion,"AVN GUAYACANES")
		
	CASE LEFT(lcCadena_Direccion,13)="AVN LA ROSITA"
		*lcViaPPal = "AV. LA ROSITA"
		lcViaPPal = "AV"
		lnViaPPal = 21
		thisform.eje_vial(lcCadena_Direccion,"AVN LA ROSITA")
		
	CASE LEFT(lcCadena_Direccion,20)="AVN LOS BUCAROS ESTE"
		*lcViaPPal = "AV. LOS BUCAROS ESTE"
		lcViaPPal = "AV"
		lnViaPPal = 24			
		thisform.eje_vial(lcCadena_Direccion,"AVN LOS BUCAROS ESTE")
		
	CASE LEFT(lcCadena_Direccion,16)="AVN BUCAROS ESTE"
		*lcViaPPal = "AV. LOS BUCAROS ESTE"
		lcViaPPal = "AV"
		lnViaPPal = 24				
		thisform.eje_vial(lcCadena_Direccion,"AVN BUCAROS ESTE")
		 
	CASE LEFT(lcCadena_Direccion,21)="AVN LOS BUCAROS OESTE"
		*lcViaPPal = "AV. LOS BUCAROS OESTE"
		lcViaPPal = "AV"
		lnViaPPal = 25	
		thisform.eje_vial(lcCadena_Direccion,"AVN LOS BUCAROS OESTE")
					
	CASE LEFT(lcCadena_Direccion,15)="AVN LOS BUCAROS"
		*lcViaPPal = "AV. LOS BUCAROS"
		lcViaPPal = "AV"
		lnViaPPal = 23		
		thisform.eje_vial(lcCadena_Direccion,"AVN LOS BUCAROS")
	
	CASE LEFT(lcCadena_Direccion,20)="AVN PORTON DEL TEJAR"
		*lcViaPPal = "AV. EL TEJAR"
		lcViaPPal = "AV"
		lnViaPPal = 18						
		thisform.eje_vial(lcCadena_Direccion,"AVN PORTON DEL TEJAR")
			
	CASE LEFT(lcCadena_Direccion,16)="AVN PORTON TEJAR"
		*lcViaPPal = "AV. EL TEJAR"
		lcViaPPal = "AV"
		lnViaPPal = 18						
		thisform.eje_vial(lcCadena_Direccion,"AVN PORTON TEJAR")
	
	CASE LEFT(lcCadena_Direccion,12)="AVN EL TEJAR"
		*lcViaPPal = "AV. EL TEJAR"
		lcViaPPal = "AV"
		lnViaPPal = 18						
		thisform.eje_vial(lcCadena_Direccion,"AVN EL TEJAR")
	
	CASE LEFT(lcCadena_Direccion,18)= "AVN GUAYACANES CLL"
		*lcViaPPal = "AV. GUAYACANES"
		lcViaPPal = "AV"
		lnViaPPal = 20
		thisform.eje_vial(lcCadena_Direccion,"AVN GUAYACANES CLL") 
		
		IF ATC("GUAYACANES",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 	
	
	CASE LEFT(lcCadena_Direccion,10)= "AVN EL RIO"
		*lcViaPPal = "AV. EL RIO"
		lcViaPPal = "AV"
		lnViaPPal = 66
		thisform.eje_vial(lcCadena_Direccion,"AVN EL RIO") 
		
		IF ATC("RIO",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF
	
	CASE LEFT(lcCadena_Direccion,7)= "AVN CLL"
		*lcViaPPal = "AV. CL"
		lcViaPPal = "AV"
		lnViaPPal = 88
		thisform.eje_vial(lcCadena_Direccion,"AVN CLL") 
		
		IF ATC("CLL",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF
	
	CASE LEFT(lcCadena_Direccion,12)= "AVN VILLALUZ"
		*lcViaPPal = "AV. VILLALUZ"
		lcViaPPal = "AV"
		lnViaPPal = 89
		thisform.eje_vial(lcCadena_Direccion,"AVN VILLALUZ") 
		
		IF ATC("VILLALUZ",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 
			
	CASE LEFT(lcCadena_Direccion,16)="AVN TRV ORIENTAL"
		*lcViaPPal = "TRASVERSAL ORIENTAL"
		lcViaPPal = "TV"
		lnViaPPal = 60
		thisform.eje_vial(lcCadena_Direccion,"AVN TRV ORIENTAL") 
		
		IF ATC("ORIENTAL",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 
	
	CASE LEFT(lcCadena_Direccion,17)="AVN UNIVERSITARIA"
		*lcViaPPal = "AV. UNIVERSITARIA"
		lcViaPPal = "AV"
		lnViaPPal = 90
		thisform.eje_vial(lcCadena_Direccion,"AVN UNIVERSITARIA") 
		
		IF ATC("UNIVERSITARIA",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 
	
	CASE LEFT(lcCadena_Direccion,10)="AVN METROP"
		*lcViaPPal = "AV. METROPOLITANA"
		lcViaPPal = "AV"
		lnViaPPal = 91
		thisform.eje_vial(lcCadena_Direccion,"AVN METROP") 
		
		IF ATC("METROP",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 
	
	CASE LEFT(lcCadena_Direccion,11)="AVN BUCAROS"
		*lcViaPPal = "AV. BUCAROS"
		lcViaPPal = "AV"
		lnViaPPal = 29
		thisform.eje_vial(lcCadena_Direccion,"AVN BUCAROS") 
		
		IF ATC("BUCAROS",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 
	
	CASE LEFT(lcCadena_Direccion,6)="AVN OB"
		*lcViaPPal = "AV. OB"
		lcViaPPal = "AV"
		lnViaPPal = 92
		thisform.eje_vial(lcCadena_Direccion,"AVN OB") 
		
		IF ATC("OB",lcEjevial1)>0
			lcEjevial1 = ''
		ENDIF 
						
	CASE LEFT(lcCadena_Direccion,13)="AVN SANTANDER"
		*lcViaPPal = "BV. SANTANDER"
		lcViaPPal = "BLV"
		lnViaPPal = 34						
		thisform.eje_vial(lcCadena_Direccion,"AVN SANTANDER") 
	
	CASE LEFT(lcCadena_Direccion,14)="AVN LIBERTADOR"
		*lcViaPPal = "AV. LIBERTADOR"
		lcViaPPal = "AV"
		lnViaPPal = 93					
		thisform.eje_vial(lcCadena_Direccion,"AVN LIBERTADOR") 
			
	CASE LEFT(lcCadena_Direccion,3)="AVN"
		*lcViaPPal = "AV."
		lcViaPPal = "AV"
		lnViaPPal = 11					
		thisform.eje_vial(lcCadena_Direccion,"AVN")
	
	CASE LEFT(lcCadena_Direccion,3)="ANV"
		*lcViaPPal = "AV."
		lcViaPPal = "AV"
		lnViaPPal = 11					
		thisform.eje_vial(lcCadena_Direccion,"ANV")
		
	CASE LEFT(lcCadena_Direccion,16)="BOULEVAR BOLIVAR"
		*lcViaPPal = "BV. BOLIVAR"
		lcViaPPal = "BLV"
		lnViaPPal = 32						
		thisform.eje_vial(lcCadena_Direccion,"BOULEVAR BOLIVAR") 
									
	CASE LEFT(lcCadena_Direccion,2)="CR"
		*lcViaPPal = "CARRERA"
		lcViaPPal = "CR"
		lnViaPPal = 45
		thisform.eje_vial(lcCadena_Direccion,"CR") 
		
	CASE LEFT(lcCadena_Direccion,3)="CRA"
		*lcViaPPal = "CARRERA"
		lcViaPPal = "CR"
		lnViaPPal = 45
		thisform.eje_vial(lcCadena_Direccion,"CRA") 
	
	CASE LEFT(lcCadena_Direccion,3)="Cra"
		*lcViaPPal = "CARRERA"
		lcViaPPal = "CR"
		lnViaPPal = 45
		thisform.eje_vial(lcCadena_Direccion,"CRA") 
			
	CASE LEFT(lcCadena_Direccion,7)="CARRERA"
		*lcViaPPal = "CARRERA"
		lcViaPPal = "CR"
		lnViaPPal = 45	
		thisform.eje_vial(lcCadena_Direccion,"CARRERA") 
	
	CASE LEFT(lcCadena_Direccion,15)="AVENIDA CARRERA"
		*lcViaPPal = "CARRERA"
		lcViaPPal = "CR"
		lnViaPPal = 45	
		thisform.eje_vial(lcCadena_Direccion,"AVENIDA CARRERA") 
	
	CASE LEFT(lcCadena_Direccion,7)="AVN CRA"
		*lcViaPPal = "CARRERA"
		lcViaPPal = "CR"
		lnViaPPal = 45	
		thisform.eje_vial(lcCadena_Direccion,"AVN CRA") 
									
	CASE LEFT(lcCadena_Direccion,2)="CL"
		*lcViaPPal = "CALLE"
		lcViaPPal = "CL"
		lnViaPPal = 43	
		thisform.eje_vial(lcCadena_Direccion,"CL") 
		
	CASE LEFT(lcCadena_Direccion,3)="CLL"
		*lcViaPPal = "CALLE"
		lcViaPPal = "CL"
		lnViaPPal = 43	
		thisform.eje_vial(lcCadena_Direccion,"CLL") 
	
	CASE LEFT(lcCadena_Direccion,3)="Cll"
		*lcViaPPal = "CALLE"
		lcViaPPal = "CL"
		lnViaPPal = 43	
		thisform.eje_vial(lcCadena_Direccion,"CLL") 
	
	CASE LEFT(lcCadena_Direccion,10)="CALLE REAL"
		*lcViaPPal = "CALLE REAL"
		lcViaPPal = "CL"
		lnViaPPal = 44	
		thisform.eje_vial(lcCadena_Direccion,"CALLE REAL") 
			
	CASE LEFT(lcCadena_Direccion,5)="CALLE"
		*lcViaPPal = "CALLE"
		lcViaPPal = "CL"
		lnViaPPal = 43	
		thisform.eje_vial(lcCadena_Direccion,"CALLE") 
	
	CASE LEFT(lcCadena_Direccion,7)="CIRCUNV"
		*lcViaPPal = "CIRCUNVALAR"
		lcViaPPal = "CRV"
		lnViaPPal = 47
		thisform.eje_vial(lcCadena_Direccion,"CIRCUNV") 
	
	CASE LEFT(lcCadena_Direccion,7)="CIRCULV"
		*lcViaPPal = "CIRCUNVALAR"
		lcViaPPal = "CRV"
		lnViaPPal = 47
		thisform.eje_vial(lcCadena_Direccion,"CIRCULV") 
			
	CASE LEFT(lcCadena_Direccion,4)="CIRC"
		*lcViaPPal = "CIRCUNVALAR"
		lcViaPPal = "CRV"
		lnViaPPal = 47
		thisform.eje_vial(lcCadena_Direccion,"CIRC") 
	
	CASE LEFT(lcCadena_Direccion,4)="CIRV"
		*lcViaPPal = "CIRCUNVALAR"
		lcViaPPal = "CRV"
		lnViaPPal = 47
		thisform.eje_vial(lcCadena_Direccion,"CIRV") 
		
	CASE LEFT(lcCadena_Direccion,7)="CINCUNV"
		*lcViaPPal = "CIRCUNVALAR"
		lcViaPPal = "CRV"
		lnViaPPal = 47
		thisform.eje_vial(lcCadena_Direccion,"CINCUNV") 
				
	CASE LEFT(lcCadena_Direccion,8)="CIRCULAR"
		*lcViaPPal = "CIRCUNVALAR"
		lcViaPPal = "CRV"
		lnViaPPal = 47
		thisform.eje_vial(lcCadena_Direccion,"CIRCULAR") 
	
	CASE LEFT(lcCadena_Direccion,5)="DIAG."
		*lcViaPPal = "DIAGONAL"
		lcViaPPal = "DG"
		lnViaPPal = 48		
		thisform.eje_vial(lcCadena_Direccion,"DIAG.") 		
			
	CASE LEFT(lcCadena_Direccion,8)="DIAGONAL"
		*lcViaPPal = "DIAGONAL"
		lcViaPPal = "DG"
		lnViaPPal = 48		
		thisform.eje_vial(lcCadena_Direccion,"DIAGONAL") 
					
	CASE LEFT(lcCadena_Direccion,3)="DIA"
		*lcViaPPal = "DIAGONAL"
		lcViaPPal = "DG"
		lnViaPPal = 48		
		thisform.eje_vial(lcCadena_Direccion,"DIA") 
	
*!*		CASE LEFT(lcCadena_Direccion,18)="PARALELA EL BOSQUE"
*!*			lcViaPPal = "PARALELA EL BOSQUE"
*!*			lnViaPPal = 95
*!*			thisform.eje_vial(lcCadena_Direccion,"PARALELA EL BOSQUE") 
*!*		
*!*		CASE LEFT(lcCadena_Direccion,18)="PARALELA AL BOSQUE"
*!*			lcViaPPal = "PARALELA EL BOSQUE"
*!*			lnViaPPal = 95
*!*			thisform.eje_vial(lcCadena_Direccion,"PARALELA AL BOSQUE") 
				
	CASE LEFT(lcCadena_Direccion,2)="KM"
		DO CASE 
			CASE ATC("GIRON",lcCadena_Direccion)>0
				*lcViaPPal = "AUTOPISTA GIRON KM"
				lcViaPPal = "AUT"
				lnViaPPal = 9			
			CASE ATC("FLORIDABLANCA",lcCadena_Direccion)>0	
				*lcViaPPal = "AUTOPISTA FLORIDA KM"
				lcViaPPal = "AUT"
				lnViaPPal = 8	
			OTHERWISE 
				*lcViaPPal = "KM."
				lcViaPPal = "KM"
				lnViaPPal = 51	
		ENDCASE 		
		
		lcEjevial1 = SUBSTR(lcCadena_Direccion,3,ATC(" ",lcCadena_Direccion)-1)
		lcCadena_atipico1 = SUBSTR(lcCadena_Direccion,ATC(" ",lcCadena_Direccion)+1)+"/"+lcCadena_atipico
		lcCadena_atipico = lcCadena_atipico1 
		
	CASE LEFT(lcCadena_Direccion,6)="TRANSV"
		DO CASE 
			CASE ATC("ORIENTAL",lcCadena_Direccion)>0
				*lcViaPPal = "TRANSVERSAL ORIENTAL"
				lcViaPPal = "TV"
				lnViaPPal = 60
			CASE ATC("CENTRAL",lcCadena_Direccion)>0
				*lcViaPPal = "TRANSVERSAL CENTRAL METROPOLITANA"
				lcViaPPal = "TV"
				lnViaPPal = 58	
			CASE ATC("METROPOLITANA",lcCadena_Direccion)>0
				*lcViaPPal = "TRANSVERSAL METROPOLITANA"
				lcViaPPal = "TV"
				lnViaPPal = 57	
			CASE ATC("VILLA CONCHA",lcCadena_Direccion)>0
				*lcViaPPal = "TRANSVERSAL VILLACONCHA"
				lcViaPPal = "TV"
				lnViaPPal = 94		
			OTHERWISE 
				*lcViaPPal = "TRANSVERSAL"
				lcViaPPal = "TV"
				lnViaPPal = 56
		ENDCASE 		
		
		thisform.eje_vial(lcCadena_Direccion,"TRANSV") 
		
		IF ALLTRIM(lcEjevial1)=="ORIENTAL"
			lcEjevial1 = ''
		ELSE 
			IF ATC("CIRCUNV",lcEjevial1)>0
				lcEjevial1 = STRTRAN(lcEjevial1,"CIRCUNV","CIRCU")
			ELSE 
				IF ATC("CENTRAL",lcEjevial1)>0
					lcEjevial1 = ''
				ENDIF 
			ENDIF	
		ENDIF 

	
	CASE LEFT(lcCadena_Direccion,3)="TRV"
		DO CASE 
			CASE ATC("ORIENTAL",lcCadena_Direccion)>0
				*lcViaPPal = "TRANSVERSAL ORIENTAL"
				lcViaPPal = "TV"
				lnViaPPal = 60
			CASE ATC("CENTRAL",lcCadena_Direccion)>0
				*lcViaPPal = "TRANSVERSAL CENTRAL METROPOLITANA"
				lcViaPPal = "TV"
				lnViaPPal = 58	
			CASE ATC("METROPOLITANA",lcCadena_Direccion)>0
				*lcViaPPal = "TRANSVERSAL METROPOLITANA"
				lcViaPPal = "TV"
				lnViaPPal = 57	
			CASE ATC("VILLA CONCHA",lcCadena_Direccion)>0
				*lcViaPPal = "TRANSVERSAL VILLACONCHA"
				lcViaPPal = "TV"
				lnViaPPal = 94		
			OTHERWISE 
				*lcViaPPal = "TRANSVERSAL"
				lcViaPPal = "TV"
				lnViaPPal = 56
		ENDCASE 		
		
		thisform.eje_vial(lcCadena_Direccion,"TRV") 
		
		IF ALLTRIM(lcEjevial1)=="ORIENTAL"
			lcEjevial1 = ''
		ELSE 
			IF ATC("CIRCUNV",lcEjevial1)>0
				lcEjevial1 = STRTRAN(lcEjevial1,"CIRCUNV","CIRCU")
			ELSE 
				IF ATC("CENTRAL",lcEjevial1)>0
					lcEjevial1 = ''
				ENDIF 
			ENDIF	
		ENDIF 
	
	CASE LEFT(lcCadena_Direccion,3)="BLV"
		DO CASE 
			CASE ATC("BOLIVAR",lcCadena_Direccion)>0
				*lcViaPPal = "BV. BOLIVAR"
				lcViaPPal = "BLV"
				lnViaPPal = 32
			CASE ATC("CACIQUE",lcCadena_Direccion)>0
				*lcViaPPal = "BV. CACIQUE"
				lcViaPPal = "BLV"
				lnViaPPal = 96	
			CASE ATC("TEJAR",lcCadena_Direccion)>0
				*lcViaPPal = "BV. DEL TEJAR CIRCUNVALAR"
				lcViaPPal = "BLV"
				lnViaPPal = 33	
			CASE ATC("SDER",lcCadena_Direccion)>0
				*lcViaPPal = "BV. SANTANDER"
				lcViaPPal = "BLV"
				lnViaPPal = 34		
			OTHERWISE 
				*lcViaPPal = "BV."
				lcViaPPal = "BLV"
				lnViaPPal = 97
		ENDCASE 		
		
		thisform.eje_vial(lcCadena_Direccion,"BLV") 
		
		IF ATC("BOLIVAR",lcEjevial1)>0
			lcEjevial1 = ''
		ELSE 
			IF ATC("CACIQUE",lcEjevial1)>0
				lcEjevial1 = ""
			ELSE 
				IF ATC("TEJAR",lcEjevial1)>0
					lcEjevial1 = ''
				ELSE 
					IF ATC("SDER",lcEjevial1)>0
						lcEjevial1 = ''
					ENDIF 	
				ENDIF 
			ENDIF	
		ENDIF 
	
	CASE LEFT(lcCadena_Direccion,3)="VIA"
		
		DO CASE 
			CASE ATC("GUATIGUARA",lcCadena_Direccion)>0
				*lcViaPPal = "VIA. GUATIGUARA"
				lcViaPPal = "NOMBRE VIA"
				lnViaPPal = 98
			CASE ATC("PAMPLONA",lcCadena_Direccion)>0
				*lcViaPPal = "VIA. PAMPLONA"
				lcViaPPal = "NOMBRE VIA"
				lnViaPPal = 99	
			OTHERWISE 
				*lcViaPPal = "VIA."
				lcViaPPal = "NOMBRE VIA"
				lnViaPPal = 65
		ENDCASE 		
		
		thisform.eje_vial(lcCadena_Direccion,"VIA") 
		
		IF ALLTRIM(lcEjevial1)=="GUATIGUARA"
			lcEjevial1 = ''
		ELSE 
			IF ATC("PAMPLONA",lcEjevial1)>0
				lcEjevial1 = ""
			ENDIF	
		ENDIF 
		
	OTHERWISE 
		***ACA!!			
		lcViaPPal = "  "
		lnViaPPal = 0
ENDCASE 



IF LEN(alltrim(lcEjevial1))=0 AND LEN(ALLTRIM(lcEjevial2))=0 AND LEN(ALLTRIM(lcEjevial3))=0 
	lnPosEv1 = ATC("#",lcCadena_Direccion)
	IF lnPosEv1 > 0
		lnPosfinEv1 = ATC("-",lcCadena_Direccion)
		IF lnPosfinEv1 > 0
			lcEjevial1 = SUBSTR(lcCadena_Direccion,lnPosEv1+1,lnPosfinEv1-1)
			lnPosfinEv2 = ATC(" ",lcCadena_Direccion)
			IF lnPosfinEv2 > 0
				lcEjevial2 = SUBSTR(lcCadena_Direccion,lnPosfinEv1+1,lnPosfinEv2-1)
				
				DO CASE 
					CASE ATC(" T ",lcCadena_Direccion)>0
						lcCompl1 = "TO"
						lnCompl1 = 69
						lcCompl2 = SUBSTR(lcCadena_Direccion,ATC(" T ",lcCadena_Direccion)+1,ATC(" ",lcCadena_Direccion)-1)
					CASE ATC("EDF",lcCadena_Direccion)>0
						lcCompl1 = "ED"
						lnCompl2 = 67	
						lcCompl2 = SUBSTR(lcCadena_Direccion,ATC("EDF",lcCadena_Direccion)+1,ATC(" ",lcCadena_Direccion)-1)
				ENDCASE 
				
				DO CASE 
					CASE ATC("APT",lcCadena_Direccion)>0
						lcCompl3 = "AP"
						lnCompl3 = 87
					CASE ATC("CS",lcCadena_Direccion)>0
						lcCompl3 = "CA"
						lnCompl3 = 84	
				ENDCASE 
			ELSE
				lcEjevial2 = SUBSTR(lcCadena_Direccion,lnPosfinEv1+1)
			ENDIF 	
		ENDIF 	
	ENDIF 			
ENDIF 	
ENDPROC
]]></methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3><![CDATA[ncontrato
nfiadores
*migrarnits 
*via_ppal 
*eje_vial 
*digito_ver 
*telefonos 
*exportar_informacion 
*migrarmov 
*exportar_informacion_conta 
*migrarinmuebles 
*nombresnits 
*parqueadero 
*piso 
*cocina 
*buscar_detalle 
*migrarcontratos 
*tipodoc 
*nombrescompletos 
*migrardesocupados 
*exportar_csv 
*exportarconta_csv 
*direcciones_fjson 
*telefonosjson 
]]></reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>3</nrecno>
	</form>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C0WL2NI</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[checkbox]]></class>
		<classloc/>
		<baseclass><![CDATA[checkbox]]></baseclass>
		<objname><![CDATA[Check5]]></objname>
		<parent><![CDATA[Form1]]></parent>
		<properties><![CDATA[Top = 53
Left = 408
Height = 17
Width = 60
FontName = "Tahoma"
Alignment = 0
Caption = "Saldos"
Name = "Check5"
]]></properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>9</nrecno>
	</form>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C0WL2NB</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[commandbutton]]></class>
		<classloc/>
		<baseclass><![CDATA[commandbutton]]></baseclass>
		<objname><![CDATA[Command1]]></objname>
		<parent><![CDATA[Form1]]></parent>
		<properties><![CDATA[AutoSize = .F.
Top = 108
Left = 175
Height = 60
Width = 72
Picture = ..\custom-icon-design-flatastic-11-download-to-laptop.ico
Caption = "Descargar"
Style = 0
Name = "Command1"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE Click
IF thisform.chkNits.Value = 1
	thisform.migrarnits() 
ENDIF 

IF thisform.chkInmuebles.Value = 1
	thisform.migrarinmuebles() 
ENDIF  

IF thisform.chkContratos.Value = 1
	thisform.migrarcontratos() 
	thisform.migrardesocupados()
ENDIF  

IF thisform.chkMov.Value = 1
	thisform.migrarmov()
ENDIF 

IF thisform.chkNits.Value = 1 OR thisform.chkContratos.Value = 1 OR thisform.chkInmuebles.Value = 1
	*thisform.exportar_informacion()
	thisform.exportar_csv()
	SELECT CNITS_ERROR
	GO TOP 
	COPY TO F:/nits_error.xls TYPE xls
ENDIF 

IF thisform.chkMov.Value = 1
	thisform.exportarconta_csv()
	*thisform.exportar_informacion_conta() 
ENDIF 
ENDPROC
]]></methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>10</nrecno>
	</form>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C14YCHQ</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[commandbutton]]></class>
		<classloc/>
		<baseclass><![CDATA[commandbutton]]></baseclass>
		<objname><![CDATA[Command2]]></objname>
		<parent><![CDATA[Form1]]></parent>
		<properties><![CDATA[AutoSize = .F.
Top = 109
Left = 247
Height = 60
Width = 72
Picture = ..\close_win7.ico
Caption = "Salir"
Style = 0
Name = "Command2"
]]></properties>
		<protected/>
		<methods><![CDATA[PROCEDURE Click
CLOSE DATABASES ALL 

thisform.Release() 
ENDPROC
]]></methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>11</nrecno>
	</form>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C0WL2ND</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[shape]]></class>
		<classloc/>
		<baseclass><![CDATA[shape]]></baseclass>
		<objname><![CDATA[Shape1]]></objname>
		<parent><![CDATA[Form1]]></parent>
		<properties><![CDATA[Top = 36
Left = 24
Height = 48
Width = 468
Name = "Shape1"
]]></properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>4</nrecno>
	</form>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C0WL2NG</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[checkbox]]></class>
		<classloc/>
		<baseclass><![CDATA[checkbox]]></baseclass>
		<objname><![CDATA[chkContratos]]></objname>
		<parent><![CDATA[Form1]]></parent>
		<properties><![CDATA[Top = 53
Left = 204
Height = 16
Width = 72
FontName = "Tahoma"
AutoSize = .T.
Alignment = 0
Caption = "Contratos"
Name = "chkContratos"
]]></properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>7</nrecno>
	</form>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C0WL2NF</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[checkbox]]></class>
		<classloc/>
		<baseclass><![CDATA[checkbox]]></baseclass>
		<objname><![CDATA[chkInmuebles]]></objname>
		<parent><![CDATA[Form1]]></parent>
		<properties><![CDATA[Top = 53
Left = 108
Height = 16
Width = 75
FontName = "Tahoma"
AutoSize = .T.
Alignment = 0
Caption = "Inmuebles"
Name = "chkInmuebles"
]]></properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>6</nrecno>
	</form>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C0WL2NH</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[checkbox]]></class>
		<classloc/>
		<baseclass><![CDATA[checkbox]]></baseclass>
		<objname><![CDATA[chkMov]]></objname>
		<parent><![CDATA[Form1]]></parent>
		<properties><![CDATA[Top = 53
Left = 300
Height = 16
Width = 86
FontName = "Tahoma"
AutoSize = .T.
Alignment = 0
Caption = "Movimientos"
Name = "chkMov"
]]></properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>8</nrecno>
	</form>
	<form>
		<platform>WINDOWS</platform>
		<uniqueid>_53C0WL2NE</uniqueid>
		<timestamp>0</timestamp>
		<class><![CDATA[checkbox]]></class>
		<classloc/>
		<baseclass><![CDATA[checkbox]]></baseclass>
		<objname><![CDATA[chkNits]]></objname>
		<parent><![CDATA[Form1]]></parent>
		<properties><![CDATA[Top = 53
Left = 48
Height = 17
Width = 60
FontName = "Tahoma"
Alignment = 0
Caption = "Nits"
Name = "chkNits"
]]></properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>5</nrecno>
	</form>
	<form>
		<platform>COMMENT</platform>
		<uniqueid>Screen</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1><![CDATA[VERSION =   3.00]]></reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>1</nrecno>
	</form>
	<form>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
		<nrecno>12</nrecno>
	</form>
</VFPData>
